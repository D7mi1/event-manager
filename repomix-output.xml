This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
app/api/send-email/route.ts
app/auth/verify/page.tsx
app/components/SubscriptionTracker.tsx
app/dashboard/events/[id]/edit/page.tsx
app/dashboard/events/[id]/page.tsx
app/dashboard/events/new/page.tsx
app/dashboard/layout.tsx
app/dashboard/page.tsx
app/dashboard/settings/page.tsx
app/e/[id]/page.tsx
app/favicon.ico
app/globals.css
app/layout.tsx
app/live/[id]/page.tsx
app/login/page.tsx
app/page.tsx
app/pricing/page.tsx
app/register/[id]/page.tsx
app/s/[id]/page.tsx
app/scan/[id]/page.tsx
app/scan/page.tsx
app/staff/[id]/page.tsx
app/ticket/[id]/page.tsx
app/utils/check-limits.ts
app/utils/supabase/client.ts
app/utils/supabase/server.ts
components/EventCard.tsx
components/FeatureSlider.tsx
components/HeroSection.tsx
components/Navbar.tsx
components/StickyCTA.tsx
eslint.config.mjs
next.config.ts
package.json
postcss.config.mjs
PROJECT_CONTEXT.md
public/file.svg
public/globe.svg
public/next.svg
public/vercel.svg
public/window.svg
README.md
tailwind.config.ts
tsconfig.json
types/index.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="app/api/send-email/route.ts">
import { NextResponse } from 'next/server';
import { Resend } from 'resend';

const resend = new Resend(process.env.RESEND_API_KEY);

export async function POST(request: Request) {
  try {
    const body = await request.json();
    const { 
      name, 
      email, 
      eventTitle, 
      eventDate, 
      eventTime, 
      location, 
      ticketLink, 
      heroImage, 
      qrData, // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù…
      noKids, 
      noPhoto 
    } = body;

    // ğŸ‘‡ Ø§Ù„Ø­Ù„ Ø§Ù„Ø³Ø­Ø±ÙŠ: ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø­Ù‚ÙŠÙ‚ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
    // Gmail ÙŠØ¹Ø´Ù‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© ÙˆÙŠØ¸Ù‡Ø±Ù‡Ø§ ÙÙˆØ±Ø§Ù‹
    const qrImageUrl = `https://quickchart.io/qr?text=${encodeURIComponent(qrData)}&size=300&margin=1&ecLevel=H&format=png`;

    // ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ (Card Design)
    const htmlContent = `
      <!DOCTYPE html>
      <html dir="rtl" lang="ar">
      <head>
        <style>
          body { background-color: #f3f4f6; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; margin: 0; }
          .wrapper { max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #e5e7eb; }
          .header { background-color: #4f46e5; padding: 40px 20px; text-align: center; color: white; background-image: url('${heroImage || ""}'); background-size: cover; background-position: center; position: relative; }
          .header-overlay { background: rgba(79, 70, 229, 0.85); position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 1; }
          .header-content { position: relative; z-index: 2; }
          .content { padding: 30px 20px; text-align: center; color: #333; }
          .details { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 15px; margin: 20px 0; text-align: right; }
          .detail-item { padding: 8px 0; border-bottom: 1px dashed #e2e8f0; font-size: 14px; }
          .detail-item:last-child { border-bottom: none; }
          .qr-box { margin: 25px 0; padding: 10px; display: inline-block; background: white; border: 2px dashed #cbd5e1; border-radius: 12px; }
          .btn { background-color: #4f46e5; color: #ffffff !important; padding: 14px 28px; text-decoration: none; border-radius: 50px; font-weight: bold; display: inline-block; margin-top: 10px; box-shadow: 0 4px 10px rgba(79, 70, 229, 0.2); }
          .tags { margin-top: 20px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
          .tag { font-size: 11px; padding: 4px 10px; border-radius: 20px; font-weight: bold; }
          .tag-red { background: #fee2e2; color: #991b1b; border: 1px solid #fecaca; }
        </style>
      </head>
      <body>
        <div class="wrapper">
          <div class="header">
            <div class="${heroImage ? 'header-overlay' : ''}"></div>
            <div class="header-content">
              <h1 style="margin:0; font-size: 24px;">${eventTitle}</h1>
              <p style="margin:5px 0 0; opacity: 0.9;">ØªÙ… ØªØ£ÙƒÙŠØ¯ ØªØ³Ø¬ÙŠÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­ âœ…</p>
            </div>
          </div>

          <div class="content">
            <h2 style="color: #1e293b;">Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒØŒ ${name} ğŸ‘‹</h2>
            
            <div class="details">
               <div class="detail-item"><strong>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${eventDate}</div>
               <div class="detail-item"><strong>â° Ø§Ù„ÙˆÙ‚Øª:</strong> ${eventTime}</div>
               <div class="detail-item"><strong>ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ${location}</div>
            </div>

            <div class="qr-box">
              <img src="${qrImageUrl}" alt="QR Code" width="200" height="200" style="display:block;" />
              <p style="margin:5px 0 0; font-size:12px; color:#94a3b8;">Ø§Ù…Ø³Ø­ Ø§Ù„Ø±Ù…Ø² Ù„Ù„Ø¯Ø®ÙˆÙ„</p>
            </div>

            <br/>
            <a href="${ticketLink}" class="btn">Ø¹Ø±Ø¶ Ø§Ù„ØªØ°ÙƒØ±Ø© ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ…</a>

            <div class="tags">
               ${noKids ? '<span class="tag tag-red">ğŸ‘¶ Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ø£Ø·ÙØ§Ù„</span>' : ''}
               ${noPhoto ? '<span class="tag tag-red">ğŸ“µ Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØµÙˆÙŠØ±</span>' : ''}
            </div>
          </div>
        </div>
      </body>
      </html>
    `;

    const data = await resend.emails.send({
      from: 'Event Manager <onboarding@resend.dev>',
      to: [email],
      subject: `ØªØ°ÙƒØ±Ø© Ø¯Ø®ÙˆÙ„: ${eventTitle} ğŸ«`,
      html: htmlContent,
    });

    if (data.error) {
        return NextResponse.json({ error: data.error }, { status: 500 });
    }

    return NextResponse.json({ success: true, data });
  } catch (error) {
    return NextResponse.json({ error: 'Internal Error' }, { status: 500 });
  }
}
</file>

<file path="app/auth/verify/page.tsx">
'use client';

import { useState, useEffect, useRef, Suspense } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import { useRouter, useSearchParams } from 'next/navigation';
import { Sparkles, Loader2, ArrowLeft, ShieldCheck, RefreshCw } from 'lucide-react';
import Link from 'next/link';

function VerifyContent() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const email = searchParams.get('email') || 'example@mail.com';
  const interest = searchParams.get('interest'); // Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø«ÙŠÙ… (Ø£Ø¹Ù…Ø§Ù„/Ø£ÙØ±Ø§Ø­)

  // ØªØ­Ø¯ÙŠØ¯ Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø«ÙŠÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚
  const themeColor = interest === 'business' ? '#3B82F6' : '#C19D65';
  const themeBg = interest === 'business' ? 'rgba(59, 130, 246, 0.1)' : 'rgba(193, 157, 101, 0.1)';

  const [otp, setOtp] = useState(['', '', '', '', '', '']);
  const [loading, setLoading] = useState(false);
  const [timer, setTimer] = useState(60);
  const [error, setError] = useState<string | null>(null);
  
  // Ù…Ø±Ø§Ø¬Ø¹ Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØªØ±ÙƒÙŠØ²
  const inputRefs = useRef<(HTMLInputElement | null)[]>([]);

  // 1. Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù„Ù‰ Ø£ÙˆÙ„ Ø®Ø§Ù†Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
  useEffect(() => {
    if (inputRefs.current[0]) {
      inputRefs.current[0].focus();
    }
  }, []);

  // Ø¹Ø¯Ø§Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
  useEffect(() => {
    let interval: NodeJS.Timeout;
    if (timer > 0) {
      interval = setInterval(() => setTimer((prev) => prev - 1), 1000);
    }
    return () => clearInterval(interval);
  }, [timer]);

  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ÙƒØªØ§Ø¨Ø©
  const handleChange = (index: number, value: string) => {
    if (isNaN(Number(value))) return; // Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·

    const newOtp = [...otp];
    // Ø£Ø®Ø° Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø£Ø®ÙŠØ± ÙÙ‚Ø· (ÙÙŠ Ø­Ø§Ù„ ÙƒØªØ¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø³Ø±Ø¹Ø©)
    newOtp[index] = value.substring(value.length - 1);
    setOtp(newOtp);

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø§Ù†Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
    if (value && index < 5 && inputRefs.current[index + 1]) {
      inputRefs.current[index + 1]?.focus();
    }

    // 2. Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯
    const combinedOtp = newOtp.join('');
    if (combinedOtp.length === 6) {
      handleVerify(combinedOtp);
    }
  };

  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ø°Ù (Backspace) ÙˆØ§Ù„ØªÙ†Ù‚Ù„ Ù„Ù„Ø®Ù„Ù
  const handleKeyDown = (index: number, e: React.KeyboardEvent<HTMLInputElement>) => {
    if (e.key === 'Backspace' && !otp[index] && index > 0 && inputRefs.current[index - 1]) {
      inputRefs.current[index - 1]?.focus();
    }
  };

  // Ø¯Ø§Ù„Ø© Ø¯Ø¹Ù… Ø§Ù„Ù„ØµÙ‚ (Paste) Ø§Ù„Ø°ÙƒÙŠ
  const handlePaste = (e: React.ClipboardEvent<HTMLInputElement>) => {
    e.preventDefault();
    const pastedData = e.clipboardData.getData('text').slice(0, 6).split('');
    if (pastedData.every(char => !isNaN(Number(char)))) {
      const newOtp = [...otp];
      pastedData.forEach((char, i) => {
        if (i < 6) newOtp[i] = char;
      });
      setOtp(newOtp);
      // ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø¢Ø®Ø± Ø®Ø§Ù†Ø© ØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø£Ùˆ Ø§Ù„Ø£Ø®ÙŠØ±Ø©
      const focusIndex = Math.min(pastedData.length, 5);
      inputRefs.current[focusIndex]?.focus();
      
      if (newOtp.join('').length === 6) handleVerify(newOtp.join(''));
    }
  };

  const handleVerify = async (code: string) => {
    setLoading(true);
    setError(null);
    try {
      const { error } = await supabase.auth.verifyOtp({
        email,
        token: code,
        type: 'signup'
      });
      if (error) throw error;
      router.push('/dashboard'); // Ù†Ø¬Ø§Ø­!
    } catch (err: any) {
      setError('Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØªÙ‡');
      setLoading(false);
    }
  };

  const handleResend = async () => {
    if (timer > 0) return;
    setLoading(true);
    setError(null);
    try {
      const { error } = await supabase.auth.resend({
        type: 'signup',
        email,
      });
      if (error) throw error;
      setTimer(60); // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯
      alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø² Ù…Ø¬Ø¯Ø¯Ø§Ù‹');
    } catch (err: any) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-[#0A0A0C] text-white flex items-center justify-center p-6 text-right font-sans relative overflow-hidden" dir="rtl">
      
      {/* Ø§Ù„ØªÙˆÙ‡Ø¬ Ø§Ù„Ø®Ù„ÙÙŠ */}
      <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] rounded-full blur-[100px] opacity-20 transition-all duration-1000" style={{ background: `radial-gradient(circle, ${themeColor} 0%, transparent 70%)` }} />

      <div className="w-full max-w-lg bg-[#0F0F12]/90 border border-white/10 rounded-[3rem] p-10 backdrop-blur-3xl shadow-2xl relative z-10">
        
        {/* Header */}
        <div className="text-center mb-10">
          <div className="w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-6 border transition-all duration-500" style={{ backgroundColor: themeBg, borderColor: `${themeColor}40` }}>
            <ShieldCheck size={32} style={{ color: themeColor }} />
          </div>
          <h1 className="text-2xl font-black mb-2">ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</h1>
          <p className="text-white/40 text-sm leading-relaxed">
            Ø£Ø±Ø³Ù„Ù†Ø§ Ø±Ù…Ø² ØªØ£ÙƒÙŠØ¯ Ù…Ø¤Ù„Ù Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù… Ø¥Ù„Ù‰ <br />
            <span className="text-white font-bold dir-ltr block mt-1">{email}</span>
          </p>
        </div>

        {/* OTP Inputs */}
        <div className="flex justify-between gap-2 mb-8" dir="ltr">
          {otp.map((digit, index) => (
            <input
              key={index}
              ref={(el) => { inputRefs.current[index] = el }} // Ø±Ø¨Ø· Ø§Ù„Ù…Ø±Ø¬Ø¹
              type="text"
              inputMode="numeric" // Ù„Ø¥Ø¸Ù‡Ø§Ø± ÙƒÙŠØ¨ÙˆØ±Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
              maxLength={1}
              value={digit}
              onChange={(e) => handleChange(index, e.target.value)}
              onKeyDown={(e) => handleKeyDown(index, e)}
              onPaste={handlePaste}
              className={`w-12 h-14 md:w-14 md:h-16 bg-white/[0.02] border rounded-2xl text-center text-xl font-bold outline-none transition-all
                ${digit ? `border-[${themeColor}] shadow-[0_0_10px_${themeColor}40]` : 'border-white/10'}
                focus:border-[var(--theme-color)] focus:bg-white/[0.05] focus:scale-105
              `}
              style={{ '--theme-color': themeColor } as React.CSSProperties}
            />
          ))}
        </div>

        {error && (
          <div className="mb-6 p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-red-500 text-[11px] text-center font-bold animate-in fade-in">
             {error}
          </div>
        )}

        {/* Ø²Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯ */}
        <button 
          onClick={() => handleVerify(otp.join(''))}
          disabled={loading || otp.join('').length < 6}
          style={{ backgroundColor: themeColor, boxShadow: `0 15px 30px ${themeColor}20` }} 
          className="w-full text-black py-4 rounded-2xl font-black text-lg hover:scale-[1.01] active:scale-[0.98] transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          {loading ? <Loader2 className="animate-spin" /> : 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨'}
        </button>

        {/* Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ */}
        <div className="mt-8 text-center">
          <p className="text-white/30 text-xs font-bold mb-2">Ù„Ù… ÙŠØµÙ„Ùƒ Ø§Ù„Ø±Ù…Ø²ØŸ</p>
          {timer > 0 ? (
            <span className="text-white/50 text-xs font-mono bg-white/5 px-3 py-1 rounded-lg">
              Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ 00:{timer < 10 ? `0${timer}` : timer}
            </span>
          ) : (
            <button 
              onClick={handleResend}
              className="text-white hover:text-[var(--theme-color)] text-xs font-black underline decoration-2 underline-offset-4 transition-all flex items-center justify-center gap-2 mx-auto"
              style={{ '--theme-color': themeColor } as React.CSSProperties}
            >
              <RefreshCw size={12} /> Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø²
            </button>
          )}
        </div>
        
        {/* Ø§Ù„Ø¹ÙˆØ¯Ø© */}
        <Link href="/login" className="block mt-8 text-center text-[10px] text-white/20 hover:text-white transition-colors">
          Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        </Link>

      </div>
    </div>
  );
}

// ØªØºÙ„ÙŠÙ Ø§Ù„ØµÙØ­Ø© Ø¨Ù€ Suspense Ù„Ø£Ù†Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… useSearchParams
export default function VerifyPage() {
  return (
    <Suspense fallback={<div className="min-h-screen bg-[#0A0A0C] flex items-center justify-center text-white"><Loader2 className="animate-spin" /></div>}>
      <VerifyContent />
    </Suspense>
  );
}
</file>

<file path="app/components/SubscriptionTracker.tsx">
'use client';

import { useState, useEffect } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import { Crown, Zap, MessageCircle, Users, AlertTriangle, Lock, ArrowUpRight, Loader2 } from 'lucide-react';
import Link from 'next/link';

export default function SubscriptionTracker() {
  const [loading, setLoading] = useState(true);
  const [sub, setSub] = useState<any>(null);

  useEffect(() => {
    const fetchSub = async () => {
      const { data: { user } } = await supabase.auth.getUser();
      if (user) {
        const { data } = await supabase
          .from('subscriptions')
          .select('*')
          .eq('user_id', user.id)
          .single();
        
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ØŒ Ù†Ø¶Ø¹ Ù‚ÙŠÙ… Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©
        setSub(data || { 
          plan_tier: 'free', 
          guests_limit: 50, guests_used: 0,
          messages_limit: 0, messages_used: 0,
          renews_at: new Date(Date.now() + 30*24*60*60*1000).toISOString()
        });
      }
      setLoading(false);
    };
    fetchSub();
  }, []);

  if (loading) return <div className="h-48 bg-white/5 rounded-[2rem] animate-pulse"></div>;

  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
  const guestPercentage = Math.min((sub.guests_used / sub.guests_limit) * 100, 100);
  const isApproachingLimit = guestPercentage >= 80;
  const isFreePlan = sub.plan_tier === 'free';

  // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ
  const getProgressColor = () => {
    if (guestPercentage >= 90) return 'bg-red-500 shadow-[0_0_10px_rgba(239,68,68,0.5)]';
    if (guestPercentage >= 75) return 'bg-orange-500';
    return 'bg-[#C19D65]'; // Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
  };

  return (
    <div className="bg-gradient-to-br from-[#1A1A1D] to-[#0F0F12] border border-white/10 rounded-[2rem] p-6 relative overflow-hidden group">
      
      {/* Ø®Ù„ÙÙŠØ© Ø¬Ù…Ø§Ù„ÙŠØ© */}
      <div className="absolute top-0 right-0 w-32 h-32 bg-[#C19D65]/5 rounded-full blur-[50px] pointer-events-none"></div>

      {/* Ø±Ø£Ø³ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */}
      <div className="flex justify-between items-start mb-6 relative z-10">
        <div>
          <h3 className="text-white font-bold flex items-center gap-2">
            <Zap size={18} className="text-[#C19D65]" />
            Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©
          </h3>
          <p className="text-[10px] text-white/40 mt-1">
            ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø±ØµÙŠØ¯: {new Date(sub.renews_at).toLocaleDateString('ar-SA', { day: 'numeric', month: 'long' })}
          </p>
        </div>
        <div className="px-3 py-1 rounded-full bg-white/5 border border-white/10 text-[10px] font-bold uppercase tracking-wider text-white/60">
          {sub.plan_tier === 'free' ? 'Personal Plan' : sub.plan_tier === 'pro' ? 'PRO Plan' : 'Developed'}
        </div>
      </div>

      {/* 1. Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¶ÙŠÙˆÙ (Guest Credits) */}
      <div className="mb-6 relative z-10">
        <div className="flex justify-between text-xs mb-2">
          <span className="text-white/60 flex items-center gap-1"><Users size={12}/> Ø±ØµÙŠØ¯ Ø§Ù„Ø¶ÙŠÙˆÙ</span>
          <span className="text-white font-bold">{sub.guests_used} <span className="text-white/30">/ {sub.guests_limit}</span></span>
        </div>
        <div className="w-full h-3 bg-white/5 rounded-full overflow-hidden border border-white/5">
          <div 
            className={`h-full rounded-full transition-all duration-1000 ${getProgressColor()}`} 
            style={{ width: `${guestPercentage}%` }}
          ></div>
        </div>
        
        {/* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ø°ÙƒÙŠØ© (Upsell Trigger) */}
        {isApproachingLimit && isFreePlan && (
          <div className="mt-3 flex items-start gap-2 bg-red-500/10 border border-red-500/20 p-3 rounded-xl">
             <AlertTriangle size={14} className="text-red-500 shrink-0 mt-0.5" />
             <div>
               <p className="text-[10px] font-bold text-red-400 leading-tight">Ù„Ù‚Ø¯ Ø§Ù‚ØªØ±Ø¨Øª Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰!</p>
               <p className="text-[9px] text-red-400/60 mt-1">Ø±Ù‚Ù Ø¨Ø§Ù‚ØªÙƒ Ø§Ù„Ø¢Ù† Ù„Ø¶Ù…Ø§Ù† Ø¯Ø®ÙˆÙ„ Ø¬Ù…ÙŠØ¹ Ø¶ÙŠÙˆÙÙƒ Ø¨Ù„Ø§ ØªÙˆÙ‚Ù.</p>
             </div>
             <Link href="/dashboard/settings" className="mr-auto text-[9px] bg-red-500 text-white px-2 py-1 rounded font-bold hover:bg-red-600">ØªØ±Ù‚ÙŠØ©</Link>
          </div>
        )}
      </div>

      {/* 2. Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (WhatsApp/SMS) - Ø­Ø§Ù„Ø© Ø§Ù„Ù‚ÙÙ„ Ù„Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© */}
      <div className={`relative p-4 rounded-xl border border-white/5 ${isFreePlan ? 'bg-white/[0.02]' : 'bg-transparent'}`}>
        
        {/* Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ¹ØªÙŠÙ… (Blur Overlay) Ù„Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© */}
        {isFreePlan && (
          <div className="absolute inset-0 backdrop-blur-[2px] bg-[#0A0A0C]/40 z-20 flex flex-col items-center justify-center rounded-xl transition-all group-hover:backdrop-blur-[1px]">
             <div className="bg-[#1A1A1D] p-2 rounded-full border border-white/10 mb-2 shadow-xl">
               <Lock size={14} className="text-[#C19D65]" />
             </div>
             <p className="text-[10px] font-bold text-white/80">Ù…ÙŠØ²Ø© Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ø­ØªØ±ÙÙŠÙ†</p>
             <p className="text-[9px] text-white/40">ØªÙØ¹ÙŠÙ„ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</p>
          </div>
        )}

        <div className="flex justify-between text-xs mb-2 opacity-60">
          <span className="flex items-center gap-1"><MessageCircle size={12}/> Ø¯Ø¹ÙˆØ§Øª ÙˆØ§ØªØ³Ø§Ø¨</span>
          <span>{sub.messages_used} / {sub.messages_limit || 'âˆ'}</span>
        </div>
        <div className="w-full h-1.5 bg-white/5 rounded-full overflow-hidden opacity-60">
           <div className="h-full bg-blue-500 rounded-full" style={{ width: `${(sub.messages_used / (sub.messages_limit || 1)) * 100}%` }}></div>
        </div>
      </div>

      {/* Ø²Ø± Ø§Ù„ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø¹Ø§Ù… */}
      {isFreePlan && (
        <Link 
          href="/dashboard/settings"
          className="mt-6 w-full py-3 bg-[#C19D65] hover:bg-[#b08d55] text-black rounded-xl font-black text-xs flex items-center justify-center gap-2 transition-all hover:scale-[1.02] shadow-[0_4px_20px_rgba(193,157,101,0.2)]"
        >
          <Crown size={14} /> ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
        </Link>
      )}

    </div>
  );
}
</file>

<file path="app/dashboard/events/[id]/edit/page.tsx">
'use client'

import { useState, useEffect, use } from 'react'
import { supabase } from '@/app/utils/supabase/client'
import { useRouter } from 'next/navigation'
import { Calendar, MapPin, Type, Loader2, FileText, Link as LinkIcon, Clock, Save, ArrowRight } from 'lucide-react'
import Link from 'next/link'

interface PageProps { params: Promise<{ id: string }> }

export default function EditEvent({ params }: PageProps) {
  const resolvedParams = use(params)
  const eventId = resolvedParams.id

  const [formData, setFormData] = useState({
    title: '', event_date: '', event_time: '', location: '', description: '', map_link: '', allow_multiple_entry: false
  })
  const [loading, setLoading] = useState(true)
  const [saving, setSaving] = useState(false)


  const router = useRouter()

  useEffect(() => {
    const fetchEvent = async () => {
      const { data } = await supabase.from('events').select('*').eq('id', eventId).single()
      if (data) setFormData(data)
      setLoading(false)
    }
    fetchEvent()
  }, [eventId, supabase])

  const handleUpdate = async (e: React.FormEvent) => {
    e.preventDefault()
    setSaving(true)

    const { error } = await supabase
      .from('events')
      .update({
        title: formData.title,
        event_date: formData.event_date,
        event_time: formData.event_time,
        location: formData.location,
        description: formData.description,
        map_link: formData.map_link,
        allow_multiple_entry: formData.allow_multiple_entry
      })
      .eq('id', eventId)

    if (error) {
      alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ«')
      setSaving(false)
    } else {
      router.push('/dashboard')
      router.refresh()
    }
  }

  if (loading) return <div className="p-10 text-center">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>

  return (
    <div className="p-6 md:p-10 max-w-2xl mx-auto" dir="rtl">
      <Link href="/dashboard" className="text-slate-500 hover:text-slate-800 flex items-center gap-2 mb-6 w-fit"><ArrowRight size={18} /> Ø¥Ù„ØºØ§Ø¡ ÙˆØ¹ÙˆØ¯Ø©</Link>
      <h1 className="text-3xl font-bold text-slate-800 mb-8">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</h1>

      <form onSubmit={handleUpdate} className="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 space-y-6">

        {/* Ø§Ù„Ø§Ø³Ù… */}
        <div><label className="block text-slate-700 font-medium mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</label><div className="relative"><Type className="absolute right-3 top-3 text-slate-400" size={20} /><input type="text" required className="w-full p-3 pr-10 border border-slate-300 rounded-lg outline-none focus:border-indigo-500" value={formData.title} onChange={(e) => setFormData({ ...formData, title: e.target.value })} /></div></div>

        {/* Ø§Ù„ÙˆØµÙ */}
        <div><label className="block text-slate-700 font-medium mb-2">Ø§Ù„ØªÙØ§ØµÙŠÙ„</label><div className="relative"><FileText className="absolute right-3 top-3 text-slate-400" size={20} /><textarea className="w-full p-3 pr-10 border border-slate-300 rounded-lg outline-none focus:border-indigo-500 min-h-[100px]" value={formData.description || ''} onChange={(e) => setFormData({ ...formData, description: e.target.value })} /></div></div>

        {/* Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª */}
        <div className="grid grid-cols-2 gap-4">
          <div><label className="block text-slate-700 font-medium mb-2">Ø§Ù„ØªØ§Ø±ÙŠØ®</label><div className="relative"><Calendar className="absolute right-3 top-3 text-slate-400" size={20} /><input type="date" required className="w-full p-3 pr-10 border border-slate-300 rounded-lg outline-none focus:border-indigo-500 text-right" value={formData.event_date} onChange={(e) => setFormData({ ...formData, event_date: e.target.value })} /></div></div>
          <div><label className="block text-slate-700 font-medium mb-2">Ø§Ù„ÙˆÙ‚Øª</label><div className="relative"><Clock className="absolute right-3 top-3 text-slate-400" size={20} /><input type="time" className="w-full p-3 pr-10 border border-slate-300 rounded-lg outline-none focus:border-indigo-500 text-right" value={formData.event_time || ''} onChange={(e) => setFormData({ ...formData, event_time: e.target.value })} /></div></div>
        </div>

        {/* Ø§Ù„Ù…ÙˆÙ‚Ø¹ */}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div><label className="block text-slate-700 font-medium mb-2">Ø§Ù„Ù…ÙˆÙ‚Ø¹</label><div className="relative"><MapPin className="absolute right-3 top-3 text-slate-400" size={20} /><input type="text" required className="w-full p-3 pr-10 border border-slate-300 rounded-lg outline-none focus:border-indigo-500" value={formData.location} onChange={(e) => setFormData({ ...formData, location: e.target.value })} /></div></div>
          <div><label className="block text-slate-700 font-medium mb-2">Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø±ÙŠØ·Ø©</label><div className="relative"><LinkIcon className="absolute right-3 top-3 text-slate-400" size={20} /><input type="url" className="w-full p-3 pr-10 border border-slate-300 rounded-lg outline-none focus:border-indigo-500 text-left" dir="ltr" value={formData.map_link || ''} onChange={(e) => setFormData({ ...formData, map_link: e.target.value })} /></div></div>
        </div>

        {/* Ø®ÙŠØ§Ø± Ø§Ù„ØªÙƒØ±Ø§Ø± */}
        <div className="bg-slate-50 p-4 rounded-xl border border-slate-200">
          <label className="flex items-center gap-3 cursor-pointer">
            <input type="checkbox" className="w-5 h-5 accent-indigo-600" checked={formData.allow_multiple_entry} onChange={(e) => setFormData({ ...formData, allow_multiple_entry: e.target.checked })} />
            <span className="font-medium text-slate-800">Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯</span>
          </label>
        </div>

        <button type="submit" disabled={saving} className="w-full bg-indigo-600 text-white font-bold py-3 rounded-xl hover:bg-indigo-700 transition shadow-lg flex items-center justify-center gap-2">
          {saving ? <Loader2 className="animate-spin" /> : <><Save size={20} /> Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</>}
        </button>
      </form>
    </div>
  )
}
</file>

<file path="app/dashboard/events/[id]/page.tsx">
'use client';

import { useState, useEffect, use } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import { 
  Loader2, Users, Share2, Search, Trash2, 
  Calendar, MapPin, ExternalLink, Copy, 
  ScanLine, ArrowLeft, Edit, Shield, 
  MessageCircle, Bell, CheckSquare, X, 
  Download, CheckCircle2, AlertCircle, Clock,
  Plus, Phone, MoreHorizontal, Settings, Square
} from 'lucide-react';
import Link from 'next/link';
import { useRouter } from 'next/navigation';

interface PageProps { params: Promise<{ id: string }>; }

// Ù…ÙƒÙˆÙ† Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
const DonutChart = ({ percentage, color }: { percentage: number, color: string }) => {
  const radius = 30;
  const circumference = 2 * Math.PI * radius;
  const strokeDashoffset = circumference - (percentage / 100) * circumference;
  return (
    <div className="relative w-20 h-20 flex items-center justify-center">
      <svg className="transform -rotate-90 w-full h-full">
        <circle cx="40" cy="40" r={radius} stroke="currentColor" strokeWidth="6" fill="transparent" className="text-white/10" />
        <circle cx="40" cy="40" r={radius} stroke={color} strokeWidth="6" fill="transparent"
          strokeDasharray={circumference} strokeDashoffset={strokeDashoffset} strokeLinecap="round" className="transition-all duration-1000 ease-out" />
      </svg>
      <span className="absolute text-xs font-bold">{percentage}%</span>
    </div>
  );
};

export default function EventControlRoom({ params }: PageProps) {
  const { id } = use(params);

  // --- States ---
  const [loading, setLoading] = useState(true);
  const [event, setEvent] = useState<any>(null);
  const [attendees, setAttendees] = useState<any[]>([]);
  const [stats, setStats] = useState({ total: 0, confirmed: 0, attended: 0, declined: 0 });
  
  // Selection & Filters
  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());
  const [searchQuery, setSearchQuery] = useState('');
  const [filterType, setFilterType] = useState<'all' | 'attended' | 'confirmed' | 'pending'>('all');

  // Modals
  const [isAddGuestOpen, setIsAddGuestOpen] = useState(false);
  const [isEditModalOpen, setIsEditModalOpen] = useState(false);
  const [isMessageConfigOpen, setIsMessageConfigOpen] = useState(false);
  
  // Forms
  const [newGuest, setNewGuest] = useState({ name: '', phone: '', category: 'GENERAL' });
  const [editForm, setEditForm] = useState({ name: '', date: '', location_name: '' });
  
  // Automation Settings (With Editable Text)
  const [automation, setAutomation] = useState({ 
    reminder: true, 
    location: false, 
    thankYou: false,
    templates: {
      reminder: "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒØŒ Ù†Ø°ÙƒØ±Ùƒ Ø¨Ù…ÙˆØ¹Ø¯ Ø­ÙÙ„Ù†Ø§ ØºØ¯Ø§Ù‹.. Ù†ØªØ´Ø±Ù Ø¨Ø­Ø¶ÙˆØ±Ùƒ!",
      location: "Ù‡Ø°Ø§ Ù‡Ùˆ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­ÙÙ„ØŒ Ù†Ù†ØªØ¸Ø±ÙƒÙ… Ø¨Ø´ÙˆÙ‚ ğŸ“",
      thankYou: "Ø´ÙƒØ±Ø§Ù‹ Ù„Ø­Ø¶ÙˆØ±Ùƒ ÙˆÙ…Ø´Ø§Ø±ÙƒØªÙ†Ø§ ÙØ±Ø­ØªÙ†Ø§ âœ¨"
    }
  });

  useEffect(() => {
    fetchData();
    const channel = supabase.channel('room-updates')
      .on('postgres_changes', { event: '*', schema: 'public', table: 'attendees', filter: `event_id=eq.${id}` }, () => fetchData())
      .subscribe();
    return () => { supabase.removeChannel(channel) };
  }, [id]);

  const fetchData = async () => {
    const { data: eventData } = await supabase.from('events').select('*').eq('id', id).single();
    if (eventData) {
      setEvent(eventData);
      setEditForm({ name: eventData.name, date: eventData.date, location_name: eventData.location_name });
    }

    const { data: list } = await supabase.from('attendees').select('*').eq('event_id', id).order('created_at', { ascending: false });
    if (list) {
      setAttendees(list);
      setStats({
        total: list.length,
        confirmed: list.filter(a => a.status === 'confirmed').length,
        attended: list.filter(a => a.attended).length,
        declined: list.filter(a => a.status === 'declined').length
      });
    }
    setLoading(false);
  };

  // --- Bulk Actions Logic ---
  const toggleSelectAll = () => {
    if (selectedIds.size === filteredAttendees.length) {
      setSelectedIds(new Set());
    } else {
      setSelectedIds(new Set(filteredAttendees.map(a => a.id)));
    }
  };

  const toggleSelectOne = (guestId: string) => {
    const newSet = new Set(selectedIds);
    if (newSet.has(guestId)) newSet.delete(guestId);
    else newSet.add(guestId);
    setSelectedIds(newSet);
  };

  const handleBulkDelete = async () => {
    if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ${selectedIds.size} Ù…Ø¯Ø¹ÙˆØŸ`)) return;
    await supabase.from('attendees').delete().in('id', Array.from(selectedIds));
    setSelectedIds(new Set());
    fetchData();
  };

  // --- Add Guest Logic ---
  const handleAddGuest = async () => {
    if (!newGuest.name || !newGuest.phone) return alert('Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©');
    const { error } = await supabase.from('attendees').insert([{
      event_id: id,
      name: newGuest.name,
      phone: newGuest.phone,
      category: newGuest.category,
      status: 'confirmed' // Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ Ù…Ø¤ÙƒØ¯ Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
    }]);
    
    if (!error) {
      alert('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© âœ…');
      setIsAddGuestOpen(false);
      setNewGuest({ name: '', phone: '', category: 'GENERAL' });
      fetchData();
    }
  };

  // --- Export CSV ---
  const handleExportCSV = () => {
    const headers = ['Ø§Ù„Ø§Ø³Ù…', 'Ø§Ù„Ø¬ÙˆØ§Ù„', 'Ø§Ù„Ø­Ø§Ù„Ø©', 'ÙˆÙ‚Øª Ø§Ù„Ø­Ø¶ÙˆØ±', 'Ø§Ù„ØªØµÙ†ÙŠÙ'];
    const rows = attendees.map(g => [
      g.name, 
      g.phone, 
      g.status,
      g.attended ? new Date(g.updated_at).toLocaleTimeString('ar-SA') : '-', // Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆÙ‚Øª Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙƒÙˆÙ‚Øª Ø­Ø¶ÙˆØ± ØªÙ‚Ø±ÙŠØ¨ÙŠ
      g.category
    ]);
    const csvContent = "data:text/csv;charset=utf-8,\uFEFF" + [headers.join(','), ...rows.map(e => e.join(','))].join('\n');
    const link = document.createElement("a");
    link.setAttribute("href", encodeURI(csvContent));
    link.setAttribute("download", `${event.name}_guests.csv`);
    document.body.appendChild(link);
    link.click();
  };

  if (loading) return <div className="p-8 flex justify-center"><Loader2 className="animate-spin text-[#C19D65]" /></div>;
  if (!event) return <div className="p-8 text-white">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©</div>;

  const filteredAttendees = attendees.filter(a => {
    const matchesSearch = a.name.toLowerCase().includes(searchQuery.toLowerCase()) || a.phone.includes(searchQuery);
    const matchesFilter = filterType === 'all' ? true :
      filterType === 'attended' ? a.attended :
      filterType === 'confirmed' ? a.status === 'confirmed' :
      !a.attended; 
    return matchesSearch && matchesFilter;
  });

  const getCategoryStyle = (cat: string) => {
    if (cat === 'VIP') return 'bg-purple-500/20 text-purple-300 border-purple-500/30 shadow-[0_0_10px_rgba(168,85,247,0.2)]';
    if (cat === 'FAMILY') return 'bg-[#C19D65]/20 text-[#C19D65] border-[#C19D65]/30';
    return 'bg-white/5 text-white/40 border-white/10';
  };

  return (
    <div className="p-6 md:p-10 space-y-8 min-h-screen font-sans text-white relative" dir="rtl">
      
      {/* Top Bar */}
      <div className="flex justify-between items-center">
        <Link href="/dashboard" className="text-white/50 hover:text-white flex items-center gap-2 transition-colors"><ArrowLeft size={16}/> Ø§Ù„Ø¹ÙˆØ¯Ø©</Link>
        <div className="flex gap-2">
           {/* Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø±ÙŠØ¹ */}
           <button onClick={() => setIsAddGuestOpen(true)} className="px-6 py-2 bg-[#C19D65] text-black rounded-xl text-sm font-bold flex items-center gap-2 hover:brightness-110 shadow-lg animate-in zoom-in">
              <Plus size={18} /> Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø¹Ùˆ
           </button>
           <button onClick={handleExportCSV} className="px-4 py-2 bg-[#27272A] rounded-xl text-xs font-bold flex items-center gap-2 hover:bg-[#3F3F46] border border-white/10">
              <Download size={14} /> ØªØµØ¯ÙŠØ±
           </button>
        </div>
      </div>

      {/* --- Stats Section (Compact) --- */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div className="bg-[#18181B] p-5 rounded-2xl border border-white/10 flex justify-between items-center">
             <div><p className="text-xs text-white/40 font-bold mb-1">Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</p><h3 className="text-3xl font-black">{stats.total}</h3></div>
             <Users size={24} className="text-white/20"/>
          </div>
          <div className="bg-[#18181B] p-5 rounded-2xl border border-white/10 flex justify-between items-center relative overflow-hidden">
             <div className="z-10"><p className="text-xs text-white/40 font-bold mb-1">Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙØ¹Ù„ÙŠ</p><h3 className="text-3xl font-black text-green-500">{stats.attended}</h3></div>
             <DonutChart percentage={stats.total > 0 ? Math.round((stats.attended/stats.total)*100) : 0} color="#22c55e" />
          </div>
          <div className="bg-[#18181B] p-5 rounded-2xl border border-white/10 flex justify-between items-center">
             <div><p className="text-xs text-white/40 font-bold mb-1">RSVP Ù…Ø¤ÙƒØ¯</p><h3 className="text-3xl font-black text-blue-500">{stats.confirmed}</h3></div>
             <CheckCircle2 size={24} className="text-blue-500/20"/>
          </div>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
         {/* --- Right: Smart Guest List (2/3) --- */}
         <div className="lg:col-span-2 space-y-4">
            
            {/* Toolbar */}
            <div className="flex flex-col md:flex-row gap-4 justify-between items-end md:items-center bg-[#18181B] p-4 rounded-2xl border border-white/10">
               <div className="flex gap-2 overflow-x-auto w-full md:w-auto pb-2 md:pb-0 scrollbar-hide">
                   {/* Tabs */}
                   {[
                      { id: 'all', label: 'Ø§Ù„ÙƒÙ„' },
                      { id: 'confirmed', label: 'Ù…Ø¤ÙƒØ¯' },
                      { id: 'attended', label: 'Ø­Ø§Ø¶Ø±' },
                      { id: 'pending', label: 'Ù„Ù… ÙŠØµÙ„' },
                   ].map((tab) => (
                      <button key={tab.id} onClick={() => setFilterType(tab.id as any)}
                         className={`px-4 py-2 rounded-lg text-xs font-bold border transition-all whitespace-nowrap ${filterType === tab.id ? 'bg-white text-black border-white' : 'bg-black/20 text-white/50 border-transparent hover:bg-white/5'}`}>
                         {tab.label}
                      </button>
                   ))}
               </div>
               
               <div className="relative w-full md:w-64">
                  <Search className="absolute right-3 top-1/2 -translate-y-1/2 text-white/30" size={16} />
                  <input type="text" placeholder="Ø¨Ø­Ø«..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} 
                    className="w-full bg-black/40 border border-white/10 rounded-xl py-2 pr-10 pl-4 text-sm focus:border-[#C19D65] outline-none" />
               </div>
            </div>

            {/* Bulk Action Bar (Shows when items selected) */}
            {selectedIds.size > 0 && (
               <div className="bg-[#C19D65] text-black p-3 rounded-xl flex justify-between items-center animate-in slide-in-from-top-2">
                  <span className="font-bold text-sm px-2">ØªÙ… ØªØ­Ø¯ÙŠØ¯ {selectedIds.size} Ø¶ÙŠÙ</span>
                  <div className="flex gap-2">
                     <button className="px-3 py-1 bg-black/10 hover:bg-black/20 rounded-lg text-xs font-bold">Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯Ø¹ÙˆØ©</button>
                     <button onClick={handleBulkDelete} className="px-3 py-1 bg-red-500/20 hover:bg-red-500/30 text-red-900 rounded-lg text-xs font-bold flex items-center gap-1"><Trash2 size={12}/> Ø­Ø°Ù</button>
                  </div>
               </div>
            )}

            {/* Table */}
            <div className="bg-[#18181B] rounded-[2rem] border border-white/10 overflow-hidden min-h-[500px] flex flex-col">
               <div className="overflow-x-auto flex-1">
                  <table className="w-full text-right text-sm">
                     <thead className="bg-white/5 text-white/40 text-xs sticky top-0 z-10 backdrop-blur-md">
                        <tr>
                           <th className="p-4 w-10">
                              <button onClick={toggleSelectAll} className="opacity-60 hover:opacity-100">
                                 {selectedIds.size === filteredAttendees.length && filteredAttendees.length > 0 ? <CheckSquare size={18}/> : <Square size={18}/>}
                              </button>
                           </th>
                           <th className="p-4">Ø§Ù„Ø¶ÙŠÙ</th>
                           <th className="p-4 text-center">Ø§Ù„ÙˆØµÙˆÙ„</th>
                           <th className="p-4 text-center">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</th>
                        </tr>
                     </thead>
                     <tbody className="divide-y divide-white/5">
                        {filteredAttendees.length > 0 ? filteredAttendees.map(g => (
                           <tr key={g.id} className={`hover:bg-white/5 transition-colors group ${selectedIds.has(g.id) ? 'bg-[#C19D65]/5' : ''}`}>
                              
                              {/* Checkbox */}
                              <td className="p-4">
                                 <button onClick={() => toggleSelectOne(g.id)} className={`transition-colors ${selectedIds.has(g.id) ? 'text-[#C19D65]' : 'text-white/20 hover:text-white'}`}>
                                    {selectedIds.has(g.id) ? <CheckSquare size={18}/> : <Square size={18}/>}
                                 </button>
                              </td>

                              {/* Guest Info */}
                              <td className="p-4">
                                 <div className="font-bold text-white/90 flex items-center gap-2">
                                    {g.name}
                                    <span className={`text-[9px] px-1.5 py-0.5 rounded border font-mono uppercase ${getCategoryStyle(g.category || 'GENERAL')}`}>
                                       {g.category || 'GENERAL'}
                                    </span>
                                 </div>
                                 <div className="font-mono text-white/40 dir-ltr text-right text-xs mt-0.5">{g.phone}</div>
                              </td>

                              {/* Arrival Time (Timestamp) */}
                              <td className="p-4 text-center">
                                 {g.attended ? (
                                    <div className="inline-flex flex-col items-center">
                                       <span className="px-3 py-1 bg-green-500 text-black rounded-full text-xs font-black shadow-[0_0_10px_rgba(34,197,94,0.4)]">
                                          {new Date(g.updated_at).toLocaleTimeString('en-US', {hour: '2-digit', minute:'2-digit'})}
                                       </span>
                                       <span className="text-[9px] text-green-500/50 mt-1">ÙˆÙ‚Øª Ø§Ù„Ù…Ø³Ø­</span>
                                    </div>
                                 ) : (
                                    <span className="text-white/10 text-xl font-bold">-</span>
                                 )}
                              </td>

                              {/* Quick Actions (Context Aware) */}
                              <td className="p-4 text-center">
                                 <div className="flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                    {!g.attended && (
                                       <>
                                          <a href={`https://wa.me/${g.phone}`} target="_blank" className="p-2 bg-green-500/10 hover:bg-green-500 text-green-500 hover:text-black rounded-lg transition-all" title="ÙˆØ§ØªØ³Ø§Ø¨">
                                             <MessageCircle size={14}/>
                                          </a>
                                          <a href={`tel:${g.phone}`} className="p-2 bg-white/5 hover:bg-white text-white hover:text-black rounded-lg transition-all" title="Ø§ØªØµØ§Ù„">
                                             <Phone size={14}/>
                                          </a>
                                       </>
                                    )}
                                    <button onClick={() => handleDeleteGuest(g.id)} className="p-2 bg-white/5 hover:bg-red-500/20 text-white/50 hover:text-red-500 rounded-lg">
                                       <Trash2 size={14}/>
                                    </button>
                                 </div>
                              </td>
                           </tr>
                        )) : (
                           <tr><td colSpan={5} className="p-12 text-center text-white/20">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</td></tr>
                        )}
                     </tbody>
                  </table>
               </div>
            </div>
         </div>

         {/* --- Left: Automation & Config (1/3) --- */}
         <div className="space-y-6">
            
            {/* Automation Card with Edit Buttons */}
            <div className="bg-[#18181B] rounded-[2rem] border border-white/10 p-6 relative overflow-hidden">
               <div className="flex justify-between items-center mb-6">
                  <div className="flex items-center gap-3">
                     <div className="w-10 h-10 rounded-full bg-green-500/10 flex items-center justify-center text-green-500"><MessageCircle size={20} /></div>
                     <div><h3 className="font-bold">Ø§Ù„Ø£ØªÙ…ØªØ©</h3><p className="text-xs text-white/40">ØªØ®ØµÙŠØµ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</p></div>
                  </div>
                  <button onClick={() => setIsMessageConfigOpen(true)} className="p-2 hover:bg-white/5 rounded-lg text-white/40 hover:text-white"><Settings size={18}/></button>
               </div>

               <div className="space-y-3">
                  {/* Reminder */}
                  <div className="flex justify-between items-center p-3 bg-black/20 rounded-xl border border-white/5 group">
                     <span className="text-sm flex gap-2"><Bell size={16} className="text-white/50"/> ØªØ°ÙƒÙŠØ± (24 Ø³)</span>
                     <div className="flex items-center gap-2">
                        <button onClick={() => setIsMessageConfigOpen(true)} className="opacity-0 group-hover:opacity-100 p-1 text-xs text-white/30 hover:text-white"><Edit size={12}/></button>
                        <div className={`w-3 h-3 rounded-full ${automation.reminder ? 'bg-green-500 shadow-[0_0_8px_green]' : 'bg-red-500'}`}></div>
                     </div>
                  </div>
                  
                  {/* Location */}
                  <div className="flex justify-between items-center p-3 bg-black/20 rounded-xl border border-white/5 group">
                     <span className="text-sm flex gap-2"><MapPin size={16} className="text-white/50"/> Ø§Ù„Ù…ÙˆÙ‚Ø¹ (1 Ø³)</span>
                     <div className="flex items-center gap-2">
                        <button onClick={() => setIsMessageConfigOpen(true)} className="opacity-0 group-hover:opacity-100 p-1 text-xs text-white/30 hover:text-white"><Edit size={12}/></button>
                        <div className={`w-3 h-3 rounded-full ${automation.location ? 'bg-green-500 shadow-[0_0_8px_green]' : 'bg-red-500'}`}></div>
                     </div>
                  </div>
               </div>
            </div>

            {/* Quick Link Card */}
            <div className="bg-[#18181B] rounded-[2rem] border border-white/10 p-6 text-center">
               <h3 className="font-bold mb-4 text-[#C19D65]">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø§Ø³Ø­ Ø§Ù„Ø¶ÙˆØ¦ÙŠ</h3>
               <div className="p-3 bg-black/30 rounded-xl mb-4 font-mono text-xs text-white/60 truncate select-all">
                  {`${window.location.origin}/scan/${id}`}
               </div>
               <button onClick={() => {navigator.clipboard.writeText(`${window.location.origin}/scan/${id}`); alert('ØªÙ… Ø§Ù„Ù†Ø³Ø®')}} 
                  className="w-full py-3 bg-[#C19D65] text-black font-bold rounded-xl hover:brightness-110">
                  Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
               </button>
            </div>

         </div>
      </div>

      {/* --- MODALS --- */}
      
      {/* 1. Add Guest Modal */}
      {isAddGuestOpen && (
         <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div className="bg-[#18181B] w-full max-w-sm rounded-3xl border border-white/10 p-6 animate-in zoom-in">
               <h3 className="text-xl font-bold mb-4 flex items-center gap-2"><Plus size={20}/> Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø¹Ùˆ Ø¬Ø¯ÙŠØ¯</h3>
               <div className="space-y-4">
                  <input type="text" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ" value={newGuest.name} onChange={e => setNewGuest({...newGuest, name: e.target.value})} 
                     className="w-full bg-black/40 border border-white/10 rounded-xl p-3 outline-none focus:border-[#C19D65]" />
                  <input type="tel" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ (9665...)" value={newGuest.phone} onChange={e => setNewGuest({...newGuest, phone: e.target.value})} 
                     className="w-full bg-black/40 border border-white/10 rounded-xl p-3 outline-none focus:border-[#C19D65] dir-ltr text-right" />
                  <select value={newGuest.category} onChange={e => setNewGuest({...newGuest, category: e.target.value})}
                     className="w-full bg-black/40 border border-white/10 rounded-xl p-3 outline-none focus:border-[#C19D65] appearance-none">
                     <option value="GENERAL">Ø¶ÙŠÙ Ø¹Ø§Ù…</option>
                     <option value="VIP">VIP (ÙƒØ¨Ø§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ§Øª)</option>
                     <option value="FAMILY">Ø£Ù‡Ù„ Ø§Ù„Ø¹Ø±Ø³</option>
                  </select>
                  <div className="flex gap-2 mt-4">
                     <button onClick={handleAddGuest} className="flex-1 bg-[#C19D65] text-black font-bold py-3 rounded-xl hover:brightness-110">Ø­ÙØ¸ ÙˆØ¥Ø¶Ø§ÙØ©</button>
                     <button onClick={() => setIsAddGuestOpen(false)} className="px-4 py-3 bg-white/5 rounded-xl">Ø¥Ù„ØºØ§Ø¡</button>
                  </div>
               </div>
            </div>
         </div>
      )}

      {/* 2. Message Config Modal */}
      {isMessageConfigOpen && (
         <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div className="bg-[#18181B] w-full max-w-lg rounded-3xl border border-white/10 p-6 animate-in zoom-in">
               <h3 className="text-xl font-bold mb-1">ØªØ®ØµÙŠØµ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</h3>
               <p className="text-xs text-white/40 mb-6">Ù‚Ù… Ø¨ØªØ¹Ø¯ÙŠÙ„ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙŠ ØªØµÙ„ Ù„Ù„Ø¶ÙŠÙˆÙ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
               
               <div className="space-y-4">
                  <div>
                     <label className="text-xs text-[#C19D65] font-bold block mb-2">Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ°ÙƒÙŠØ± (Ù‚Ø¨Ù„ 24 Ø³Ø§Ø¹Ø©)</label>
                     <textarea rows={3} value={automation.templates.reminder} onChange={(e) => setAutomation({...automation, templates: {...automation.templates, reminder: e.target.value}})}
                        className="w-full bg-black/40 border border-white/10 rounded-xl p-3 text-sm outline-none focus:border-[#C19D65]" />
                  </div>
                  <div>
                     <label className="text-xs text-green-500 font-bold block mb-2">Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ù‚Ø¨Ù„ 1 Ø³Ø§Ø¹Ø©)</label>
                     <textarea rows={2} value={automation.templates.location} onChange={(e) => setAutomation({...automation, templates: {...automation.templates, location: e.target.value}})}
                        className="w-full bg-black/40 border border-white/10 rounded-xl p-3 text-sm outline-none focus:border-green-500" />
                  </div>
                  <button onClick={() => {setIsMessageConfigOpen(false); alert('ØªÙ… Ø­ÙØ¸ Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„')}} className="w-full bg-white text-black font-bold py-3 rounded-xl mt-4">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
               </div>
            </div>
         </div>
      )}

    </div>
  );
}
</file>

<file path="app/dashboard/events/new/page.tsx">
'use client';

import { useState } from 'react';
import { supabase } from '@/app/utils/supabase/client'; 
import { 
  Sparkles, Briefcase, Calendar, MapPin, 
  Type, Eye, Link as LinkIcon, Loader2, ArrowRight
} from 'lucide-react';
import { useRouter } from 'next/navigation';

export default function NewEventWizard() {
  const router = useRouter();
  const [step, setStep] = useState(1);
  const [loading, setLoading] = useState(false);
  
  const [eventType, setEventType] = useState<'social' | 'business' | null>('social');
  const [selectedColor, setSelectedColor] = useState('#C19D65');

  const [eventDetails, setEventDetails] = useState({ 
    name: '', 
    date: '', 
    locationName: '', 
    locationLink: '',
    groomName: '', 
    brideName: '', 
    companyLogo: null as string | null,
  });

  // âœ… 1. Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… Ø¨ØµÙŠØºØ© YYYY-MM-DD
  const getTodayDate = () => {
    return new Date().toISOString().split('T')[0];
  };

  const nextStep = () => setStep((prev) => prev + 1);
  const prevStep = () => setStep((prev) => prev - 1);

  const handleCreateEvent = async () => {
    if (!eventDetails.name || !eventDetails.date) {
      alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®');
      return;
    }
    setLoading(true);
    try {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) throw new Error('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');

      const { data, error } = await supabase
        .from('events')
        .insert([{
            user_id: user.id,
            name: eventDetails.name,
            date: eventDetails.date,
            type: eventType,
            status: 'active',
            guests_count: 0,
            location_name: eventDetails.locationName,
            location_link: eventDetails.locationLink,
            theme_color: selectedColor,
            groom_name: eventType === 'social' ? eventDetails.groomName : null,
            bride_name: eventType === 'social' ? eventDetails.brideName : null,
            company_logo: eventType === 'business' ? eventDetails.companyLogo : null,
        }])
        .select()
        .single();

      if (error) throw error;
      router.push('/dashboard'); 
    } catch (err: any) {
      alert(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-[#0A0A0C] text-white font-sans flex" dir="rtl">
      
      {/* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠÙ…Ù†: Ø§Ù„ÙÙˆØ±Ù… */}
      <div className="w-full lg:w-1/2 p-8 pt-24 overflow-y-auto h-screen scrollbar-hide">
        <div className="max-w-md mx-auto">
          
          <button onClick={() => router.back()} className="flex items-center gap-2 text-white/40 hover:text-white mb-8 transition-colors text-sm font-bold">
            <ArrowRight size={16} /> Ø¥Ù„ØºØ§Ø¡ ÙˆØ¹ÙˆØ¯Ø©
          </button>

          <div className="flex items-center gap-2 mb-10">
            {[1, 2, 3].map((s) => (
              <div key={s} className={`h-1.5 flex-1 rounded-full transition-all duration-500 ${step >= s ? 'bg-[#C19D65]' : 'bg-white/10'}`} style={step >= s ? { backgroundColor: selectedColor } : {}}></div>
            ))}
          </div>

          <div className="min-h-[400px]">
            {/* Step 1: Event Type */}
            {step === 1 && (
              <div className="animate-in fade-in slide-in-from-right duration-300">
                <h1 className="text-3xl font-black mb-2">Ù…Ø§ Ù†ÙˆØ¹ Ù…Ù†Ø§Ø³Ø¨ØªÙƒØŸ âœ¨</h1>
                <p className="text-white/40 mb-8 text-sm">Ø³Ù†Ù‚ÙˆÙ… Ø¨ØªØ®ØµÙŠØµ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø®ØªÙŠØ§Ø±Ùƒ.</p>
                <div className="space-y-4">
                  <button onClick={() => { setEventType('social'); setSelectedColor('#C19D65'); nextStep(); }} className={`w-full p-6 rounded-3xl border transition-all text-right flex items-center gap-4 group ${eventType === 'social' ? 'border-[#C19D65] bg-[#C19D65]/5' : 'border-white/5 bg-white/[0.02] hover:bg-white/5'}`}>
                    <div className="w-12 h-12 rounded-2xl bg-[#C19D65]/10 flex items-center justify-center text-[#C19D65]"><Sparkles size={24} /></div>
                    <div>
                      <p className="font-bold">Ø£ÙØ±Ø§Ø­ ÙˆÙ…Ù†Ø§Ø³Ø¨Ø§Øª Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</p>
                      <p className="text-xs text-white/30 mt-1">Ø¯Ø¹ÙˆØ§Øª Ø²ÙØ§ÙØŒ Ø®Ø·ÙˆØ¨Ø©ØŒ ØªØ®Ø±Ø¬</p>
                    </div>
                  </button>
                  <button onClick={() => { setEventType('business'); setSelectedColor('#3B82F6'); nextStep(); }} className={`w-full p-6 rounded-3xl border transition-all text-right flex items-center gap-4 group ${eventType === 'business' ? 'border-blue-500 bg-blue-500/5' : 'border-white/5 bg-white/[0.02] hover:bg-white/5'}`}>
                    <div className="w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-500"><Briefcase size={24} /></div>
                    <div>
                      <p className="font-bold">Ø£Ø¹Ù…Ø§Ù„ ÙˆÙ…Ø¤ØªÙ…Ø±Ø§Øª</p>
                      <p className="text-xs text-white/30 mt-1">Ù†Ø¯ÙˆØ§ØªØŒ ÙˆØ±Ø´ Ø¹Ù…Ù„ØŒ Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª</p>
                    </div>
                  </button>
                </div>
              </div>
            )}

            {/* Step 2: Details - Here is the Date Update */}
            {step === 2 && (
              <div className="animate-in slide-in-from-left duration-300 space-y-5">
                <h1 className="text-3xl font-black mb-2">Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ğŸ“</h1>
                
                <div className="space-y-2">
                  <label className="text-xs font-bold text-white/50">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©</label>
                  <input type="text" value={eventDetails.name} onChange={(e) => setEventDetails({...eventDetails, name: e.target.value})} className="w-full bg-white/5 border border-white/10 rounded-2xl p-4 outline-none focus:border-white/30 transition-colors" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù‡Ù†Ø§..." style={{ caretColor: selectedColor }} autoFocus />
                </div>

                {eventType === 'social' && (
                  <div className="grid grid-cols-2 gap-4">
                     <div className="space-y-2">
                       <label className="text-xs font-bold text-white/50">Ø§Ø³Ù… Ø§Ù„Ø¹Ø±ÙŠØ³</label>
                       <input type="text" value={eventDetails.groomName} onChange={(e) => setEventDetails({...eventDetails, groomName: e.target.value})} className="w-full bg-white/5 border border-white/10 rounded-2xl p-4 outline-none focus:border-white/30" />
                     </div>
                     <div className="space-y-2">
                       <label className="text-xs font-bold text-white/50">Ø§Ø³Ù… Ø§Ù„Ø¹Ø±ÙˆØ³</label>
                       <input type="text" value={eventDetails.brideName} onChange={(e) => setEventDetails({...eventDetails, brideName: e.target.value})} className="w-full bg-white/5 border border-white/10 rounded-2xl p-4 outline-none focus:border-white/30" />
                     </div>
                  </div>
                )}

                <div className="grid grid-cols-2 gap-4">
                  {/* âœ… 2. Ø­Ù‚Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø·ÙˆØ± */}
                  <div className="space-y-2 relative group">
                    <label className="text-xs font-bold text-white/50">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <div className="relative">
                      {/* Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø®ØµØµØ© */}
                      <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/40 group-focus-within:text-white transition-colors">
                        <Calendar size={18} />
                      </div>
                      <input 
                        type="date"
                        // âœ… Ø§Ù„Ù…Ù†Ø·Ù‚: Ù…Ù†Ø¹ Ø§Ø®ØªÙŠØ§Ø± ØªÙˆØ§Ø±ÙŠØ® Ø³Ø§Ø¨Ù‚Ø©
                        min={getTodayDate()} 
                        value={eventDetails.date} 
                        onChange={(e) => setEventDetails({...eventDetails, date: e.target.value})} 
                        className="w-full bg-white/5 border border-white/10 rounded-2xl p-4 pr-12 outline-none appearance-none transition-all focus:border-opacity-50 cursor-pointer text-white/90 placeholder-transparent"
                        style={{ 
                          // âœ… Ø§Ù„ØªØµÙ…ÙŠÙ…: Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ + Ù„ÙˆÙ† Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø®ØµØµ
                          colorScheme: 'dark',
                          borderColor: eventDetails.date ? selectedColor : 'rgba(255,255,255,0.1)'
                        }} 
                      />
                    </div>
                  </div>

                  <div className="space-y-2">
                    <label className="text-xs font-bold text-white/50">Ø§Ù„Ù…ÙƒØ§Ù†</label>
                    <div className="relative">
                        <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/40">
                            <MapPin size={18} />
                        </div>
                        <input type="text" value={eventDetails.locationName} onChange={(e) => setEventDetails({...eventDetails, locationName: e.target.value})} className="w-full bg-white/5 border border-white/10 rounded-2xl p-4 pr-12 outline-none focus:border-white/30" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø¹Ø©..." />
                    </div>
                  </div>
                </div>

                <div className="flex justify-between pt-6">
                  <button onClick={prevStep} className="px-6 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-sm font-bold">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                  <button onClick={nextStep} style={{ backgroundColor: selectedColor }} className="px-8 py-3 rounded-xl text-black font-black hover:scale-105 transition-all">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>
              </div>
            )}

            {/* Step 3: Colors & Preview */}
            {step === 3 && (
              <div className="animate-in slide-in-from-left duration-300 space-y-6">
                <h1 className="text-3xl font-black mb-2">Ø§Ù„Ù„Ù…Ø³Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø© ğŸ¨</h1>
                
                <div>
                  <label className="text-xs font-bold text-white/50 mb-3 block">Ù„ÙˆÙ† Ø§Ù„Ø«ÙŠÙ…</label>
                  <div className="flex gap-3 flex-wrap">
                    {['#C19D65', '#3B82F6', '#8B5CF6', '#EC4899', '#10B981', '#F59E0B'].map((color) => (
                      <button key={color} onClick={() => setSelectedColor(color)} className={`w-12 h-12 rounded-full border-2 transition-all ${selectedColor === color ? 'border-white scale-110' : 'border-transparent opacity-40 hover:opacity-100'}`} style={{ backgroundColor: color }} />
                    ))}
                  </div>
                </div>

                <div className="bg-gradient-to-br from-white/5 to-transparent p-5 rounded-3xl border border-white/5 mt-6">
                   <div className="flex items-center gap-3 mb-2">
                      <div className="w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-500"><Eye size={16} /></div>
                      <span className="font-bold text-sm">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù†Ø´Ø·Ø©</span>
                   </div>
                   <p className="text-xs text-white/40 leading-relaxed">
                     Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ Ø£Ø¯Ø®Ù„ØªÙ‡Ø§ ØªØ¸Ù‡Ø± Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„ÙŠØ³Ø±Ù‰. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø±.
                   </p>
                </div>

                <div className="flex justify-between pt-6">
                  <button onClick={prevStep} className="px-6 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-sm font-bold">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                  <button onClick={handleCreateEvent} disabled={loading} style={{ backgroundColor: selectedColor }} className="px-8 py-3 rounded-xl text-black font-black hover:scale-105 transition-all flex items-center gap-2 disabled:opacity-70">
                    {loading ? <Loader2 className="animate-spin" size={18} /> : 'Ù†Ø´Ø± Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©'}
                  </button>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>

      {/* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠØ³Ø±: Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø­ÙŠØ© */}
      <div className="hidden lg:flex w-1/2 bg-[#0F0F12] border-r border-white/5 relative items-center justify-center p-10 overflow-hidden">
        
        <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] rounded-full blur-[120px] opacity-10 transition-colors duration-1000" style={{ backgroundColor: selectedColor }}></div>

        <div className="relative w-[380px] h-[750px] bg-black rounded-[3rem] border-[8px] border-[#2A2A2E] shadow-2xl overflow-hidden z-10 transition-transform duration-500 hover:scale-[1.02]">
          <div className="absolute top-0 left-1/2 -translate-x-1/2 w-40 h-7 bg-[#2A2A2E] rounded-b-2xl z-20"></div>

          <div className="w-full h-full bg-[#050505] relative overflow-hidden flex flex-col">
            <div className="h-2/5 w-full relative transition-colors duration-700" style={{ backgroundColor: selectedColor }}>
               <div className="absolute inset-0 bg-gradient-to-b from-black/10 via-transparent to-[#050505]"></div>
               <div className="absolute -bottom-10 left-1/2 -translate-x-1/2 w-24 h-24 bg-[#050505] rounded-full p-2 flex items-center justify-center shadow-2xl">
                 <div className="w-full h-full rounded-full border border-white/10 flex items-center justify-center bg-white/5">
                    {eventType === 'business' ? <Briefcase style={{ color: selectedColor }} /> : <Sparkles style={{ color: selectedColor }} />}
                 </div>
               </div>
            </div>

            <div className="flex-1 px-6 pt-14 text-center pb-8 overflow-y-auto">
              <p className="text-[10px] uppercase tracking-[0.2em] text-white/40 mb-4 animate-pulse">Ø¯Ø¹ÙˆØ© Ø®Ø§ØµØ©</p>
              
              {eventType === 'social' && (eventDetails.groomName || eventDetails.brideName) && (
                <div className="mb-4">
                  <h2 className="text-xl font-bold text-white">{eventDetails.groomName || 'Ø§Ø³Ù… Ø§Ù„Ø¹Ø±ÙŠØ³'}</h2>
                  <span className="text-xs text-white/30 my-1 block">&</span>
                  <h2 className="text-xl font-bold text-white">{eventDetails.brideName || 'Ø§Ø³Ù… Ø§Ù„Ø¹Ø±ÙˆØ³'}</h2>
                </div>
              )}

              <h1 className="text-2xl font-black text-white leading-tight mb-8">
                {eventDetails.name || 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©...'}
              </h1>

              <div className="bg-white/5 rounded-2xl p-4 border border-white/5 space-y-4 mb-8 backdrop-blur-sm">
                <div className="flex items-center gap-3 text-right">
                   <div className="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center"><Calendar size={14} className="opacity-70"/></div>
                   <div>
                      <p className="text-[9px] text-white/30 uppercase">Ø§Ù„ØªØ§Ø±ÙŠØ®</p>
                      <p className="text-xs font-bold text-white/90">{eventDetails.date || '---'}</p>
                   </div>
                </div>
                <div className="flex items-center gap-3 text-right">
                   <div className="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center"><MapPin size={14} className="opacity-70"/></div>
                   <div>
                      <p className="text-[9px] text-white/30 uppercase">Ø§Ù„Ù…ÙˆÙ‚Ø¹</p>
                      <p className="text-xs font-bold text-white/90">{eventDetails.locationName || '---'}</p>
                   </div>
                </div>
              </div>

              <div className="border border-dashed border-white/10 rounded-xl p-4 w-32 mx-auto opacity-40 mb-4">
                 <div className="w-full aspect-square bg-white/10 rounded"></div>
              </div>
              <p className="text-[9px] text-white/30">Ø£Ø¨Ø±Ø² Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„</p>

            </div>

            <div className="p-6 pt-0">
               <div style={{ backgroundColor: selectedColor }} className="w-full py-3 rounded-xl font-bold text-black text-center text-sm shadow-lg">
                  ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±
               </div>
            </div>
          </div>
        </div>

        <div className="absolute bottom-8 text-white/20 text-xs font-mono tracking-widest">
           LIVE PREVIEW MODE
        </div>
      </div>
    </div>
  );
}
</file>

<file path="app/dashboard/layout.tsx">
// app/dashboard/layout.tsx
export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <section className="min-h-screen bg-[#0A0A0C]">
      {/* Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙŠØ¶Ù…Ù† Ø£Ù† ØµÙØ­Ø© Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù„Ø§ ØªØ±Ø« Ø£ÙŠ Ø´Ø±ÙŠØ· Ø¬Ø§Ù†Ø¨ÙŠ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø¹Ù„ÙŠØ§ */}
      {children}
    </section>
  );
}
</file>

<file path="app/dashboard/page.tsx">
'use client';

import { useState, useEffect } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import {
  Plus, Calendar, Users, BarChart3, Clock,
  Settings, Zap, Bell, CheckCircle2, Crown,
  ArrowUpRight, Sparkles, Briefcase
} from 'lucide-react';
import Link from 'next/link';
import SubscriptionTracker from '@/app/components/SubscriptionTracker';
import { Event, Attendee } from '@/types';

// Ù…ÙƒÙˆÙ† Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‡ÙŠÙƒÙ„ÙŠ
const DashboardSkeleton = () => (
  <div className="space-y-8 animate-pulse">
    <div className="flex justify-between items-center">
      <div className="h-8 w-64 bg-white/5 rounded-xl"></div>
      <div className="h-10 w-32 bg-white/5 rounded-xl"></div>
    </div>
    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
      {[1, 2, 3, 4].map((i) => (
        <div key={i} className="h-32 bg-white/5 rounded-[2rem]"></div>
      ))}
    </div>
    <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <div className="lg:col-span-2 h-64 bg-white/5 rounded-[2.5rem]"></div>
      <div className="h-64 bg-white/5 rounded-[2.5rem]"></div>
    </div>
  </div>
);

export default function Dashboard() {
  const [loading, setLoading] = useState(true);
  const [userName, setUserName] = useState('');
  const [themeColor, setThemeColor] = useState('#C19D65');
  const [stats, setStats] = useState({
    activeEvents: 0,
    totalGuests: 0,
    confirmedGuests: 0,
    allEventsCount: 0
  });

  const [allEvents, setAllEvents] = useState<Event[]>([]);
  const [notifications, setNotifications] = useState<any[]>([]);

  useEffect(() => {
    const fetchData = async () => {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return;

      const { data: profile } = await supabase.from('profiles').select('*').eq('id', user.id).single();
      if (profile) {
        setUserName(profile.full_name);
        if (profile.interest === 'business') setThemeColor('#3B82F6');
      }

      // Ø¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª
      const { data: events } = await supabase
        .from('events')
        .select('*, attendees(status, created_at)')
        .order('date', { ascending: true }); // ØªØ±ØªÙŠØ¨ ØªØµØ§Ø¹Ø¯ÙŠ (Ø§Ù„Ø£Ù‚Ø±Ø¨ Ø£ÙˆÙ„Ø§Ù‹)

      if (events) {
        const totalGuests = events.reduce((acc, e) => acc + (e.attendees?.length || 0), 0);
        const confirmed = events.reduce((acc, e: any) => acc + (e.attendees?.filter((a: Attendee) => a.status === 'confirmed').length || 0), 0);
        const active = events.filter(e => e.status === 'active').length;

        // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
        let allAttendees: any[] = [];
        events.forEach(e => {
          if (e.attendees) {
            e.attendees.forEach((a: any) => allAttendees.push({ ...a, eventName: e.name }));
          }
        });
        const recentActivity = allAttendees
          .sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime())
          .slice(0, 3);

        setStats({ activeEvents: active, totalGuests, confirmedGuests: confirmed, allEventsCount: events.length });

        // âœ… Ø§Ù„ØªØºÙŠÙŠØ± Ù‡Ù†Ø§: Ù†Ø¶Ø¹ ÙƒÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø¨Ø¯ÙˆÙ† Ù‚Øµ (slice)
        setAllEvents(events);
        setNotifications(recentActivity);
      }

      setTimeout(() => setLoading(false), 800);
    };

    fetchData();
  }, []);

  const getDaysLeft = (dateStr: string) => {
    const diff = new Date(dateStr).getTime() - new Date().getTime();
    const days = Math.ceil(diff / (1000 * 3600 * 24));
    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ§Ø±ÙŠØ® ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠ Ù†Ø¹Ø±Ø¶ 0 Ø£Ùˆ Ø±Ù‚Ù… Ø³Ø§Ù„Ø¨
    return days;
  };

  if (loading) return (
    <div className="min-h-screen bg-[#0A0A0C] text-white p-6 pt-24 pb-20 font-sans" dir="rtl">
      <div className="max-w-7xl mx-auto"><DashboardSkeleton /></div>
    </div>
  );

  return (
    <div className="min-h-screen bg-[#0A0A0C] text-white p-6 pt-24 pb-20 font-sans" dir="rtl">
      <div className="max-w-7xl mx-auto space-y-8">

        {/* Header */}
        <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
          <div>
            <h1 className="text-3xl font-black mb-1">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span style={{ color: themeColor }}>{userName}</span> ğŸ‘‹</h1>
            <p className="text-white/40 text-sm font-medium">
              Ù„Ø¯ÙŠÙƒ {stats.allEventsCount} ÙØ¹Ø§Ù„ÙŠØ§Øª ÙÙŠ Ø³Ø¬Ù„Ùƒ.
            </p>
          </div>
          <div className="flex gap-3">
            <Link href="/dashboard/settings" className="p-3 rounded-xl bg-white/5 hover:bg-white/10 text-white/60 hover:text-white transition-colors relative">
              <Settings size={20} />
            </Link>
            <button className="p-3 rounded-xl bg-white/5 hover:bg-white/10 text-white/60 hover:text-white transition-colors relative">
              <Bell size={20} />
              {notifications.length > 0 && <span className="absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>}
            </button>
            <Link href="/dashboard/events/new" style={{ backgroundColor: themeColor }} className="text-black px-6 py-3 rounded-xl font-bold flex items-center gap-2 hover:scale-105 transition-all shadow-lg hover:shadow-[0_0_20px_rgba(193,157,101,0.3)]">
              <Plus size={18} /> Ø¥Ù†Ø´Ø§Ø¡ ÙØ¹Ø§Ù„ÙŠØ©
            </Link>
          </div>
        </div>

        {/* 1. Stats Panorama */}
        <div className="grid grid-cols-2 lg:grid-cols-4 gap-4">
          <div className="bg-[#0F0F12]/80 backdrop-blur-md border border-white/5 p-6 rounded-[2rem] hover:border-white/10 transition-colors group">
            <Calendar className="text-blue-500 mb-4 group-hover:scale-110 transition-transform" size={24} />
            <p className="text-white/40 text-xs font-bold uppercase tracking-wider">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©</p>
            <h3 className="text-3xl font-black mt-1">{stats.activeEvents}</h3>
          </div>
          <div className="bg-[#0F0F12]/80 backdrop-blur-md border border-white/5 p-6 rounded-[2rem] hover:border-white/10 transition-colors group">
            <Users className="text-green-500 mb-4 group-hover:scale-110 transition-transform" size={24} />
            <p className="text-white/40 text-xs font-bold uppercase tracking-wider">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¶ÙŠÙˆÙ</p>
            <h3 className="text-3xl font-black mt-1">{stats.totalGuests}</h3>
          </div>
          <div className="bg-[#0F0F12]/80 backdrop-blur-md border border-white/5 p-6 rounded-[2rem] hover:border-white/10 transition-colors group">
            <CheckCircle2 className="text-purple-500 mb-4 group-hover:scale-110 transition-transform" size={24} />
            <p className="text-white/40 text-xs font-bold uppercase tracking-wider">Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯</p>
            <h3 className="text-3xl font-black mt-1">
              {stats.totalGuests > 0 ? Math.round((stats.confirmedGuests / stats.totalGuests) * 100) : 0}%
            </h3>
          </div>
          <div className="bg-gradient-to-br from-[#0F0F12] to-[#1A1A1D] border border-white/5 p-6 rounded-[2rem] relative overflow-hidden group">
            <Crown className="text-[#C19D65] mb-4 group-hover:rotate-12 transition-transform" size={24} />
            <p className="text-white/40 text-xs font-bold uppercase tracking-wider">Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©</p>
            <h3 className="text-lg font-black mt-1 text-white">Ù†Ø´Ø·Ø©</h3>
            <Link href="/dashboard/settings" className="text-[10px] text-[#C19D65] underline mt-1 block">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</Link>
          </div>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">

          {/* 2. Left Column: All Events List */}
          <div className="lg:col-span-2 space-y-6">

            <h2 className="text-xl font-bold flex items-center gap-2"><Clock size={20} className="text-white/40" /> ÙƒÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª (Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±Ø©)</h2>

            {/* âœ… Ø§Ù„Ø­Ø§ÙˆÙŠØ© (Scrollable Container) */}
            <div className="space-y-4 max-h-[800px] overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-white/10 scrollbar-track-transparent">
              {allEvents.length > 0 ? (
                allEvents.map((event) => {
                  const daysLeft = getDaysLeft(event.date);
                  const isPast = daysLeft < 0;

                  return (
                    <div key={event.id} className={`bg-[#0F0F12] border ${isPast ? 'border-white/5 opacity-60' : 'border-white/10'} rounded-[2.5rem] p-6 relative overflow-hidden shadow-xl group hover:border-white/20 transition-all`}>
                      {/* Ø´Ø±ÙŠØ· Ù…Ù„ÙˆÙ† Ø¬Ø§Ù†Ø¨ÙŠ */}
                      <div className={`absolute right-0 top-0 h-full w-2 ${event.type === 'business' ? 'bg-blue-500' : 'bg-[#C19D65]'}`}></div>

                      <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 relative z-10 px-4">
                        <div>
                          <div className="flex gap-2 mb-3">
                            <span className={`text-[10px] font-bold px-3 py-1 rounded-full border ${event.type === 'business' ? 'bg-blue-500/10 text-blue-500 border-blue-500/20' : 'bg-[#C19D65]/10 text-[#C19D65] border-[#C19D65]/20'}`}>
                              {event.type === 'business' ? 'Ø£Ø¹Ù…Ø§Ù„' : 'Ù…Ù†Ø§Ø³Ø¨Ø© Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©'}
                            </span>

                            {/* Ø­Ø§Ù„Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® */}
                            {isPast ? (
                              <span className="text-[10px] font-bold px-3 py-1 rounded-full bg-red-500/10 border border-red-500/10 text-red-400">
                                Ù…Ù†ØªÙ‡ÙŠØ©
                              </span>
                            ) : (
                              <span className="text-[10px] font-bold px-3 py-1 rounded-full bg-white/5 border border-white/10 text-white/50">
                                {daysLeft} Ø£ÙŠØ§Ù… Ù…ØªØ¨Ù‚ÙŠØ©
                              </span>
                            )}
                          </div>
                          <h3 className="text-2xl font-black mb-2">{event.name}</h3>
                          <div className="flex items-center gap-4 text-white/50 text-sm">
                            <span className="flex items-center gap-1"><Calendar size={14} /> {new Date(event.date).toLocaleDateString('ar-SA')}</span>
                            <span className="flex items-center gap-1"><Users size={14} /> {event.guests_count || 0} Ø¶ÙŠÙ</span>
                          </div>
                        </div>

                        <div className="flex gap-3">
                          <Link href={`/dashboard/events/${event.id}`} className="px-6 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-white font-bold transition-all flex items-center gap-2 border border-white/5">
                            Ø¥Ø¯Ø§Ø±Ø© ÙˆØªØ¹Ø¯ÙŠÙ„ <ArrowUpRight size={16} />
                          </Link>
                        </div>
                      </div>
                    </div>
                  );
                })
              ) : (
                <div className="bg-[#0F0F12] border border-dashed border-white/10 rounded-[2.5rem] p-8 text-center flex flex-col items-center justify-center h-[250px]">
                  <div className="w-16 h-16 bg-white/5 rounded-full flex items-center justify-center text-white/20 mb-4"><Calendar size={32} /></div>
                  <h3 className="font-bold text-lg mb-1">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ©</h3>
                  <p className="text-white/40 text-sm mb-6">Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠ ÙØ¹Ø§Ù„ÙŠØ© Ø¨Ø¹Ø¯.</p>
                  <Link href="/dashboard/events/new" className="text-[#C19D65] font-bold text-sm underline hover:text-white transition-colors">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</Link>
                </div>
              )}
            </div>

            {/* Notifications Center */}
            {notifications.length > 0 && (
              <div className="bg-[#0F0F12] border border-white/5 rounded-[2rem] p-6 mt-8">
                <h3 className="text-sm font-bold text-white/50 mb-4 flex items-center gap-2"><Bell size={14} /> Ø¢Ø®Ø± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h3>
                <div className="space-y-4">
                  {notifications.map((notif, idx) => (
                    <div key={idx} className="flex items-start gap-3 pb-3 border-b border-white/5 last:border-0 last:pb-0">
                      <div className="w-8 h-8 rounded-full bg-green-500/10 flex items-center justify-center text-green-500 mt-1 shrink-0">
                        <Plus size={14} />
                      </div>
                      <div>
                        <p className="text-sm font-bold text-white">Ø§Ù†Ø¶Ù…Ø§Ù… Ø¶ÙŠÙ Ø¬Ø¯ÙŠØ¯</p>
                        <p className="text-xs text-white/40">ØªÙ… ØªØ³Ø¬ÙŠÙ„ <span className="text-white">{notif.name || 'Ø¶ÙŠÙ'}</span> ÙÙŠ ÙØ¹Ø§Ù„ÙŠØ© {notif.eventName}</p>
                      </div>
                      <span className="mr-auto text-[10px] text-white/20">{new Date(notif.created_at).toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' })}</span>
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>

          {/* 3. Right Column: Subscription & Quick Templates */}
          <div className="space-y-6">

            <SubscriptionTracker />

            <h2 className="text-xl font-bold flex items-center gap-2"><Zap size={20} className="text-white/40" /> Ù‚ÙˆØ§Ù„Ø¨ Ø³Ø±ÙŠØ¹Ø©</h2>
            <div className="space-y-3">
              <button onClick={() => window.location.href = '/dashboard/events/new'} className="w-full p-4 bg-[#0F0F12] border border-white/5 hover:border-[#C19D65]/50 hover:bg-[#C19D65]/5 rounded-2xl flex items-center gap-4 transition-all group text-right">
                <div className="w-12 h-12 rounded-xl bg-[#C19D65]/10 flex items-center justify-center text-[#C19D65] group-hover:scale-110 transition-transform"><Sparkles size={20} /></div>
                <div>
                  <h4 className="font-bold text-sm text-white group-hover:text-[#C19D65] transition-colors">Ø­ÙÙ„ Ø²ÙØ§Ù Ù…Ù„ÙƒÙŠ</h4>
                  <p className="text-[10px] text-white/40 mt-1">Ù‚Ø§Ù„Ø¨ Ø¬Ø§Ù‡Ø² Ø¨Ø¹Ø¨Ø§Ø±Ø§Øª ØªØ±Ø­ÙŠØ¨ÙŠØ© Ø±Ø³Ù…ÙŠØ© ÙˆØªØµØ§Ù…ÙŠÙ… Ø°Ù‡Ø¨ÙŠØ©</p>
                </div>
              </button>

              <button onClick={() => window.location.href = '/dashboard/events/new'} className="w-full p-4 bg-[#0F0F12] border border-white/5 hover:border-blue-500/50 hover:bg-blue-500/5 rounded-2xl flex items-center gap-4 transition-all group text-right">
                <div className="w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-500 group-hover:scale-110 transition-transform"><Briefcase size={20} /></div>
                <div>
                  <h4 className="font-bold text-sm text-white group-hover:text-blue-500 transition-colors">Ù…Ø¤ØªÙ…Ø± ØªÙ‚Ù†ÙŠ</h4>
                  <p className="text-[10px] text-white/40 mt-1">ÙŠØ´Ù…Ù„ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ ÙˆØ·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</p>
                </div>
              </button>
            </div>
          </div>
        </div>

      </div>
    </div>
  );
}
</file>

<file path="app/dashboard/settings/page.tsx">
'use client';

import { useState, useEffect } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import { User, CreditCard, Shield, Bell, Download, Check, AlertCircle } from 'lucide-react';

export default function SettingsPage() {
  const [activeTab, setActiveTab] = useState('profile');
  const [profile, setProfile] = useState<any>({});
  const [loading, setLoading] = useState(true);

  // Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„ÙÙˆØ§ØªÙŠØ± (Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø·)
  const invoices = [
    { id: 'INV-001', date: '2025-01-01', amount: '0.00', status: 'paid', plan: 'Free Plan' },
    // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ÙÙˆØ§ØªÙŠØ± Ù…Ø¯ÙÙˆØ¹Ø© Ù‡Ù†Ø§ Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹
  ];

  useEffect(() => {
    const fetchProfile = async () => {
      const { data: { user } } = await supabase.auth.getUser();
      if (user) {
        const { data } = await supabase.from('profiles').select('*').eq('id', user.id).single();
        setProfile(data || {});
      }
      setLoading(false);
    };
    fetchProfile();
  }, []);

  const handleUpdateProfile = async (e: React.FormEvent) => {
    e.preventDefault();
    alert('Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹..');
  };

  if (loading) return <div className="p-10 text-white">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>;

  return (
    <div className="min-h-screen bg-[#0A0A0C] text-white p-6 pt-24 font-sans" dir="rtl">
      <div className="max-w-4xl mx-auto">
        <h1 className="text-3xl font-black mb-8">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</h1>

        {/* Tabs Navigation */}
        <div className="flex gap-4 border-b border-white/10 mb-8 overflow-x-auto">
          <button onClick={() => setActiveTab('profile')} className={`pb-4 px-4 flex items-center gap-2 font-bold transition-all ${activeTab === 'profile' ? 'text-[#C19D65] border-b-2 border-[#C19D65]' : 'text-white/40 hover:text-white'}`}>
            <User size={18} /> Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
          </button>
          <button onClick={() => setActiveTab('billing')} className={`pb-4 px-4 flex items-center gap-2 font-bold transition-all ${activeTab === 'billing' ? 'text-[#C19D65] border-b-2 border-[#C19D65]' : 'text-white/40 hover:text-white'}`}>
            <CreditCard size={18} /> Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ÙˆØ§Ù„ÙÙˆØ§ØªÙŠØ±
          </button>
          <button onClick={() => setActiveTab('security')} className={`pb-4 px-4 flex items-center gap-2 font-bold transition-all ${activeTab === 'security' ? 'text-[#C19D65] border-b-2 border-[#C19D65]' : 'text-white/40 hover:text-white'}`}>
            <Shield size={18} /> Ø§Ù„Ø£Ù…Ø§Ù†
          </button>
        </div>

        {/* --- Tab: Profile --- */}
        {activeTab === 'profile' && (
          <div className="space-y-6 animate-in fade-in slide-in-from-bottom-4">
             <div className="bg-[#0F0F12] border border-white/5 rounded-[2rem] p-8">
               <h3 className="text-xl font-bold mb-6">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</h3>
               <form onSubmit={handleUpdateProfile} className="space-y-4 max-w-lg">
                  <div>
                    <label className="text-xs font-bold text-white/50 block mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                    <input type="text" defaultValue={profile.full_name} className="w-full bg-white/5 border border-white/10 rounded-xl p-4 outline-none focus:border-[#C19D65]" />
                  </div>
                  <div>
                    <label className="text-xs font-bold text-white/50 block mb-2">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© / Ø§Ù„Ø¬Ù‡Ø© (Ù„Ù„ÙØ§ØªÙˆØ±Ø©)</label>
                    <input type="text" defaultValue={profile.company_name} placeholder="Ø§Ø®ØªÙŠØ§Ø±ÙŠ" className="w-full bg-white/5 border border-white/10 rounded-xl p-4 outline-none focus:border-[#C19D65]" />
                  </div>
                  <div>
                    <label className="text-xs font-bold text-white/50 block mb-2">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ (VAT Number)</label>
                    <input type="text" defaultValue={profile.tax_number} placeholder="3xxxxxxxxxxxxx" className="w-full bg-white/5 border border-white/10 rounded-xl p-4 outline-none focus:border-[#C19D65]" />
                  </div>
                  <button className="bg-[#C19D65] text-black px-8 py-3 rounded-xl font-bold mt-4 hover:opacity-90">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
               </form>
             </div>
          </div>
        )}

        {/* --- Tab: Billing --- */}
        {activeTab === 'billing' && (
          <div className="space-y-6 animate-in fade-in slide-in-from-bottom-4">
            
            {/* Current Plan Card */}
            <div className="bg-gradient-to-r from-[#0F0F12] to-[#1A1A1D] border border-white/10 rounded-[2rem] p-8 relative overflow-hidden">
               <div className="absolute top-0 left-0 w-2 h-full bg-[#C19D65]"></div>
               <div className="flex justify-between items-start">
                  <div>
                    <p className="text-sm text-white/50 mb-1">Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</p>
                    <h2 className="text-3xl font-black text-white mb-2">Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© (Starter)</h2>
                    <p className="text-[#C19D65] text-sm font-bold flex items-center gap-2">
                       <Check size={14} /> ÙØ¹Ø§Ù„Ø© ÙˆÙ†Ø´Ø·Ø©
                    </p>
                  </div>
                  <button className="bg-[#C19D65] text-black px-6 py-2 rounded-xl font-bold text-sm shadow-lg hover:scale-105 transition-transform">
                    ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø¨Ø§Ù‚Ø© ğŸš€
                  </button>
               </div>
               <div className="mt-8 grid grid-cols-3 gap-4 border-t border-white/5 pt-6">
                  <div>
                    <p className="text-[10px] text-white/40 uppercase">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</p>
                    <p className="text-xl font-bold">1 <span className="text-xs text-white/30">/ 1</span></p>
                  </div>
                  <div>
                    <p className="text-[10px] text-white/40 uppercase">Ø§Ù„Ø¶ÙŠÙˆÙ Ù„ÙƒÙ„ ÙØ¹Ø§Ù„ÙŠØ©</p>
                    <p className="text-xl font-bold">50</p>
                  </div>
                  <div>
                    <p className="text-[10px] text-white/40 uppercase">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¬Ø¯ÙŠØ¯</p>
                    <p className="text-xl font-bold">Ù…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©</p>
                  </div>
               </div>
            </div>

            {/* Invoices Table */}
            <div className="bg-[#0F0F12] border border-white/5 rounded-[2rem] p-8">
               <h3 className="text-xl font-bold mb-6">Ø³Ø¬Ù„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h3>
               <div className="overflow-x-auto">
                 <table className="w-full text-sm text-right">
                   <thead>
                     <tr className="text-white/40 border-b border-white/5">
                       <th className="pb-4 pr-4">Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
                       <th className="pb-4">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                       <th className="pb-4">Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                       <th className="pb-4">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                       <th className="pb-4">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                       <th className="pb-4"></th>
                     </tr>
                   </thead>
                   <tbody>
                     {invoices.map((inv) => (
                       <tr key={inv.id} className="border-b border-white/5 last:border-0 hover:bg-white/[0.02]">
                         <td className="py-4 pr-4 font-mono text-white/70">{inv.id}</td>
                         <td className="py-4">{inv.date}</td>
                         <td className="py-4">{inv.plan}</td>
                         <td className="py-4 font-bold">{inv.amount} Ø±.Ø³</td>
                         <td className="py-4">
                           <span className="bg-green-500/10 text-green-500 px-2 py-1 rounded text-xs font-bold border border-green-500/20">Ù…Ø¯ÙÙˆØ¹Ø©</span>
                         </td>
                         <td className="py-4 text-left pl-4">
                           <button className="text-white/40 hover:text-[#C19D65] transition-colors"><Download size={16} /></button>
                         </td>
                       </tr>
                     ))}
                   </tbody>
                 </table>
               </div>
            </div>
          </div>
        )}

      </div>
    </div>
  );
}
</file>

<file path="app/e/[id]/page.tsx">
'use client';

import { useState } from 'react';
import { Sparkles, Send, MapPin, Calendar, Users, Briefcase } from 'lucide-react';

export default function GuestRSVP({ params }: { params: { id: string } }) {
  // Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ù…Ø¨Ø±Ù…Ø¬: ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ØŒ ÙŠØªÙ… Ø¬Ù„Ø¨ isWedding Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ params.id
  const [isWedding, setIsWedding] = useState(true); 
  const [submitted, setSubmitted] = useState(false);

  const theme = {
    primary: isWedding ? '#C19D65' : '#3B82F6',
    button: isWedding ? 'bg-[#C19D65] hover:bg-[#A4824E]' : 'bg-blue-600 hover:bg-blue-700',
    text: isWedding ? 'text-[#C19D65]' : 'text-blue-500',
    shadow: isWedding ? 'shadow-[#C19D65]/20' : 'shadow-blue-500/20'
  };

  if (submitted) {
    return (
      <div className="min-h-screen bg-[#0A0A0C] flex items-center justify-center p-6 text-center text-white" dir="rtl">
        <div className="max-w-md w-full bg-white/[0.02] border border-white/10 p-12 rounded-[3.5rem] backdrop-blur-3xl animate-in zoom-in duration-500">
          <div className="w-20 h-20 rounded-full bg-green-500/20 flex items-center justify-center mx-auto mb-8 text-green-500">
            <Sparkles size={40} />
          </div>
          <h2 className="text-3xl font-black mb-4">ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø­Ø¶ÙˆØ±Ùƒ!</h2>
          <p className="text-white/40 mb-10 leading-relaxed">Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒØŒ Ø³ØªØµÙ„Ùƒ ØªØ°ÙƒØ±Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙÙˆØ± Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨.</p>
          <button className="w-full py-5 rounded-2xl border border-white/10 text-white font-bold hover:bg-white/5 transition-all">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-[#0A0A0C] relative overflow-hidden flex items-center justify-center p-6 text-right" dir="rtl">
      {/* Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© */}
      <div className={`absolute top-0 left-1/2 -translate-x-1/2 w-full h-[600px] blur-[150px] opacity-20 pointer-events-none transition-colors duration-1000 ${isWedding ? 'bg-[#C19D65]' : 'bg-blue-600'}`}></div>

      <div className="max-w-2xl w-full relative z-10">
        {/* Ø±Ø£Ø³ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */}
        <div className="text-center mb-12 animate-in fade-in slide-in-from-top duration-700">
          <div className={`w-20 h-20 rounded-[2rem] mx-auto mb-8 flex items-center justify-center text-white shadow-2xl transition-all duration-1000 ${theme.button} ${theme.shadow}`}>
             {isWedding ? <Sparkles size={35} /> : <Briefcase size={35} />}
          </div>
          <h1 className="text-4xl font-black text-white mb-4 tracking-tight">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ±</h1>
          <p className="text-white/40 text-lg">{isWedding ? 'Ù†ØªØ´Ø±Ù Ø¨Ø¯Ø¹ÙˆØªÙƒÙ… Ù„Ù…Ø´Ø§Ø±ÙƒØªÙ†Ø§ Ù„ÙŠÙ„Ø© Ø§Ù„Ø¹Ù…Ø±' : 'ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù„Ø¥ØµØ¯Ø§Ø± Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ø¤ØªÙ…Ø±'}</p>
        </div>

        {/* Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠ (RSVP Form) */}
        <form 
          onSubmit={(e) => { e.preventDefault(); setSubmitted(true); }} 
          className="space-y-8 bg-white/[0.02] border border-white/10 p-10 md:p-14 rounded-[4rem] backdrop-blur-2xl shadow-2xl"
        >
          {/* Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª */}
          <div className="space-y-6">
            <div className="group">
              <label className="block text-sm font-bold text-white/40 mb-3 mr-2 group-focus-within:text-white transition-colors">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
              <input 
                required 
                type="text" 
                placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ù‡ÙˆÙŠØ©" 
                className="w-full bg-white/5 border border-white/10 rounded-2xl p-5 text-white focus:outline-none focus:border-white/30 transition-all text-lg" 
              />
            </div>

            <div className="group">
              <label className="block text-sm font-bold text-white/40 mb-3 mr-2 group-focus-within:text-white transition-colors">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
              <input 
                required 
                type="tel" 
                placeholder="05xxxxxxxx" 
                className="w-full bg-white/5 border border-white/10 rounded-2xl p-5 text-white focus:outline-none transition-all text-lg text-left" 
                dir="ltr"
              />
            </div>

            {/* Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© */}
            {isWedding ? (
              <div className="animate-in fade-in duration-500">
                <label className="block text-sm font-bold text-white/40 mb-3 mr-2 italic">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ÙŠÙ†</label>
                <div className="grid grid-cols-4 gap-4 text-center">
                  {[0, 1, 2, 3].map((num) => (
                    <button 
                      key={num} 
                      type="button" 
                      className="py-4 rounded-xl border border-white/10 bg-white/5 hover:border-[#C19D65] hover:text-[#C19D65] transition-all text-white font-bold"
                    >
                      {num === 0 ? 'Ø¨Ù…ÙØ±Ø¯ÙŠ' : num}
                    </button>
                  ))}
                </div>
              </div>
            ) : (
              <div className="animate-in fade-in duration-500 space-y-6">
                <div>
                  <label className="block text-sm font-bold text-white/40 mb-3 mr-2">Ø¬Ù‡Ø© Ø§Ù„Ø¹Ù…Ù„ / Ø§Ù„Ø´Ø±ÙƒØ©</label>
                  <input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¸Ù…Ø©" className="w-full bg-white/5 border border-white/10 rounded-2xl p-5 text-white focus:outline-none focus:border-blue-500 transition-all text-lg" />
                </div>
                <div>
                  <label className="block text-sm font-bold text-white/40 mb-3 mr-2">Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</label>
                  <input type="text" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù…Ø¯ÙŠØ± ØªÙ†ÙÙŠØ°ÙŠ" className="w-full bg-white/5 border border-white/10 rounded-2xl p-5 text-white focus:outline-none focus:border-blue-500 transition-all text-lg" />
                </div>
              </div>
            )}
          </div>

          <button 
            type="submit" 
            className={`w-full py-6 rounded-2xl text-black font-black text-xl flex items-center justify-center gap-3 transition-all transform hover:scale-[1.02] active:scale-[0.98] ${theme.button} ${theme.shadow}`}
          >
            <Send size={24} />
            ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø¢Ù†
          </button>

          <p className="text-center text-[10px] text-white/20 tracking-widest uppercase">
            ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙˆØ§Ø³Ø·Ø© Ù…ÙÙ€Ø±Ø§Ø³ Â© 2025
          </p>
        </form>
      </div>
    </div>
  );
}
</file>

<file path="app/live/[id]/page.tsx">
'use client';

import { useState, useEffect, use } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import {
   Users, CheckCircle2, QrCode, Clock, Loader2,
   Activity, MapPin, Calendar
} from 'lucide-react';

interface PageProps {
   params: Promise<{ id: string }>;
}

export default function LivePage({ params }: PageProps) {
   const { id } = use(params);

   const [loading, setLoading] = useState(true);
   const [event, setEvent] = useState<any>(null);
   const [stats, setStats] = useState({
      total: 0,
      confirmed: 0,
      attended: 0,
      percentage: 0
   });
   const [recentArrivals, setRecentArrivals] = useState<any[]>([]);
   const [themeColor, setThemeColor] = useState('#C19D65');

   // Helper to calculate stats
   const updateStats = async () => {
      const { data: attendees } = await supabase.from('attendees').select('status, attended').eq('event_id', id);
      if (attendees) {
         const total = attendees.length;
         const confirmed = attendees.filter(a => a.status === 'confirmed').length;
         const attended = attendees.filter(a => a.attended).length;
         const percentage = total > 0 ? Math.round((attended / total) * 100) : 0;

         setStats({ total, confirmed, attended, percentage });
      }
   };

   // --- Fetch Initial Data ---
   useEffect(() => {
      const fetchData = async () => {
         // 1. Event Details
         const { data: eventData } = await supabase.from('events').select('*').eq('id', id).single();
         if (eventData) {
            setEvent(eventData);
            setThemeColor(eventData.type === 'business' ? '#3B82F6' : '#C19D65');
         }

         // 2. Initial Stats
         await updateStats();
         setLoading(false);
      };

      fetchData();

      // 3. Realtime Subscription (The Magic âœ¨)
      const channel = supabase
         .channel('live-stats')
         .on(
            'postgres_changes',
            { event: '*', schema: 'public', table: 'attendees', filter: `event_id=eq.${id}` },
            async (payload) => {
               // Ø¹Ù†Ø¯ Ø­Ø¯ÙˆØ« Ø£ÙŠ ØªØºÙŠÙŠØ± (Ø¯Ø®ÙˆÙ„ Ø¶ÙŠÙØŒ ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯)ØŒ Ù†Ø­Ø¯Ø« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
               await updateStats();

               // Ø¥Ø°Ø§ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø´Ø®Øµ (Update attended = true)ØŒ Ù†Ø¶ÙŠÙÙ‡ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø­Ø¯ÙŠØ«
               if (payload.eventType === 'UPDATE' && payload.new.attended && !payload.old.attended) {
                  setRecentArrivals(prev => [payload.new, ...prev].slice(0, 5)); // Keep last 5
               }
            }
         )
         .subscribe();

      return () => { supabase.removeChannel(channel); };
   }, [id]); // updateStats depends on id which is already in dependency array



   if (loading) return (
      <div className="min-h-screen bg-black flex flex-col items-center justify-center text-white">
         <Loader2 className="animate-spin mb-4" size={40} style={{ color: themeColor }} />
         <p className="text-sm opacity-50 tracking-widest uppercase">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...</p>
      </div>
   );

   if (!event) return <div className="min-h-screen bg-black text-white flex items-center justify-center">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©</div>;

   return (
      <div className="min-h-screen bg-black text-white font-sans overflow-hidden relative selection:bg-white/20" dir="rtl">

         {/* Background Ambience */}
         <div className="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 pointer-events-none"></div>
         <div className="absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-[var(--theme-color)] to-transparent opacity-10 pointer-events-none" style={{ '--theme-color': themeColor } as any}></div>

         {/* --- Header --- */}
         <div className="relative z-10 p-8 flex justify-between items-start border-b border-white/10 bg-black/50 backdrop-blur-md">
            <div>
               <div className="flex items-center gap-3 mb-2">
                  <div className="w-3 h-3 rounded-full bg-red-500 animate-pulse shadow-[0_0_10px_red]"></div>
                  <span className="text-xs font-bold tracking-widest uppercase opacity-70">Live Dashboard</span>
               </div>
               <h1 className="text-4xl font-black tracking-tight">{event.name}</h1>
            </div>

            <div className="text-left opacity-60 text-sm hidden md:block">
               <div className="flex items-center gap-2 justify-end mb-1">
                  <Calendar size={14} />
                  <span>{new Date(event.date).toLocaleDateString('ar-SA', { weekday: 'long', day: 'numeric', month: 'long' })}</span>
               </div>
               <div className="flex items-center gap-2 justify-end">
                  <MapPin size={14} />
                  <span>{event.location_name || 'Ù…ÙˆÙ‚Ø¹ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©'}</span>
               </div>
            </div>
         </div>

         {/* --- Main Stats Grid --- */}
         <div className="relative z-10 p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">

            {/* Card 1: Attended (Hero) */}
            <div className="lg:col-span-2 bg-[#121212] border border-white/10 rounded-[2.5rem] p-8 relative overflow-hidden group">
               <div className="absolute right-0 top-0 w-64 h-64 rounded-full blur-[100px] opacity-20 transition-opacity group-hover:opacity-30" style={{ backgroundColor: themeColor }}></div>

               <div className="relative z-10">
                  <div className="flex items-center gap-3 mb-4 opacity-70">
                     <QrCode size={20} />
                     <span className="text-sm font-bold uppercase tracking-wider">Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙØ¹Ù„ÙŠ</span>
                  </div>
                  <div className="flex items-end gap-4">
                     <span className="text-8xl font-black tracking-tighter leading-none" style={{ color: themeColor }}>
                        {stats.attended}
                     </span>
                     <span className="text-xl font-bold mb-4 opacity-50">/ {stats.total} Ø¶ÙŠÙ</span>
                  </div>

                  {/* Progress Bar */}
                  <div className="w-full h-3 bg-white/10 rounded-full mt-8 overflow-hidden">
                     <div
                        className="h-full rounded-full transition-all duration-1000 ease-out shadow-[0_0_20px_rgba(255,255,255,0.3)]"
                        style={{ width: `${stats.percentage}%`, backgroundColor: themeColor }}
                     ></div>
                  </div>
                  <p className="text-right text-xs mt-2 opacity-40">Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ± {stats.percentage}%</p>
               </div>
            </div>

            {/* Card 2: Total Registered */}
            <div className="bg-[#121212] border border-white/10 rounded-[2.5rem] p-8 flex flex-col justify-between hover:border-white/20 transition-colors">
               <div className="flex items-center justify-between opacity-70 mb-4">
                  <Users size={24} />
                  <span className="text-xs font-bold uppercase tracking-wider">Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</span>
               </div>
               <span className="text-5xl font-black text-white">{stats.total}</span>
               <p className="text-xs text-white/40 mt-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
            </div>

            {/* Card 3: Pending */}
            <div className="bg-[#121212] border border-white/10 rounded-[2.5rem] p-8 flex flex-col justify-between hover:border-white/20 transition-colors">
               <div className="flex items-center justify-between opacity-70 mb-4">
                  <Clock size={24} />
                  <span className="text-xs font-bold uppercase tracking-wider">Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ÙˆØµÙˆÙ„Ù‡Ù…</span>
               </div>
               <span className="text-5xl font-black text-white">{Math.max(0, stats.total - stats.attended)}</span>
               <p className="text-xs text-white/40 mt-2">Ù„Ù… ÙŠØªÙ… ØªØ­Ø¶ÙŠØ±Ù‡Ù… Ø¨Ø¹Ø¯</p>
            </div>
         </div>

         {/* --- Live Feed (Recent Arrivals) --- */}
         <div className="relative z-10 px-8 pb-8">
            <h3 className="text-sm font-bold opacity-50 uppercase tracking-widest mb-4 flex items-center gap-2">
               <Activity size={16} /> Ø¢Ø®Ø± Ø§Ù„ÙˆØ§ØµÙ„ÙŠÙ†
            </h3>

            <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
               {recentArrivals.length > 0 ? recentArrivals.map((guest, idx) => (
                  <div key={guest.id} className="bg-white/5 border border-white/5 rounded-2xl p-4 flex items-center gap-3 animate-in slide-in-from-right fade-in duration-500 fill-mode-backwards" style={{ animationDelay: `${idx * 100}ms` }}>
                     <div className="w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center text-green-500 border border-green-500/20">
                        <CheckCircle2 size={16} />
                     </div>
                     <div className="overflow-hidden">
                        <p className="font-bold text-sm truncate">{guest.name}</p>
                        <p className="text-[10px] opacity-40">ÙˆØµÙ„ Ù„Ù„ØªÙˆ</p>
                     </div>
                  </div>
               )) : (
                  <div className="col-span-full py-8 text-center border border-dashed border-white/10 rounded-2xl text-white/20 text-sm">
                     Ø¨Ø§Ù†ØªØ¸Ø§Ø± ÙˆØµÙˆÙ„ Ø£ÙˆÙ„ Ø¶ÙŠÙ...
                  </div>
               )}
            </div>
         </div>

      </div>
   );
}
</file>

<file path="app/login/page.tsx">
'use client';

import { useState } from 'react';
import { supabase } from '@/app/utils/supabase/client'; 
import { useRouter } from 'next/navigation';
import { Sparkles, Loader2, CheckCircle2, AlertCircle, Briefcase, PartyPopper, Chrome, ArrowLeft, Eye, EyeOff, ChevronRight } from 'lucide-react';
import Link from 'next/link';

// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆÙ„
const GULF_COUNTRIES = [
  { name: 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', code: '+966', flag: 'ğŸ‡¸ğŸ‡¦', iso: 'SA', digits: 9, placeholder: '5xxxxxxxx' },
  { name: 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª', code: '+971', flag: 'ğŸ‡¦ğŸ‡ª', iso: 'AE', digits: 9, placeholder: '5xxxxxxxx' },
  { name: 'Ø§Ù„ÙƒÙˆÙŠØª', code: '+965', flag: 'ğŸ‡°ğŸ‡¼', iso: 'KW', digits: 8, placeholder: 'xxxxxxxx' },
  { name: 'Ù‚Ø·Ø±', code: '+974', flag: 'ğŸ‡¶ğŸ‡¦', iso: 'QA', digits: 8, placeholder: 'xxxxxxxx' },
  { name: 'Ø¹Ù…Ø§Ù†', code: '+968', flag: 'ğŸ‡´ğŸ‡²', iso: 'OM', digits: 8, placeholder: 'xxxxxxxx' },
  { name: 'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†', code: '+973', flag: 'ğŸ‡§ğŸ‡­', iso: 'BH', digits: 8, placeholder: 'xxxxxxxx' },
];

// --- ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ÙƒÙˆÙ† Ø®Ø§Ø±Ø¬ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ---
const InputField = ({ label, error, isTouched, themeColor, name, ...props }: any) => {
  return (
    <div className="relative group">
      <label className="text-[10px] text-white/30 absolute -top-2.5 right-4 bg-[#0F0F12] px-2 z-10 font-bold uppercase italic">{label}</label>
      <div className="relative">
        <input
          name={name}
          className={`w-full bg-white/[0.02] border rounded-2xl p-5 outline-none font-sans transition-all 
            ${isTouched && error ? 'border-red-500/50 focus:border-red-500' : 'border-white/10'} 
            ${(!isTouched || !error) && 'focus:border-[var(--theme-color)]'}`}
          style={{ '--theme-color': themeColor } as React.CSSProperties}
          {...props}
        />
        {isTouched && !error && props.value && name !== 'password' && name !== 'confirmPassword' && (
          <CheckCircle2 size={20} className="absolute left-4 top-1/2 -translate-y-1/2 text-green-500 animate-in zoom-in" />
        )}
      </div>
      {isTouched && error && (
        <p className="text-red-400 text-[10px] mt-2 mr-2 font-bold flex items-center gap-1 animate-in slide-in-from-top-1">
          <AlertCircle size={10} /> {error}
        </p>
      )}
    </div>
  );
};

export default function AuthPage() {
  const [isSignUp, setIsSignUp] = useState(true);
  const [showPassword, setShowPassword] = useState(false);
  const [loading, setLoading] = useState(false);
  const [interest, setInterest] = useState<'social' | 'business' | null>(null);
  const [error, setError] = useState<string | null>(null);
  const [selectedCountry, setSelectedCountry] = useState(GULF_COUNTRIES[0]);
  const router = useRouter();

  const [formData, setFormData] = useState({ fullName: '', email: '', phone: '', password: '', confirmPassword: '' });
  const [touched, setTouched] = useState<Record<string, boolean>>({});

  const themeColor = interest === 'business' ? '#3B82F6' : '#C19D65';
  const themeBg = interest === 'business' ? 'rgba(59, 130, 246, 0.1)' : 'rgba(193, 157, 101, 0.1)';

  // --- Ø§Ù„ØªØ­Ù‚Ù‚ ---
  const validate = (field: string, value: string) => {
    switch (field) {
      case 'fullName': return !value.trim() ? "Ù„Ø·ÙØ§Ù‹ØŒ Ø²ÙˆØ¯Ù†Ø§ Ø¨Ø§Ø³Ù…Ùƒ Ù„Ù†ØªÙ…ÙƒÙ† Ù…Ù† ØªØ®ØµÙŠØµ ØªØ¬Ø±Ø¨ØªÙƒ." : "";
      case 'email': return !/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(value) ? "Ø¹Ø°Ø±Ø§Ù‹ØŒ ØµÙŠØºØ© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­Ø©." : "";
      case 'phone': return (!/^\d+$/.test(value) || value.length !== selectedCountry.digits) ? `Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ${selectedCountry.digits} Ø£Ø±Ù‚Ø§Ù….` : "";
      case 'password': return !/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/.test(value) ? "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ© (8 Ø®Ø§Ù†Ø§ØªØŒ Ø­Ø±Ù ÙƒØ¨ÙŠØ± ÙˆØµØºÙŠØ± ÙˆØ±Ù‚Ù…)." : "";
      case 'confirmPassword': return value !== formData.password ? "ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©." : "";
      default: return "";
    }
  };

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const { name, value } = e.target;
    if (name === 'phone' && !/^\d*$/.test(value)) return;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  const handleBlur = (e: React.FocusEvent<HTMLInputElement>) => {
    setTouched(prev => ({ ...prev, [e.target.name]: true }));
  };

  // ğŸ› ï¸ ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù„ØªÙ†Ø§Ø³Ø¨ Ø­Ø§Ù„ØªÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„Ø¯Ø®ÙˆÙ„
  const isFormValid = () => {
    const basicValid = !validate('email', formData.email) && !validate('password', formData.password);

    if (!isSignUp) {
      // ÙÙŠ Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ù†ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙˆØ§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ ÙÙ‚Ø·
      return basicValid;
    }

    // ÙÙŠ Ø­Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ Ù†ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„
    return basicValid && 
           !validate('fullName', formData.fullName) && 
           !validate('phone', formData.phone) && 
           !validate('confirmPassword', formData.confirmPassword);
  };

  // --- Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ---
  const handleGoogleLogin = async () => {
    if (isSignUp && !interest) { setError("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù‡ØªÙ…Ø§Ù…Ùƒ Ø£ÙˆÙ„Ø§Ù‹"); return; }
    await supabase.auth.signInWithOAuth({
      provider: 'google',
      options: { redirectTo: `${window.location.origin}/auth/callback`, data: { interest, full_name: 'Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙØ±Ø§Ø³' } },
    });
  };

  const handleAuth = async (e: React.FormEvent) => {
    e.preventDefault();
    if (isSignUp && !interest) { setError("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…"); return; }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
    if (!isFormValid()) { 
      // ØªÙØ¹ÙŠÙ„ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ Ù„Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙ‚Ø·
      if (isSignUp) {
        setTouched({ fullName: true, email: true, phone: true, password: true, confirmPassword: true });
      } else {
        setTouched({ email: true, password: true });
      }
      return; 
    }
    
    setLoading(true); setError(null);
    try {
      if (isSignUp) {
        const { error: signUpError } = await supabase.auth.signUp({ 
          email: formData.email, 
          password: formData.password,
          options: { 
            data: { 
              full_name: formData.fullName, 
              phone_number: `${selectedCountry.code}${formData.phone}`, 
              interest 
            } 
          }
        });
        
        if (signUpError) {
          if (signUpError.message.includes('User already registered')) {
            throw new Error('Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.');
          }
          if (signUpError.message.includes('Password should be')) {
            throw new Error('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ© Ø¬Ø¯Ø§Ù‹.');
          }
          throw signUpError;
        }
        
        router.push(`/auth/verify?email=${encodeURIComponent(formData.email)}&interest=${interest}`);
        
      } else {
        const { error: signInError } = await supabase.auth.signInWithPassword({ 
          email: formData.email, 
          password: formData.password 
        });

        if (signInError) {
          if (signInError.message.includes('Invalid login credentials')) {
            throw new Error('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.');
          }
          throw signInError;
        }

        router.push('/dashboard');
      }
    } catch (err: any) { setError(err.message); } finally { setLoading(false); }
  };

  return (
    <div className="min-h-screen bg-[#0A0A0C] text-white flex items-center justify-center p-6 text-right font-sans relative overflow-hidden transition-all duration-700" dir="rtl">
      
      <Link href="/" className="absolute top-8 right-8 z-50 group flex items-center gap-3 transition-all">
        <div className="w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center group-hover:bg-white/10 group-hover:border-[var(--theme-color)] transition-all duration-300 backdrop-blur-md"
             style={{ '--theme-color': themeColor } as React.CSSProperties}>
          <ChevronRight size={18} className="text-white/40 group-hover:text-white transition-colors" />
        </div>
        <span className="text-xs font-bold text-white/30 group-hover:text-white transition-colors tracking-wide hidden md:block">
          Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </span>
      </Link>

      <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] rounded-full blur-[100px] opacity-20 transition-all duration-1000" style={{ background: `radial-gradient(circle, ${themeColor} 0%, transparent 70%)` }} />

      <div className="w-full max-w-xl bg-[#0F0F12]/90 border border-white/10 rounded-[3.5rem] p-10 backdrop-blur-3xl shadow-2xl relative z-10">
        
        <div className="text-center mb-8">
          <div className="w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 border transition-all duration-500" style={{ backgroundColor: themeBg, borderColor: `${themeColor}40` }}>
            <Sparkles size={32} style={{ color: themeColor }} className="animate-pulse" />
          </div>
          <h1 className="text-3xl font-black italic tracking-tighter mb-2">Ù…ÙÙ€Ø±Ø§Ø³</h1>
          <p style={{ color: themeColor }} className="text-[11px] font-bold tracking-widest transition-colors duration-500 italic">Ø§Ø¨Ø¯Ø£ Ø¨ØªÙ†Ø¸ÙŠÙ… ÙØ¹Ø§Ù„ÙŠØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙŠ Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†</p>
        </div>

        {isSignUp && (
          <div className="mb-6 space-y-3">
            <label className="text-[10px] text-white/30 mr-2 font-black uppercase tracking-widest">Ù…Ø§ Ù‡Ùˆ Ø§Ù‡ØªÙ…Ø§Ù…Ùƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØŸ</label>
            <div className="grid grid-cols-2 gap-4">
              <button type="button" onClick={() => setInterest('social')} className={`p-4 rounded-2xl border-2 transition-all duration-500 flex flex-col items-center gap-2 ${interest === 'social' ? 'border-[#C19D65] bg-[#C19D65]/10' : 'border-white/5 bg-white/[0.02] hover:border-white/10'}`}>
                <PartyPopper className={interest === 'social' ? 'text-[#C19D65]' : 'text-white/20'} size={24} />
                <span className="text-[10px] font-black uppercase">Ø£ÙØ±Ø§Ø­ ÙˆÙ…Ù†Ø§Ø³Ø¨Ø§Øª âœ¨</span>
              </button>
              <button type="button" onClick={() => setInterest('business')} className={`p-4 rounded-2xl border-2 transition-all duration-500 flex flex-col items-center gap-2 ${interest === 'business' ? 'border-[#3B82F6] bg-[#3B82F6]/10' : 'border-white/5 bg-white/[0.02] hover:border-white/10'}`}>
                <Briefcase className={interest === 'business' ? 'text-[#3B82F6]' : 'text-white/20'} size={24} />
                <span className="text-[10px] font-black uppercase">Ø£Ø¹Ù…Ø§Ù„ ÙˆÙ…Ø¤ØªÙ…Ø±Ø§Øª ğŸ’¼</span>
              </button>
            </div>
          </div>
        )}

        <form onSubmit={handleAuth} className="space-y-4" noValidate>
           {isSignUp && (
             <InputField 
               name="fullName" 
               type="text" 
               label="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" 
               placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ" 
               autoComplete="name"
               value={formData.fullName}
               onChange={handleChange}
               onBlur={handleBlur}
               error={isSignUp ? validate('fullName', formData.fullName) : ""}
               isTouched={touched.fullName}
               themeColor={themeColor}
             />
           )}
           
           <InputField 
             name="email" 
             type="email" 
             label="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" 
             placeholder="name@company.com" 
             autoComplete="email"
             value={formData.email}
             onChange={handleChange}
             onBlur={handleBlur}
             error={isSignUp ? validate('email', formData.email) : ""}
             isTouched={touched.email}
             themeColor={themeColor}
           />

           {isSignUp && (
             <div className="space-y-1">
               <div className="relative group">
                 <label className="text-[10px] text-white/30 absolute -top-2.5 right-4 bg-[#0F0F12] px-2 z-10 font-bold uppercase italic">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
                 <div className="flex flex-row-reverse gap-3">
                    <div className="relative w-32 shrink-0">
                      <select onChange={(e) => setSelectedCountry(GULF_COUNTRIES[e.target.selectedIndex])} className="w-full bg-white/[0.02] border border-white/10 rounded-2xl p-5 text-sm appearance-none text-center font-bold outline-none cursor-pointer h-[66px]">
                        {GULF_COUNTRIES.map(c => <option key={c.iso} className="bg-[#0F0F12]">{c.iso} {c.code}</option>)}
                      </select>
                    </div>
                    <div className="flex-1 relative">
                      <input 
                        name="phone" type="tel" value={formData.phone} onChange={handleChange} onBlur={handleBlur} 
                        placeholder={selectedCountry.placeholder} maxLength={selectedCountry.digits} autoComplete="tel"
                        className={`w-full bg-white/[0.02] border rounded-2xl p-5 outline-none font-sans h-[66px] text-left dir-ltr ${touched.phone && validate('phone', formData.phone) ? 'border-red-500/50 focus:border-red-500' : 'border-white/10'} ${(!touched.phone || !validate('phone', formData.phone)) && 'focus:border-[var(--theme-color)]'}`}
                        style={{ '--theme-color': themeColor } as React.CSSProperties} />
                    </div>
                 </div>
                 {touched.phone && validate('phone', formData.phone) && <p className="text-red-400 text-[10px] mt-2 mr-2 font-bold flex items-center gap-1 animate-in slide-in-from-top-1"><AlertCircle size={10} /> {validate('phone', formData.phone)}</p>}
               </div>
             </div>
           )}

           <div className="space-y-4">
             <div className="relative">
                <InputField 
                  name="password" 
                  type={showPassword ? "text" : "password"} 
                  label="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" 
                  autoComplete="new-password"
                  value={formData.password}
                  onChange={handleChange}
                  onBlur={handleBlur}
                  error={isSignUp ? validate('password', formData.password) : ""}
                  isTouched={touched.password}
                  themeColor={themeColor}
                />
                <button type="button" onClick={() => setShowPassword(!showPassword)} className="absolute left-4 top-5 text-white/20 hover:text-white transition-colors z-20">
                  {showPassword ? <EyeOff size={18} /> : <Eye size={18} />}
                </button>
             </div>
             
             {isSignUp && (
               <InputField 
                 name="confirmPassword" 
                 type={showPassword ? "text" : "password"} 
                 label="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" 
                 autoComplete="new-password"
                 value={formData.confirmPassword}
                 onChange={handleChange}
                 onBlur={handleBlur}
                 error={isSignUp ? validate('confirmPassword', formData.confirmPassword) : ""}
                 isTouched={touched.confirmPassword}
                 themeColor={themeColor}
               />
             )}
           </div>

          {error && <div className="p-4 bg-red-500/10 border border-red-500/20 rounded-xl text-red-500 text-[11px] text-center font-bold flex items-center justify-center gap-2 animate-in fade-in"><AlertCircle size={14} /> {error}</div>}

          {/* ğŸ› ï¸ ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© type="submit" Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ§Ø¹Ù„ Ø§Ù„Ø²Ø± */}
          <button 
            type="submit"
            disabled={loading} 
            style={{ backgroundColor: themeColor, boxShadow: `0 15px 30px ${themeColor}20` }} 
            className="w-full text-black py-5 rounded-2xl font-black text-lg hover:scale-[1.01] active:scale-[0.98] transition-all flex items-center justify-center gap-3 group disabled:opacity-70 mt-6 shadow-xl"
          >
            {loading ? <Loader2 className="animate-spin" /> : (isSignUp ? 'Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨ÙŠ Ø§Ù„Ø¢Ù†' : 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„')}
          </button>
        </form>

        <div className="relative my-8 flex items-center justify-center">
          <div className="absolute inset-0 flex items-center"><div className="w-full border-t border-white/5"></div></div>
          <span className="relative bg-[#0F0F12] px-4 text-[10px] font-black text-white/20 uppercase tracking-[0.3em]">Ø£Ùˆ</span>
        </div>

        <button type="button" onClick={handleGoogleLogin} className="w-full bg-white/5 border border-white/10 text-white/70 py-4 rounded-2xl flex items-center justify-center gap-3 hover:bg-white/10 hover:text-white transition-all font-bold text-sm mb-6 shadow-md">
          <Chrome size={18} /> Ø³Ø¬Ù„ Ø¹Ø¨Ø± Ø¬ÙˆØ¬Ù„
        </button>

        <button onClick={() => setIsSignUp(!isSignUp)} className="group flex flex-col items-center gap-1 mx-auto w-full">
          <span className="text-white/30 text-[11px] font-bold uppercase italic">{isSignUp ? 'Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ù…Ø³Ø¨Ù‚ØŸ' : 'Ø§Ù†Ø¶Ù… Ù„Ø¹Ø§Ù„Ù… Ù…ÙØ±Ø§Ø³ Ø§Ù„Ø¬Ø¯ÙŠØ¯'}</span>
          <span style={{ color: themeColor }} className="text-sm font-black flex items-center gap-2 group-hover:underline">
            {isSignUp ? 'ØªÙØ¶Ù„ Ø¨ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„Ùƒ' : 'Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ ÙƒÙ…Ù†Ø¸Ù… Ø§Ù„Ø¢Ù†'}
            <ArrowLeft size={14} className="group-hover:-translate-x-1 transition-transform" />
          </span>
        </button>

      </div>
    </div>
  );
}
</file>

<file path="app/pricing/page.tsx">
'use client'
import { useEffect, useState } from 'react'
import { createClient } from '@/app/utils/supabase/client'
import { Check } from 'lucide-react'

export default function Pricing() {
  const [packages, setPackages] = useState<any[]>([])
  const supabase = createClient()

  useEffect(() => {
    const getPackages = async () => {
        const { data } = await supabase.from('packages').select('*').order('price')
        if(data) setPackages(data)
    }
    getPackages()
  }, [])

  return (
    <div className="min-h-screen bg-slate-50 p-10 flex flex-col items-center justify-center" dir="rtl">
        <h1 className="text-3xl font-bold mb-10">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ùƒ</h1>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl w-full">
            {packages.map(pkg => (
                <div key={pkg.id} className={`bg-white p-8 rounded-2xl border ${pkg.price > 0 ? 'border-indigo-200 shadow-xl' : 'border-slate-200 shadow-sm'}`}>
                    <h3 className="text-xl font-bold text-slate-800">{pkg.name}</h3>
                    <p className="text-4xl font-bold my-4 text-indigo-600">{pkg.price} <span className="text-sm text-slate-400 font-normal">Ø±ÙŠØ§Ù„</span></p>
                    <ul className="space-y-3 mb-8">
                        <li className="flex items-center gap-2"><Check size={18} className="text-green-500"/> {pkg.max_events} ÙØ¹Ø§Ù„ÙŠØ§Øª</li>
                        <li className="flex items-center gap-2"><Check size={18} className="text-green-500"/> {pkg.max_attendees_per_event} Ø²Ø§Ø¦Ø± Ù„ÙƒÙ„ ÙØ¹Ø§Ù„ÙŠØ©</li>
                        <li className="flex items-center gap-2"><Check size={18} className="text-green-500"/> Ø¯Ø¹Ù… ÙÙ†ÙŠ</li>
                    </ul>
                    <button className="w-full py-3 rounded-xl font-bold border-2 border-indigo-600 text-indigo-600 hover:bg-indigo-600 hover:text-white transition">
                        {pkg.price === 0 ? 'Ø¨Ø§Ù‚ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©' : 'ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø¨Ø§Ù‚Ø©'}
                    </button>
                </div>
            ))}
        </div>
    </div>
  )
}
</file>

<file path="app/register/[id]/page.tsx">
'use client';

import { useState, useEffect, use } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import { useRouter } from 'next/navigation'; // Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
import {
  Loader2, Calendar, MapPin,
  Heart, Briefcase, User, Mail,
  CheckCircle2
} from 'lucide-react';
import { Event } from '@/types';

// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆÙ„
const GULF_COUNTRIES = [
  { name: 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', code: '+966', flag: 'ğŸ‡¸ğŸ‡¦', digits: 9, placeholder: '5xxxxxxxx' },
  { name: 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª', code: '+971', flag: 'ğŸ‡¦ğŸ‡ª', digits: 9, placeholder: '5xxxxxxxx' },
  { name: 'Ø§Ù„ÙƒÙˆÙŠØª', code: '+965', flag: 'ğŸ‡°ğŸ‡¼', digits: 8, placeholder: 'xxxxxxxx' },
  { name: 'Ù‚Ø·Ø±', code: '+974', flag: 'ğŸ‡¶ğŸ‡¦', digits: 8, placeholder: 'xxxxxxxx' },
  { name: 'Ø¹Ù…Ø§Ù†', code: '+968', flag: 'ğŸ‡´ğŸ‡²', digits: 8, placeholder: 'xxxxxxxx' },
  { name: 'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†', code: '+973', flag: 'ğŸ‡§ğŸ‡­', digits: 8, placeholder: 'xxxxxxxx' },
];

interface PageProps { params: Promise<{ id: string }>; }

export default function RegistrationPage({ params }: PageProps) {
  const { id } = use(params);
  const router = useRouter(); // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø±Ø§ÙˆØªØ±

  // States
  const [loading, setLoading] = useState(true);
  const [submitting, setSubmitting] = useState(false);
  const [event, setEvent] = useState<Event | null>(null);

  // Form Data
  const [formData, setFormData] = useState({ name: '', email: '', phone: '' });
  const [selectedCountry, setSelectedCountry] = useState(GULF_COUNTRIES[0]);
  const [touched, setTouched] = useState({ name: false, email: false, phone: false });

  // Theme Logic
  const isWedding = event?.type !== 'business';
  const themeColor = isWedding ? '#C19D65' : '#3B82F6';
  const themeBg = isWedding ? 'bg-[#C19D65]' : 'bg-blue-600';

  useEffect(() => {
    const fetchEvent = async () => {
      const { data } = await supabase.from('events').select('*').eq('id', id).single();
      if (data) setEvent(data);
      setLoading(false);
    };
    fetchEvent();
  }, [id]);

  // Validation
  const validators = {
    name: (val: string) => val.length >= 3,
    email: (val: string) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(val),
    phone: (val: string) => /^\d+$/.test(val) && val.length === selectedCountry.digits
  };

  const isFormValid = validators.name(formData.name) &&
    validators.email(formData.email) &&
    validators.phone(formData.phone);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!isFormValid) return;

    setSubmitting(true);
    const fullPhone = `${selectedCountry.code}${formData.phone}`;

    try {
      // 1. Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      const { data: guest, error } = await supabase
        .from('attendees')
        .insert([{
          event_id: id,
          name: formData.name,
          email: formData.email,
          phone: fullPhone,
          status: 'confirmed'
        }])
        .select()
        .single();

      if (error) throw error;

      // 2. ğŸš€ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„ØµÙØ­Ø© Ø§Ù„ØªØ°ÙƒØ±Ø©
      router.push(`/ticket/${guest.id}`);

    } catch (err) {
      alert('Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
      setSubmitting(false); // Ù†ÙˆÙ‚Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙÙ‚Ø· ÙÙŠ Ø­Ø§Ù„ Ø§Ù„Ø®Ø·Ø£
    }
    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ù… Ù†Ø¶Ø¹ setSubmitting(false) ÙÙŠ Ø§Ù„Ù†Ø¬Ø§Ø­ Ù„ÙƒÙŠ ÙŠØ¸Ù„ Ø§Ù„Ø²Ø± ÙÙŠ Ø­Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
  };

  if (loading) return <div className="min-h-screen bg-[#0A0A0C] flex items-center justify-center"><Loader2 className="animate-spin text-white" /></div>;
  if (!event) return <div className="min-h-screen bg-[#0A0A0C] flex items-center justify-center text-white">Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©</div>;

  // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø§Ø´Ø© Ù†Ø¬Ø§Ø­ (if success) Ù‡Ù†Ø§ØŒ Ù„Ø£Ù†Ù†Ø§ Ø§Ù†ØªÙ‚Ù„Ù†Ø§ ÙÙˆØ±Ø§Ù‹

  // --- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ---
  return (
    <div className="min-h-screen bg-[#0A0A0C] font-sans relative flex flex-col items-center justify-center p-6" dir="rtl">
      <div className="absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-[var(--theme)]/20 to-transparent pointer-events-none" style={{ '--theme': themeColor } as any}></div>

      <div className="w-full max-w-md relative z-10">
        {/* Header */}
        <div className="text-center mb-10">
          <div className={`w-20 h-20 rounded-3xl mx-auto mb-6 flex items-center justify-center text-white shadow-2xl ${themeBg}`}>
            {isWedding ? <Heart size={36} fill="white" /> : <Briefcase size={36} />}
          </div>
          <h1 className="text-3xl font-black text-white mb-2">{event.name}</h1>
          <div className="flex justify-center gap-4 text-xs text-white/60 font-bold">
            <span className="flex items-center gap-1"><Calendar size={14} /> {new Date(event.date).toLocaleDateString('ar-SA')}</span>
            <span className="flex items-center gap-1"><MapPin size={14} /> {event.location_name || 'Ø§Ù„Ù…ÙˆÙ‚Ø¹'}</span>
          </div>
        </div>

        {/* Form */}
        <form onSubmit={handleSubmit} className="bg-[#18181B]/80 backdrop-blur-xl border border-white/10 p-8 rounded-[3rem] space-y-6 shadow-2xl">

          {/* Ø§Ù„Ø§Ø³Ù… */}
          <div className="space-y-2">
            <label className="text-xs text-white/40 mr-4 font-bold">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ</label>
            <div className="relative group">
              <User className="absolute right-5 top-1/2 -translate-y-1/2 text-white/20 group-focus-within:text-white transition-colors" size={18} />
              <input
                type="text"
                value={formData.name}
                onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                onBlur={() => setTouched({ ...touched, name: true })}
                className={`w-full bg-black/40 border rounded-2xl py-4 pr-12 pl-12 text-white outline-none transition-all ${touched.name && !validators.name(formData.name) ? 'border-red-500/50' : 'border-white/10 focus:border-[var(--theme)]'}`}
                placeholder="Ø§Ù„Ø§Ø³Ù… ÙƒÙ…Ø§ Ù‡Ùˆ ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©"
                style={{ '--theme': themeColor } as any}
              />
              {validators.name(formData.name) && <CheckCircle2 className="absolute left-5 top-1/2 -translate-y-1/2 text-green-500 animate-in zoom-in" size={18} />}
            </div>
          </div>

          {/* Ø§Ù„Ø¬ÙˆØ§Ù„ */}
          <div className="space-y-2">
            <label className="text-xs text-white/40 mr-4 font-bold">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
            <div className={`flex flex-row-reverse bg-black/40 border rounded-2xl overflow-hidden transition-all ${touched.phone && !validators.phone(formData.phone) ? 'border-red-500/50' : 'border-white/10 focus-within:border-[var(--theme)]'}`} style={{ '--theme': themeColor } as any}>

              {/* Ù…ÙØªØ§Ø­ Ø§Ù„Ø¯ÙˆÙ„Ø© (ÙŠØ³Ø§Ø±) */}
              <div className="relative w-28 border-r border-white/10 shrink-0">
                <select
                  className="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"
                  onChange={(e) => setSelectedCountry(GULF_COUNTRIES[e.target.selectedIndex])}
                >
                  {GULF_COUNTRIES.map((c, i) => <option key={i} value={i} className="text-black">{c.name}</option>)}
                </select>
                <div className="w-full h-full flex items-center justify-center text-xs gap-2 pointer-events-none">
                  <span>{selectedCountry.flag}</span>
                  <span className="dir-ltr font-mono font-bold">{selectedCountry.code}</span>
                </div>
              </div>

              {/* Ø®Ø§Ù†Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© (ÙŠÙ…ÙŠÙ†) */}
              <input
                type="tel"
                value={formData.phone}
                onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                onBlur={() => setTouched({ ...touched, phone: true })}
                placeholder={selectedCountry.placeholder}
                className="flex-1 bg-transparent py-4 px-4 text-white text-right outline-none font-mono tracking-widest placeholder:font-sans placeholder:tracking-normal placeholder:text-right dir-ltr"
              />

              <div className="flex items-center pl-4">
                {validators.phone(formData.phone) && <CheckCircle2 className="text-green-500 animate-in zoom-in" size={18} />}
              </div>
            </div>
          </div>

          {/* Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ */}
          <div className="space-y-2">
            <label className="text-xs text-white/40 mr-4 font-bold">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ <span className="text-[10px] opacity-50">(Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ°ÙƒØ±Ø©)</span></label>
            <div className="relative group">
              <Mail className="absolute right-5 top-1/2 -translate-y-1/2 text-white/20 group-focus-within:text-white transition-colors" size={18} />
              <input
                type="email"
                value={formData.email}
                onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                onBlur={() => setTouched({ ...touched, email: true })}
                className={`w-full bg-black/40 border rounded-2xl py-4 pr-12 pl-12 text-white outline-none transition-all text-left ${touched.email && !validators.email(formData.email) ? 'border-red-500/50' : 'border-white/10 focus:border-[var(--theme)]'}`}
                placeholder="name@example.com"
                style={{ '--theme': themeColor } as any}
              />
              {validators.email(formData.email) && <CheckCircle2 className="absolute left-5 top-1/2 -translate-y-1/2 text-green-500 animate-in zoom-in" size={18} />}
            </div>
          </div>

          <button type="submit" disabled={!isFormValid || submitting} className="w-full py-5 rounded-2xl font-black text-lg text-white shadow-xl hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" style={{ backgroundColor: isFormValid ? themeColor : '#333' }}>
            {submitting ? <Loader2 className="animate-spin" /> : 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ°ÙƒØ±Ø©'}
          </button>
        </form>
        <p className="text-center text-[10px] text-white/20 mt-8 tracking-widest uppercase">Powered by Meras Platform Â© 2025</p>
      </div>
    </div>
  );
}
</file>

<file path="app/s/[id]/page.tsx">
'use client'

import { useState, use, useEffect } from 'react'
import { Scanner } from '@yudiel/react-qr-scanner'
import { createClient } from '@/app/utils/supabase/client'
import { CheckCircle, XCircle, Loader2, Camera, AlertTriangle, Repeat } from 'lucide-react'

interface PageProps {
  params: Promise<{ id: string }>
}

export default function PublicScanner({ params }: PageProps) {
  const resolvedParams = use(params)
  const eventId = resolvedParams.id
  
  const [status, setStatus] = useState<'idle' | 'success' | 'error' | 'warning' | 'loading'>('idle')
  const [message, setMessage] = useState('')
  const [guestName, setGuestName] = useState('')
  const [pauseScan, setPauseScan] = useState(false)
  const [allowMultiple, setAllowMultiple] = useState(false)
  const [eventTitle, setEventTitle] = useState('')
  
  const supabase = createClient()

  useEffect(() => {
    const fetchEventSettings = async () => {
        const { data } = await supabase.from('events').select('title, allow_multiple_entry').eq('id', eventId).single()
        if (data) {
            setAllowMultiple(data.allow_multiple_entry || false)
            setEventTitle(data.title)
        }
    }
    fetchEventSettings()
  }, [eventId])

  const handleScan = async (rawText: string) => {
    if (pauseScan || status === 'loading' || status === 'success' || status === 'warning') return

    try {
      if (!rawText) return
      setPauseScan(true)
      setStatus('loading')
      
      const parsedData = JSON.parse(rawText)
      if (parsedData.eventId !== eventId) {
          setStatus('error'); setMessage('â›” ØªØ°ÙƒØ±Ø© Ù„Ø­ÙÙ„Ø© Ø£Ø®Ø±Ù‰!'); return
      }

      const { data: attendee, error: fetchError } = await supabase
          .from('attendees').select('*').eq('event_id', eventId).eq('phone', parsedData.phone).single()

      if (fetchError || !attendee) {
          setStatus('error'); setMessage('âŒ Ø§Ù„Ø¶ÙŠÙ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'); return
      }

      if (attendee.status === 'attended' && !allowMultiple) {
            setStatus('warning')
            setMessage('âš ï¸ Ø§Ù„ØªØ°ÙƒØ±Ø© Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹!')
            setGuestName(attendee.name)
            setTimeout(() => { setStatus('idle'); setGuestName(''); setMessage(''); setPauseScan(false) }, 3000)
            return
      }

      // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª
      const { error: updateError } = await supabase
          .from('attendees')
          .update({ 
              status: 'attended', 
              attended_at: new Date().toISOString() 
          })
          .eq('id', attendee.id)

      if (updateError) {
          setStatus('error'); setMessage('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„')
      } else {
          setStatus('success')
          setGuestName(attendee.name)
          setMessage(attendee.status === 'attended' ? 'âœ… Ø¯Ø®ÙˆÙ„ Ù…ØªÙƒØ±Ø±' : 'âœ… Ù…Ø³Ù…ÙˆØ­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„')
          setTimeout(() => { setStatus('idle'); setMessage(''); setGuestName(''); setPauseScan(false) }, 3000)
      }

    } catch (err) {
      setStatus('error'); setMessage('âš ï¸ Ø¨Ø§Ø±ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­')
      setTimeout(() => { setStatus('idle'); setPauseScan(false) }, 2000)
    }
  }

  return (
    <div className="min-h-screen bg-black flex flex-col items-center justify-center p-4 relative" dir="rtl">
      <div className="absolute top-6 w-full text-center z-10">
        <h1 className="text-white font-bold text-lg drop-shadow-md">{eventTitle}</h1>
        <div className="flex justify-center items-center gap-2 mt-2">
            <span className={`px-3 py-1 rounded-full text-xs flex items-center gap-1 backdrop-blur-md border ${allowMultiple ? 'bg-green-500/20 border-green-500/30 text-green-100' : 'bg-indigo-500/20 border-indigo-500/30 text-indigo-100'}`}>
                {allowMultiple ? <><Repeat size={12}/> Ø¯Ø®ÙˆÙ„ Ù…ØªØ¹Ø¯Ø¯</> : <><AlertTriangle size={12}/> Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</>}
            </span>
        </div>
      </div>

      <div className="w-full max-w-md bg-zinc-900 rounded-3xl overflow-hidden shadow-2xl relative border border-zinc-800">
        <div className="relative h-96 bg-black overflow-hidden">
            {status === 'success' && (
                <div className="absolute inset-0 flex flex-col items-center justify-center bg-green-600 text-white z-20 animate-in fade-in zoom-in duration-300">
                    <CheckCircle size={80} className="mb-4" />
                    <h2 className="text-3xl font-bold mb-2">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ!</h2>
                    <p className="text-xl font-medium">{guestName}</p>
                </div>
            )}
            {status === 'warning' && (
                <div className="absolute inset-0 flex flex-col items-center justify-center bg-yellow-500 text-white z-20 animate-in fade-in zoom-in duration-300">
                    <AlertTriangle size={80} className="mb-4" />
                    <h2 className="text-2xl font-bold mb-2 text-center">Ø³Ø¨Ù‚ Ù„Ù‡ Ø§Ù„Ø¯Ø®ÙˆÙ„!</h2>
                    <p className="text-xl font-medium">{guestName}</p>
                </div>
            )}
            {status === 'error' && (
                <div className="absolute inset-0 flex flex-col items-center justify-center bg-red-600 text-white z-20 animate-in fade-in duration-300">
                    <XCircle size={80} className="mb-4" />
                    <h2 className="text-2xl font-bold text-center px-4">{message}</h2>
                    <button onClick={() => { setStatus('idle'); setPauseScan(false); }} className="mt-6 bg-white text-red-600 px-6 py-2 rounded-full font-bold shadow-lg">Ø§Ø³ØªÙ…Ø±Ø§Ø±</button>
                </div>
            )}
            {status === 'loading' && <div className="absolute inset-0 bg-black/80 flex items-center justify-center z-20 backdrop-blur-sm"><Loader2 className="animate-spin text-indigo-500 w-16 h-16"/></div>}

            <div className="h-full w-full relative">
                 <Scanner onScan={(result) => { if (result && result.length > 0) handleScan(result[0].rawValue) }} allowMultiple={true} scanDelay={2000} components={{ audio: false, finder: false }} styles={{ container: { height: '100%' }, video: { objectFit: 'cover' } }} />
            </div>
            
            {status === 'idle' && (
                <div className="absolute inset-0 pointer-events-none flex flex-col items-center justify-center z-10">
                    <div className={`w-64 h-64 border-2 ${allowMultiple ? 'border-green-500/50' : 'border-indigo-500/50'} rounded-3xl relative animate-pulse`}>
                         <div className="absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-current rounded-tl-2xl opacity-50"></div>
                        <div className="absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-current rounded-tr-2xl opacity-50"></div>
                        <div className="absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-current rounded-bl-2xl opacity-50"></div>
                        <div className="absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-current rounded-br-2xl opacity-50"></div>
                    </div>
                </div>
            )}
        </div>
        
        {/* ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø®Ø·Ø£ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ */}
        <div className="bg-zinc-900 border-t border-zinc-800 text-white p-6 text-center">
            <div className="flex items-center justify-center gap-2 text-zinc-400 mb-1">
                <Camera size={16} />
                <span className="text-xs uppercase tracking-wider font-semibold">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
            </div>
            <p className="font-bold text-lg text-indigo-400">
                {status === 'idle' ? 'Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø³Ø­...' : 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©'}
            </p>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="app/scan/[id]/page.tsx">
'use client';

import { useState, useEffect, use } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import {
  Scan, Search, UserCheck, Plus, Lock,
  LogOut, Loader2, CheckCircle2, XCircle, ArrowLeft
} from 'lucide-react';
import { useRouter } from 'next/navigation';

interface PageProps {
  params: Promise<{ id: string }>;
}

export default function SupervisorPortal({ params }: PageProps) {
  const { id } = use(params);
  const router = useRouter();

  // --- States ---
  const [isAuthenticated, setIsAuthenticated] = useState(false);
  const [pin, setPin] = useState('');
  const [error, setError] = useState('');
  const [loading, setLoading] = useState(false);

  // Data
  const [event, setEvent] = useState<any>(null);
  const [guestQuery, setGuestQuery] = useState('');
  const [searchResult, setSearchResult] = useState<any[]>([]);
  const [activeTab, setActiveTab] = useState<'scan' | 'search'>('search'); // 'scan' or 'search'

  // --- Login Logic ---
  const handleLogin = (e: React.FormEvent) => {
    e.preventDefault();
    if (pin === '1234') { // Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø«Ø§Ø¨Øª ÙƒÙ…Ø§ Ø§ØªÙÙ‚Ù†Ø§
      setIsAuthenticated(true);
      fetchEventData();
    } else {
      setError('Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­');
      setPin('');
    }
  };

  // --- Fetch Data ---
  const fetchEventData = async () => {
    setLoading(true);
    const { data } = await supabase.from('events').select('name').eq('id', id).single();
    if (data) setEvent(data);
    setLoading(false);
  };

  // --- Search Guest ---
  const handleSearch = async (query: string) => {
    setGuestQuery(query);
    if (query.length < 2) {
      setSearchResult([]);
      return;
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø¨Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ù€ ID (Ø±Ù‚Ù… Ø§Ù„ØªØ°ÙƒØ±Ø©)
    const { data } = await supabase
      .from('attendees')
      .select('*')
      .eq('event_id', id)
      .or(`name.ilike.%${query}%,id.eq.${query}`); // Ø¨Ø­Ø« Ø°ÙƒÙŠ

    if (data) setSearchResult(data);
  };

  // --- Check-in Logic ---
  const toggleAttendance = async (guestId: string, currentStatus: boolean) => {
    // ØªØ­Ø¯ÙŠØ« Ù…ØªÙØ§Ø¦Ù„ (Optimistic Update)
    setSearchResult(prev => prev.map(g => g.id === guestId ? { ...g, attended: !currentStatus } : g));

    await supabase
      .from('attendees')
      .update({ attended: !currentStatus })
      .eq('id', guestId);

    // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ù†Ø¬Ø§Ø­ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    if (!currentStatus) playSuccessSound();
  };

  const playSuccessSound = () => {
    // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØµÙˆØª "Ø¨ÙŠØ¨" Ø¨Ø³ÙŠØ· Ù‡Ù†Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
  };

  // --- Add Walk-in Guest ---
  const handleQuickAdd = async () => {
    if (!guestQuery.trim()) return;
    if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© "${guestQuery}" ÙˆØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„Ù‡ ÙÙˆØ±Ø§Ù‹ØŸ`)) return;

    const { data, error } = await supabase
      .from('attendees')
      .insert([{
        event_id: id,
        name: guestQuery,
        status: 'confirmed',
        attended: true // ÙŠØ¯Ø®Ù„ ÙˆÙ‡Ùˆ "Ø­Ø§Ø¶Ø±" ÙÙˆØ±Ø§Ù‹
      }])
      .select()
      .single();

    if (!error && data) {
      alert('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ù„ØªØ­Ø¶ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­ âœ…');
      setGuestQuery('');
      setSearchResult([data]); // Ø¥Ø¸Ù‡Ø§Ø±Ù‡ ÙÙŠ Ø§Ù„Ù†ØªÙŠØ¬Ø©
    }
  };


  // --- ğŸ”’ Login Screen ---
  if (!isAuthenticated) {
    return (
      <div className="min-h-screen bg-black text-white flex flex-col items-center justify-center p-6 font-sans" dir="rtl">
        <div className="w-full max-w-sm text-center">
          <div className="w-20 h-20 bg-[#C19D65]/10 rounded-3xl flex items-center justify-center text-[#C19D65] mx-auto mb-6">
            <Lock size={40} />
          </div>
          <h1 className="text-2xl font-black mb-2">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†</h1>
          <p className="text-white/40 text-sm mb-8">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² PIN Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>

          <form onSubmit={handleLogin} className="space-y-4">
            <input
              type="password"
              inputMode="numeric"
              maxLength={4}
              value={pin}
              onChange={(e) => setPin(e.target.value)}
              className="w-full bg-[#18181B] border border-white/10 rounded-2xl p-4 text-center text-3xl font-mono tracking-[0.5em] outline-none focus:border-[#C19D65] transition-colors"
              placeholder="â€¢â€¢â€¢â€¢"
              autoFocus
            />
            {error && <p className="text-red-500 text-sm font-bold">{error}</p>}
            <button type="submit" className="w-full bg-[#C19D65] hover:bg-[#b08d55] text-black font-black py-4 rounded-2xl transition-transform active:scale-95">
              Ø¯Ø®ÙˆÙ„
            </button>
          </form>
        </div>
      </div>
    );
  }

  // --- ğŸ“± Dashboard Screen ---
  return (
    <div className="min-h-screen bg-[#0A0A0C] text-white font-sans flex flex-col" dir="rtl">

      {/* Header */}
      <div className="p-4 border-b border-white/10 bg-[#18181B] sticky top-0 z-10 flex items-center justify-between shadow-lg">
        <div>
          <p className="text-[10px] text-white/40 font-bold uppercase">Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ</p>
          <h2 className="text-lg font-black truncate max-w-[200px]">{event?.name || 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...'}</h2>
        </div>
        <button onClick={() => setIsAuthenticated(false)} className="bg-red-500/10 text-red-500 p-3 rounded-xl hover:bg-red-500/20">
          <LogOut size={18} />
        </button>
      </div>

      {/* Main Content */}
      <div className="flex-1 p-4 pb-24 overflow-y-auto">

        {/* Search Bar (Acts as Manual Scanner) */}
        <div className="relative mb-6">
          <div className="absolute right-4 top-1/2 -translate-y-1/2 text-white/40">
            <Search size={20} />
          </div>
          <input
            type="text"
            value={guestQuery}
            onChange={(e) => handleSearch(e.target.value)}
            placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„ØªØ°ÙƒØ±Ø©..."
            className="w-full bg-[#18181B] border border-white/10 rounded-2xl py-4 pr-12 pl-4 outline-none focus:border-[#C19D65] text-lg shadow-inner"
            autoFocus
          />
        </div>

        {/* Results */}
        <div className="space-y-3">
          {searchResult.length > 0 ? (
            searchResult.map((guest) => (
              <div key={guest.id} className={`p-4 rounded-2xl border flex items-center justify-between transition-all ${guest.attended ? 'bg-green-500/10 border-green-500/30' : 'bg-[#18181B] border-white/5'}`}>
                <div>
                  <h3 className="font-bold text-lg">{guest.name}</h3>
                  <p className="text-xs text-white/40 font-mono mt-1">ID: {guest.id.slice(0, 8)}</p>
                  <span className={`text-[10px] font-bold px-2 py-0.5 rounded mt-2 inline-block ${guest.status === 'confirmed' ? 'bg-blue-500/20 text-blue-400' : 'bg-white/10 text-white/50'}`}>
                    {guest.status === 'confirmed' ? 'Ø¯Ø¹ÙˆØ© Ù…Ø¤ÙƒØ¯Ø©' : 'Ù…Ø¯Ø¹Ùˆ'}
                  </span>
                </div>

                <button
                  onClick={() => toggleAttendance(guest.id, guest.attended)}
                  className={`w-14 h-14 rounded-full flex items-center justify-center transition-transform active:scale-90 shadow-lg ${guest.attended ? 'bg-green-500 text-black' : 'bg-white/10 text-white border border-white/10'}`}
                >
                  {guest.attended ? <CheckCircle2 size={28} /> : <Scan size={24} />}
                </button>
              </div>
            ))
          ) : guestQuery.length > 2 ? (
            <div className="text-center py-10 opacity-60">
              <Search size={40} className="mx-auto mb-4 text-white/20" />
              <p className="text-sm mb-4">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¶ÙŠÙ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù…</p>
              <button onClick={handleQuickAdd} className="bg-[#C19D65] text-black px-6 py-3 rounded-xl font-bold text-sm hover:scale-105 transition-transform flex items-center gap-2 mx-auto">
                <Plus size={16} /> Ø¥Ø¶Ø§ÙØ© &quot;{guestQuery}&quot; ÙƒØ¶ÙŠÙ Ø¬Ø¯ÙŠØ¯
              </button>
            </div>
          ) : (
            <div className="text-center py-20 opacity-30">
              <Scan size={60} className="mx-auto mb-4" />
              <p className="text-sm">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¨Ø­Ø« Ø£Ùˆ Ø§Ù…Ø³Ø­ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯</p>
            </div>
          )}
        </div>
      </div>

      {/* Floating Scan Button (For Camera Future Integration) */}
      <div className="fixed bottom-6 left-1/2 -translate-x-1/2 w-full max-w-md px-6">
        <button className="w-full bg-white text-black font-black py-4 rounded-[2rem] shadow-2xl flex items-center justify-center gap-2 hover:bg-gray-200 transition-colors">
          <Scan size={20} /> ÙØªØ­ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ (Ù‚Ø±ÙŠØ¨Ø§Ù‹)
        </button>
      </div>

    </div>
  );
}
</file>

<file path="app/staff/[id]/page.tsx">
'use client'

import { useEffect, useState, use } from 'react'
import { supabase } from '@/app/utils/supabase/client'
import { Search, CheckCircle, Clock, Plus, Loader2, X, Shield, Trash2, Edit, Save, UserPlus } from 'lucide-react'
import { Attendee } from '@/types'

interface PageProps { params: Promise<{ id: string }> }

export default function StaffPage({ params }: PageProps) {
    const resolvedParams = use(params)
    const eventId = resolvedParams.id

    const [attendees, setAttendees] = useState<Attendee[]>([])
    const [event, setEvent] = useState<any>(null)
    const [search, setSearch] = useState('')
    const [loading, setLoading] = useState(true)

    const [showAddModal, setShowAddModal] = useState(false)
    const [showEditModal, setShowEditModal] = useState(false)

    const [formData, setFormData] = useState({ name: '', phone: '' })
    const [selectedAttendee, setSelectedAttendee] = useState<Attendee | null>(null)
    const [processing, setProcessing] = useState(false)

    // const supabase = createClient() // Removed in favor of imported instance

    const fetchData = async () => {
        const { data: eventData } = await supabase.from('events').select('title').eq('id', eventId).single()
        setEvent(eventData)

        const { data: attendeesData } = await supabase
            .from('attendees')
            .select('*')
            .eq('event_id', eventId)
            .order('created_at', { ascending: false })

        if (attendeesData) setAttendees(attendeesData)
        setLoading(false)
    }

    useEffect(() => { fetchData() }, [eventId])

    const toggleCheckIn = async (attendee: Attendee) => {
        const newStatus = attendee.status === 'checked_in' ? 'pending' : 'checked_in'
        const checkInTime = newStatus === 'checked_in' ? new Date().toISOString() : null

        setAttendees(prev => prev.map(a => a.id === attendee.id ? { ...a, status: newStatus, check_in_time: checkInTime } : a))
        await supabase.from('attendees').update({ status: newStatus, check_in_time: checkInTime }).eq('id', attendee.id)
    }

    const handleDelete = async (id: string) => {
        if (!confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©ØŸ')) return
        const { error } = await supabase.from('attendees').delete().eq('id', id)
        if (!error) setAttendees(prev => prev.filter(a => a.id !== id))
        else alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù')
    }

    const handleAdd = async (e: React.FormEvent) => {
        e.preventDefault()
        setProcessing(true)
        const phone = formData.phone.startsWith('+') ? formData.phone : `+966${formData.phone.replace(/^0+/, '')}`

        const { data, error } = await supabase.from('attendees').insert([{
            event_id: eventId,
            name: formData.name,
            phone: phone,
            email: `${phone}@manual.com`,
            status: 'checked_in',
            check_in_time: new Date().toISOString()
        }]).select().single()

        if (!error && data) {
            setAttendees([data, ...attendees])
            setShowAddModal(false)
            setFormData({ name: '', phone: '' })
            alert('âœ… ØªÙ… Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­')
        } else {
            alert('âŒ Ø®Ø·Ø£: Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ù‚Ù… Ù…Ø³Ø¬Ù„Ø§Ù‹ Ù…Ø³Ø¨Ù‚Ø§Ù‹')
        }
        setProcessing(false)
    }

    const openEditModal = (attendee: Attendee) => {
        setSelectedAttendee(attendee)
        setFormData({ name: attendee.name, phone: attendee.phone })
        setShowEditModal(true)
    }

    const handleEdit = async (e: React.FormEvent) => {
        e.preventDefault()
        if (!selectedAttendee) return
        setProcessing(true)

        const { error } = await supabase
            .from('attendees')
            .update({ name: formData.name })
            .eq('id', selectedAttendee.id)

        if (!error) {
            setAttendees(prev => prev.map(a => a.id === selectedAttendee.id ? { ...a, name: formData.name } : a))
            setShowEditModal(false)
            setSelectedAttendee(null)
        } else {
            alert('ÙØ´Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„')
        }
        setProcessing(false)
    }

    const filtered = attendees.filter(a => a.name.toLowerCase().includes(search.toLowerCase()) || a.phone.includes(search))

    if (loading) return <div className="min-h-screen flex justify-center items-center bg-slate-50"><Loader2 className="animate-spin text-indigo-600" /></div>

    return (
        <div className="min-h-screen bg-slate-50 p-4 pb-24" dir="rtl">

            {/* Ø§Ù„Ù‡ÙŠØ¯Ø± */}
            <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 mb-4 sticky top-4 z-10 flex justify-between items-center">
                <div>
                    <h1 className="font-bold text-slate-800 text-lg truncate max-w-[180px]">{event?.title}</h1>
                    <p className="text-xs text-orange-500 flex items-center gap-1 font-bold"><Shield size={12} /> Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ</p>
                </div>
                <div className="bg-indigo-50 text-indigo-600 px-4 py-2 rounded-xl text-sm font-bold shadow-sm">
                    {attendees.filter(a => a.status === 'checked_in').length} <span className="text-slate-400 font-normal">/ {attendees.length}</span>
                </div>
            </div>

            {/* Ø§Ù„Ø¨Ø­Ø« */}
            <div className="relative mb-4">
                <Search className="absolute right-3 top-3.5 text-slate-400" size={20} />
                <input
                    className="w-full bg-white pl-4 pr-10 py-3.5 rounded-xl border border-slate-200 outline-none focus:border-indigo-500 transition shadow-sm"
                    placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù…..."
                    value={search}
                    onChange={e => setSearch(e.target.value)}
                />
            </div>

            {/* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */}
            <div className="space-y-3">
                {filtered.length === 0 ? (
                    <div className="text-center py-10 text-slate-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>
                ) : (
                    filtered.map(att => (
                        <div key={att.id} className={`p-4 rounded-xl border flex justify-between items-center transition shadow-sm ${att.status === 'checked_in' ? 'bg-green-50/50 border-green-200' : 'bg-white border-slate-200'}`}>

                            <div className="flex-1">
                                <h3 className="font-bold text-slate-800 mb-0.5">{att.name}</h3>
                                <p className="text-xs text-slate-500 font-mono mb-2" dir="ltr">{att.phone}</p>

                                <div className="flex gap-3">
                                    <button onClick={() => openEditModal(att)} className="text-slate-400 hover:text-indigo-600 flex items-center gap-1 text-[10px] bg-slate-100 px-2 py-1 rounded hover:bg-indigo-50 transition">
                                        <Edit size={12} /> ØªØ¹Ø¯ÙŠÙ„
                                    </button>
                                    <button onClick={() => handleDelete(att.id)} className="text-slate-400 hover:text-red-600 flex items-center gap-1 text-[10px] bg-slate-100 px-2 py-1 rounded hover:bg-red-50 transition">
                                        <Trash2 size={12} /> Ø­Ø°Ù
                                    </button>
                                </div>

                                {att.check_in_time && att.status === 'checked_in' && (
                                    <p className="text-[10px] text-green-600 flex items-center gap-1 mt-2 font-medium">
                                        <Clock size={10} /> Ø¯Ø®Ù„: {new Date(att.check_in_time).toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' })}
                                    </p>
                                )}
                            </div>

                            <button
                                onClick={() => toggleCheckIn(att)}
                                className={`w-12 h-12 rounded-full flex items-center justify-center transition shadow-sm ml-2 shrink-0 ${att.status === 'checked_in' ? 'bg-green-500 text-white hover:bg-green-600' : 'bg-slate-100 text-slate-300 hover:bg-indigo-100 hover:text-indigo-600'}`}
                            >
                                <CheckCircle size={24} />
                            </button>
                        </div>
                    ))
                )}
            </div>

            {/* Ø²Ø± Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø§Ù„ÙŠØ¯ÙˆÙŠ (ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§) */}
            <button
                onClick={() => { setFormData({ name: '', phone: '' }); setShowAddModal(true) }}
                className="fixed bottom-6 left-6 bg-indigo-600 text-white px-6 py-4 rounded-full shadow-2xl flex items-center gap-2 hover:scale-105 transition font-bold z-20"
            >
                <UserPlus size={24} /> <span>ØªØ­Ø¶ÙŠØ± ÙŠØ¯ÙˆÙŠ</span>
            </button>

            {/* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ© */}
            {showAddModal && (
                <div className="fixed inset-0 bg-black/60 z-50 flex items-end md:items-center justify-center p-4 backdrop-blur-sm animate-in fade-in">
                    <div className="bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl animate-in slide-in-from-bottom-10">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="font-bold text-lg flex items-center gap-2"><UserPlus className="text-indigo-600" size={20} /> ØªØ­Ø¶ÙŠØ± Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯</h3>
                            <button onClick={() => setShowAddModal(false)} className="bg-slate-100 p-1 rounded-full text-slate-500 hover:bg-red-50 hover:text-red-500"><X size={20} /></button>
                        </div>
                        <form onSubmit={handleAdd} className="space-y-4">
                            <div>
                                <label className="text-sm font-medium text-slate-700 block mb-1">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ</label>
                                <input required className="w-full p-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="Ø§Ù„Ø§Ø³Ù…" value={formData.name} onChange={e => setFormData({ ...formData, name: e.target.value })} />
                            </div>
                            <div>
                                <label className="text-sm font-medium text-slate-700 block mb-1">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
                                <input required type="tel" className="w-full p-3 border border-slate-300 rounded-xl text-right focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="5xxxxxxxx" value={formData.phone} onChange={e => setFormData({ ...formData, phone: e.target.value })} />
                            </div>
                            <button disabled={processing} className="w-full bg-indigo-600 text-white py-3.5 rounded-xl font-bold mt-2 shadow-lg hover:bg-indigo-700 transition flex justify-center items-center gap-2">
                                {processing ? <Loader2 className="animate-spin" /> : <CheckCircle size={20} />}
                                <span>ØªØ³Ø¬ÙŠÙ„ ÙˆØ¯Ø®ÙˆÙ„ ÙÙˆØ±ÙŠ</span>
                            </button>
                        </form>
                    </div>
                </div>
            )}

            {/* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ */}
            {showEditModal && (
                <div className="fixed inset-0 bg-black/60 z-50 flex items-end md:items-center justify-center p-4 backdrop-blur-sm animate-in fade-in">
                    <div className="bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl animate-in slide-in-from-bottom-10">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="font-bold text-lg flex items-center gap-2"><Edit className="text-orange-500" size={20} /> ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                            <button onClick={() => setShowEditModal(false)} className="bg-slate-100 p-1 rounded-full text-slate-500 hover:bg-slate-200"><X size={20} /></button>
                        </div>
                        <form onSubmit={handleEdit} className="space-y-4">
                            <div>
                                <label className="text-sm font-medium text-slate-700 block mb-1">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯</label>
                                <input required className="w-full p-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-orange-500 outline-none" value={formData.name} onChange={e => setFormData({ ...formData, name: e.target.value })} />
                            </div>
                            <div className="opacity-50 pointer-events-none">
                                <label className="text-sm font-medium text-slate-700 block mb-1">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ (Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡)</label>
                                <input readOnly className="w-full p-3 border border-slate-200 bg-slate-50 rounded-xl text-right" value={formData.phone} />
                            </div>
                            <button disabled={processing} className="w-full bg-slate-900 text-white py-3.5 rounded-xl font-bold mt-2 shadow-lg hover:bg-slate-800 transition flex justify-center items-center gap-2">
                                {processing ? <Loader2 className="animate-spin" /> : <Save size={20} />}
                                <span>Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</span>
                            </button>
                        </form>
                    </div>
                </div>
            )}

        </div>
    )
}
</file>

<file path="app/utils/check-limits.ts">
import { createClient } from '@/app/utils/supabase/client'

export async function checkEventLimit() {
  const supabase = createClient()
  
  // 1. Ù…ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ
  const { data: { user } } = await supabase.auth.getUser()
  if (!user) return { allowed: false, message: 'ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' }

  // 2. ÙˆØ´ Ø¨Ø§Ù‚ØªÙ‡ØŸ
  const { data: profile } = await supabase
    .from('profiles')
    .select('*, packages(*)') // Ù†Ø¬ÙŠØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ø±Ø¨ÙˆØ·Ø©
    .eq('id', user.id)
    .single()

  // Ø­Ø§Ù„Ø© Ù†Ø§Ø¯Ø±Ø©: Ù„Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¯ÙŠÙ… ÙˆÙ…Ø§ Ø¹Ù†Ø¯Ù‡ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ØŒ Ù†Ù…Ø´ÙŠÙ‡ Ù…Ø¤Ù‚ØªØ§Ù‹ Ø£Ùˆ Ù†Ø±Ø¬Ø¹Ù‡ Ø®Ø·Ø£
  if (!profile) return { allowed: true } 

  // 3. ÙƒÙ… Ø­ÙÙ„Ø© Ø³Ø§ÙˆÙ‰ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†ØŸ
  const { count } = await supabase
    .from('events')
    .select('*', { count: 'exact', head: true }) // head: true ÙŠØ¹Ù†ÙŠ Ø¹Ø¯ ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    .eq('user_id', user.id)

  const limit = profile.packages.max_events

  // 4. Ù„Ø­Ø¸Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø©: Ù‡Ù„ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ØŸ
  if (count !== null && count >= limit) {
    return { 
        allowed: false, 
        message: `Ø¹Ø°Ø±Ø§Ù‹ ğŸ›‘ØŒ Ø¨Ø§Ù‚ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ© (${profile.packages.name}) ØªØ³Ù…Ø­ Ø¨Ù€ ${limit} Ù…Ù†Ø§Ø³Ø¨Ø§Øª ÙÙ‚Ø·.` 
    }
  }

  return { allowed: true }
}
</file>

<file path="app/utils/supabase/client.ts">
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;

// Ù…Ù†Ø¹ Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙƒØ«Ø± Ù…Ù† Ù†Ø³Ø®Ø© ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­
export const supabase = createClient(supabaseUrl, supabaseKey);
</file>

<file path="app/utils/supabase/server.ts">
import { createServerClient } from '@supabase/ssr'
import { cookies } from 'next/headers'

export async function createClient() {
  const cookieStore = await cookies()

  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll()
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            )
          } catch {
            // ÙŠØªÙ… ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø®Ø·Ø£ Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…Ù† Server Component
          }
        },
      },
    }
  )
}
</file>

<file path="components/EventCard.tsx">
import { Calendar, MapPin, ArrowLeft } from 'lucide-react';
import Link from 'next/link';

interface EventProps {
  id: string;
  name: string;
  date: string;
  location: string;
}

export default function EventCard({ id, name, date, location }: EventProps) {
  return (
    <div className="group relative bg-white/[0.03] backdrop-blur-xl p-6 rounded-2xl border border-white/5 hover:border-primary-500/30 transition-all duration-500 hover:-translate-y-1 shadow-2xl">
      <div className="flex justify-between items-center">
        <div className="space-y-3 text-right">
          {/* Ø§Ø³Ù… Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø¨ÙŠØ¶ */}
          <h3 className="text-xl font-bold text-white group-hover:text-primary-400 transition-colors">
            {name}
          </h3>
          
          <div className="space-y-1.5">
            <div className="flex items-center gap-2 text-white/40 text-sm">
              <Calendar size={16} className="text-primary-500" />
              <span>{new Date(date).toLocaleDateString('ar-SA')}</span>
            </div>
            
            <div className="flex items-center gap-2 text-white/40 text-sm">
              <MapPin size={16} className="text-primary-500" />
              <span>{location || 'Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
            </div>
          </div>
        </div>

        {/* Ø²Ø± Ø§Ù„Ø³Ù‡Ù… Ø¨ØªØµÙ…ÙŠÙ… Ø°Ù‡Ø¨ÙŠ */}
        <Link 
          href={`/dashboard/events/${id}`}
          className="bg-primary-500/10 text-primary-500 p-3 rounded-xl border border-primary-500/20 hover:bg-primary-500 hover:text-white transition-all duration-300"
        >
          <ArrowLeft size={20} />
        </Link>
      </div>
    </div>
  );
}
</file>

<file path="components/FeatureSlider.tsx">
import { Smartphone, QrCode, BarChart3, ShieldCheck, Heart, Users, CalendarCheck, Presentation } from 'lucide-react';

export default function FeatureSlider({ isWedding }: { isWedding: boolean }) {
  // Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
  const features = isWedding ? [
    { icon: Heart, title: "Ø¯Ø¹ÙˆØ§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©", desc: "Ø£Ø±Ø³Ù„ ÙƒØ±Øª Ø§Ù„Ø²ÙˆØ§Ø¬ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ù„Ù…Ø³Ø© ÙØ®Ù…Ø©." },
    { icon: QrCode, title: "ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„", desc: "Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø®Ø§Øµ Ù„ÙƒÙ„ Ø¶ÙŠÙ ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù…." },
    { icon: Users, title: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§ÙˆÙ„Ø§Øª", desc: "ØªÙˆØ²ÙŠØ¹ Ø°ÙƒÙŠ Ù„Ù„Ø¶ÙŠÙˆÙ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª." },
    { icon: CalendarCheck, title: "ØªØ°ÙƒÙŠØ± Ø¢Ù„ÙŠ", desc: "Ø±Ø³Ø§Ø¦Ù„ ØªØ°ÙƒÙŠØ± Ù‚Ø¨Ù„ Ù„ÙŠÙ„Ø© Ø§Ù„Ø¹Ù…Ø± Ø¨Ù€ 24 Ø³Ø§Ø¹Ø©." },
  ] : [
    { icon: Presentation, title: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¤ØªÙ…Ø±Ø§Øª", desc: "Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† ÙˆØ§Ù„Ø´Ø±ÙƒØ§Ø¡." },
    { icon: QrCode, title: "Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª", desc: "Ø¥ØµØ¯Ø§Ø± Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ (Badges) ÙÙˆØ± Ø§Ù„ÙˆØµÙˆÙ„." },
    { icon: BarChart3, title: "ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ±", desc: "Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ù„Ø­Ø¸ÙŠØ§Ù‹." },
    { icon: Smartphone, title: "ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø¸Ù…", desc: "ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„ ÙÙŠ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ù…Ù† Ø¬ÙˆØ§Ù„Ùƒ." },
  ];

  return (
    <section className="py-20 px-6 relative z-10">
      <div className="max-w-7xl mx-auto">
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {features.map((item, idx) => (
            <div key={idx} className="bg-white/[0.03] backdrop-blur-xl border border-white/10 p-8 rounded-[2rem] hover:bg-white/[0.07] transition-all duration-500 group">
              <div className={`w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-6 transition-all duration-500 ${
                isWedding ? 'text-[#C19D65] shadow-[0_0_15px_rgba(193,157,101,0.2)]' : 'text-blue-500 shadow-[0_0_15px_rgba(59,130,246,0.2)]'
              } group-hover:scale-110`}>
                <item.icon size={28} />
              </div>
              <h3 className="text-xl font-bold mb-3 text-white transition-colors duration-500">{item.title}</h3>
              <p className="text-sm text-white/40 leading-relaxed">{item.desc}</p>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
}
</file>

<file path="components/HeroSection.tsx">
'use client';
import { motion } from 'framer-motion';

export default function HeroSection({ isWedding, onToggle }: any) {
  return (
    <section className="relative pt-40 pb-20 px-6 min-h-[80vh] flex flex-col items-center justify-center text-center">
      {/* Ø§Ù„Ø¶ÙˆØ¡ Ø§Ù„Ø®Ù„ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ± */}
      <div className={`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] rounded-full blur-[120px] opacity-20 pointer-events-none transition-all duration-1000 ${isWedding ? 'bg-[#C19D65]' : 'bg-blue-600'}`}></div>

      <div className="relative z-10 mb-12 p-2 bg-white/5 border border-white/10 rounded-full inline-flex">
        <button onClick={() => onToggle(true)} className={`px-8 py-3 rounded-full text-base font-bold transition-all ${isWedding ? 'bg-[#C19D65] text-white' : 'text-gray-400'}`}>Ø£ÙØ±Ø§Ø­ âœ¨</button>
        <button onClick={() => onToggle(false)} className={`px-8 py-3 rounded-full text-base font-bold transition-all ${!isWedding ? 'bg-blue-600 text-white' : 'text-gray-400'}`}>Ø£Ø¹Ù…Ø§Ù„ ğŸ’¼</button>
      </div>

      <motion.h1 key={isWedding ? "w" : "b"} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-6xl md:text-8xl font-bold text-white leading-tight">
        {isWedding ? (<>ÙˆØ«Ù‘Ù‚ Ù„Ø­Ø¸Ø§Øª <span className="text-[#C19D65]">Ø§Ù„ÙØ±Ø­</span></>) : (<>Ø£Ø¯Ø± Ù…Ù†Ø§Ø³Ø¨Ø§Øª <span className="text-blue-600">Ø§Ù„Ø£Ø¹Ù…Ø§Ù„</span></>)}
      </motion.h1>
    </section>
  );
}
</file>

<file path="components/Navbar.tsx">
import Link from 'next/link';
import { Sparkles } from 'lucide-react';

export default function Navbar({ isWedding }: { isWedding: boolean }) {
  return (
    <nav className="fixed top-0 w-full z-50 border-b border-white/[0.08] bg-[#0F0F12]/80 backdrop-blur-xl h-20 flex items-center transition-all duration-500">
      <div className="container mx-auto px-6 flex justify-between items-center">
        
        {/* Ø§Ù„Ø´Ø¹Ø§Ø± - ÙŠØªØºÙŠØ± Ø¨ÙŠÙ† Ø§Ù„Ø°Ù‡Ø¨ÙŠ ÙˆØ§Ù„Ø£Ø²Ø±Ù‚ */}
        <Link href="/" className="flex items-center gap-3 group">
          <div className={`p-2 rounded-xl text-white shadow-lg transition-all duration-500 ${
            isWedding 
              ? 'bg-[#C19D65] shadow-[#C19D65]/20' 
              : 'bg-blue-600 shadow-blue-600/20'
          }`}>
            <Sparkles className="w-5 h-5" />
          </div>
          <span className="text-2xl font-bold text-white tracking-tight">Ù…ÙÙ€Ø±Ø§Ø³</span>
        </Link>

        {/* Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± */}
        <div className="flex gap-4 items-center">
          <Link href="/login" className="text-sm font-bold text-gray-400 hover:text-white transition-colors">
            ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
          </Link>
          
          {/* Ø²Ø± Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† - Ø°Ù‡Ø¨ÙŠ ÙÙŠ Ø§Ù„Ø£ÙØ±Ø§Ø­ ÙˆØ£Ø²Ø±Ù‚ ÙÙŠ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ */}
          <Link href="/dashboard" className={`text-sm font-bold px-6 py-3 rounded-full transition-all duration-500 text-white ${
            isWedding 
              ? 'bg-[#C19D65] hover:bg-[#A4824E] shadow-[0_0_20px_rgba(193,157,101,0.3)]' 
              : 'bg-blue-600 hover:bg-blue-700 shadow-[0_0_20px_rgba(37,99,235,0.3)]'
          }`}>
            Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†
          </Link>
        </div>
      </div>
    </nav>
  );
}
</file>

<file path="components/StickyCTA.tsx">
'use client';
import { ArrowLeft } from 'lucide-react';

export default function StickyCTA({ isWedding }: { isWedding: boolean }) {
  return (
    <div className="fixed bottom-8 left-6 right-6 z-50 md:hidden">
      <button className={`w-full py-4 rounded-2xl font-bold text-white shadow-2xl flex items-center justify-center gap-3 transition-transform active:scale-95 ${
        isWedding ? 'bg-[#C19D65]' : 'bg-[#2563EB]'
      }`}>
        <span>{isWedding ? "ØµÙ…Ù… Ø¯Ø¹ÙˆØ§Øª ÙØ±Ø­Ùƒ" : "Ø§Ø¨Ø¯Ø£ ØªÙ†Ø¸ÙŠÙ… Ù…Ø¤ØªÙ…Ø±Ùƒ"}</span>
        <ArrowLeft size={20} />
      </button>
    </div>
  );
}
</file>

<file path="PROJECT_CONTEXT.md">
Ù…Ù„Ø®Øµ Ù…Ø´Ø±ÙˆØ¹ Ù…Ù†ØµØ© "Ù…ÙØ±Ø§Ø³" (Meras Platform Context)

1\. Ù†Ø¨Ø°Ø© Ø¹Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (Project Overview)

Ø§Ù„Ø§Ø³Ù…: Ù…ÙØ±Ø§Ø³ (Meras Platform). Ø§Ù„ÙˆØµÙ: Ù…Ù†ØµØ© SaaS Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª (Ø­ÙÙ„Ø§Øª Ø²ÙØ§ÙØŒ Ù…Ø¤ØªÙ…Ø±Ø§Øª Ø£Ø¹Ù…Ø§Ù„) ØªØ±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø±Ø¹Ø©ØŒ Ø§Ù„Ø£ØªÙ…ØªØ©ØŒ ÙˆØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ§Ø®Ø±Ø©. ØªØªÙŠØ­ Ù„Ù„Ù…Ù†Ø¸Ù…ÙŠÙ† Ø¥Ù†Ø´Ø§Ø¡ Ø±ÙˆØ§Ø¨Ø· Ø¯Ø¹ÙˆØ©ØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø¹ÙˆÙŠÙ†ØŒ ÙˆÙ…Ø³Ø­ Ø§Ù„ØªØ°Ø§ÙƒØ± (QR) Ù„Ø­Ø¸ÙŠØ§Ù‹.



2\. Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© (Tech Stack)

Frontend: Next.js 15 (App Router), React, TypeScript.



Styling: Tailwind CSS (Custom Dark Theme: #0A0A0C, #18181B, Gold #C19D65).



Backend \& DB: Supabase (PostgreSQL, Auth, Realtime).



Icons: Lucide React.



Key Libraries: qrcode.react (ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯), html-to-image (ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ°ÙƒØ±Ø©).



3\. Ù‡ÙŠÙƒÙ„Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Database Schema Concept)

Table: events



id (UUID), name, date, location\_name, type (wedding/business), pin\_code (Ù„Ù„Ù…Ø§Ø³Ø­).



Table: attendees



id (UUID - ÙŠÙØ³ØªØ®Ø¯Ù… ÙƒÙ€ Ticket ID), event\_id (FK), name, phone, email.



status (confirmed, declined, pending).



attended (Boolean - Ù„Ù„Ø¯Ø®ÙˆÙ„).



category (VIP, FAMILY, GENERAL).



updated\_at (ÙŠÙØ³ØªØ®Ø¯Ù… ÙƒÙ€ Timestamp Ù„ÙˆÙ‚Øª Ø§Ù„Ø¯Ø®ÙˆÙ„).



4\. Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØµÙØ­Ø§Øª ÙˆØ§Ù„Ù…Ø³Ø§Ø±Ø§Øª (Routing \& Features)

Ø£. ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (/register/\[id])



ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ØŒ ÙŠØ¯Ø¹Ù… RTL.



Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª (Validation).



Ø¯Ø¹Ù… Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ø§Ù„Ø®Ù„ÙŠØ¬ÙŠØ© Ù…Ø¹ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„ÙŠ (Ù…ÙØªØ§Ø­ Ø§Ù„Ø¯ÙˆÙ„Ø© ÙŠØ³Ø§Ø±ØŒ Ø§Ù„Ø±Ù‚Ù… ÙŠÙ…ÙŠÙ†).



Log: Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­ØŒ ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„ØµÙØ­Ø© Ø§Ù„ØªØ°ÙƒØ±Ø© (router.push).



Ø¨. ØµÙØ­Ø© Ø§Ù„ØªØ°ÙƒØ±Ø© (/ticket/\[id])



ØªØ¹Ø±Ø¶ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ°ÙƒØ±Ø© Ø¨ØªØµÙ…ÙŠÙ… CSS Ù…ØªÙ‚Ø¯Ù… (Gradient, Noise Texture).



ØªØªØºÙŠØ± Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© (Ø°Ù‡Ø¨ÙŠ Ù„Ù„Ø£ÙØ±Ø§Ø­ØŒ Ø£Ø²Ø±Ù‚ Ù„Ù„Ø£Ø¹Ù…Ø§Ù„).



Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:



ØªÙˆÙ„ÙŠØ¯ QR Code Ø¹Ø§Ù„ÙŠ Ø§Ù„ØªØ¨Ø§ÙŠÙ† (High Contrast).



Ø²Ø± "Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©" (Download PNG) Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©.



Ø£Ø²Ø±Ø§Ø± ØªÙØ§Ø¹Ù„ÙŠØ© (Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­ÙÙ„ØŒ Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØªÙ‚ÙˆÙŠÙ…).



Ø¬. Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (/dashboard/events/\[id])



Real-time: ØªØ³ØªÙ…Ø¹ Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Supabase Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù„Ø­Ø¸ÙŠØ§Ù‹.



Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª: Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ© (Donut Charts) Ù„Ù„Ø­Ø¶ÙˆØ±ØŒ Ø§Ù„ØªØ£ÙƒÙŠØ¯ØŒ ÙˆØ§Ù„Ù†Ø³Ø¨Ø©.



Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙŠÙ† Ø§Ù„Ø°ÙƒÙŠ:



Ø¨Ø­Ø« ÙˆÙÙ„ØªØ±Ø© (Tabs: Ø§Ù„ÙƒÙ„ØŒ Ø­Ø§Ø¶Ø±ØŒ Ù…Ø¤ÙƒØ¯).



Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¬Ù…Ø§Ø¹ÙŠØ© (Bulk Delete) Ù…Ø¹ Checkboxes.



Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ© Ø³Ø±ÙŠØ¹Ø© (Modal).



ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Excel/CSV).



Ø¹Ø±Ø¶ ÙˆÙ‚Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ¹Ù„ÙŠ (Timestamp).



Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:



Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ© ÙˆØ±Ø§Ø¨Ø· Ø§Ù„Ù…Ø§Ø³Ø­ (Ù…Ø¹ PIN).



ÙˆØ§Ø¬Ù‡Ø© Ø£ØªÙ…ØªØ© ÙˆØ§ØªØ³Ø§Ø¨ (ØªØ®ØµÙŠØµ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ°ÙƒÙŠØ±).



Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¶ÙŠÙÙŠÙ† (Co-Hosts UI).



Ø¯. Ø§Ù„Ù…Ø§Ø³Ø­ Ø§Ù„Ø¶ÙˆØ¦ÙŠ (/scan/\[id]) \[Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ: Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ø¶Ù…Ù† Ø§Ù„Ù…Ø®Ø·Ø·]



ØªØ³ØªØ®Ø¯Ù… ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø¬ÙˆØ§Ù„ Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù€ QR.



ØªØªØµÙ„ Ø¨Ù€ Supabase Ù„ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© attended Ø¥Ù„Ù‰ true.



ØªØ¹Ø·ÙŠ ØªØºØ°ÙŠØ© Ø±Ø§Ø¬Ø¹Ø© ØµÙˆØªÙŠØ©/Ø¨ØµØ±ÙŠØ© (Ø´Ø§Ø´Ø© Ø®Ø¶Ø±Ø§Ø¡/Ø­Ù…Ø±Ø§Ø¡).



5\. Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„Ù‡ÙˆÙŠØ© (Design Guidelines)

Ø§Ù„Ø®Ù„ÙÙŠØ©: Ø¯Ø§ÙƒÙ†Ø© Ø¬Ø¯Ø§Ù‹ (bg-\[#0A0A0C]) Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© ÙˆØ¥Ø¹Ø·Ø§Ø¡ ÙØ®Ø§Ù…Ø©.



Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª: bg-\[#18181B] Ù…Ø¹ Ø­Ø¯ÙˆØ¯ Ø®ÙÙŠÙØ© border-white/10.



Ø§Ù„Ø£Ù„ÙˆØ§Ù†: Ø§Ù„Ø°Ù‡Ø¨ÙŠ (#C19D65) Ù‡Ùˆ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ø£ÙØ±Ø§Ø­ ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.



Ø§Ù„ØªØ¬Ø§ÙˆØ¨: Mobile-First (ÙƒÙ„ Ø´ÙŠØ¡ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„Ø¬ÙˆØ§Ù„ Ø£ÙˆÙ„Ø§Ù‹)
</file>

<file path="tailwind.config.ts">
import type { Config } from "tailwindcss";

const config: Config = {
  content: [
    // Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± ÙŠØ¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ù…Ø¬Ù„Ø¯ app ÙˆØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„ÙØ±Ø¹ÙŠØ© ÙÙŠÙ‡
    "./app/**/*.{js,ts,jsx,tsx,mdx}",
    // Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± ÙŠØ¨Ø­Ø« ÙÙŠ Ù…Ø¬Ù„Ø¯ components Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ Ø§Ù„Ø°ÙŠ ØªØ¶Ø¹Ù‡ ÙÙŠ Ø§Ù„Ø¬Ø°Ø±
    "./components/**/*.{js,ts,jsx,tsx,mdx}",
    // Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± ÙŠØ¨Ø­Ø« Ø§Ø­ØªÙŠØ§Ø·Ø§Ù‹ ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø±
    "./src/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      colors: {
        background: {
          DEFAULT: '#0F0F12',
          card: '#18181B',
          surface: '#27272A'
        },
        primary: {
          400: '#D4B483', 
          500: '#C19D65', // Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø§Ù„ÙØ®Ù…
          600: '#A4824E',
        },
        action: {
          DEFAULT: '#2563EB', // Ø§Ù„Ø£Ø²Ø±Ù‚ Ù„Ù„Ø£Ø¹Ù…Ø§Ù„
        }
      },
    },
  },
  plugins: [],
};
export default config;
</file>

<file path="types/index.ts">
// types/index.ts

export interface Event {
    id: string;
    created_at: string;
    name: string;
    date: string;
    location_name: string;
    type: 'business' | 'wedding' | 'other'; // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©
    user_id?: string;
    status?: 'active' | 'draft';
    guests_count?: number;
    is_registration_open?: boolean;
}

export interface Attendee {
    id: string;
    created_at: string;
    event_id: string;
    name: string;
    email: string;
    phone: string;
    status: string;
    check_in_time?: string | null;
    attended?: boolean;
    eventName?: string;
    events?: Event; // Ù„Ø£Ù†Ù†Ø§ Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ Ù†Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ù…Ø¹ Ø§Ù„Ø¶ÙŠÙ
}
</file>

<file path=".gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts
</file>

<file path="app/globals.css">
@import "tailwindcss";

@theme {
  /* ØªØ¹Ø±ÙŠÙ Ø£Ù„ÙˆØ§Ù† Ù…ÙØ±Ø§Ø³ Ø§Ù„ÙØ®Ù…Ø© */
  --color-primary-500: #C19D65;
  --color-primary-600: #A4824E;
  --color-background-deep: #0F0F12;
  --color-background-card: #18181B;
  --color-action-blue: #2563EB;
  
  /* ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø®Ø· */
  --font-sans: "Alexandria", sans-serif;
}

@layer base {
  body {
    @apply bg-background-deep text-white antialiased;
    font-family: var(--font-sans);
  }
}

@layer utilities {
  .glass-card {
    @apply bg-white/[0.03] backdrop-blur-xl border border-white/10;
  }
}
/* ØªØ¹Ø±ÙŠÙ Ø­Ø±ÙƒØ© Ù†Ø¨Ø¶ Ø§Ù„Ø®ÙŠÙˆØ· Ø§Ù„Ø¶ÙˆØ¦ÙŠØ© */
@keyframes fiberPulse {
  0%, 100% { opacity: 0.1; stroke-width: 0.5px; }
  50% { opacity: 0.4; stroke-width: 1.2px; }
}

.animate-fiber {
  animation: fiberPulse 4s ease-in-out infinite;
}

/* ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙˆÙ‡Ø¬ Ù„Ù„Ø®ÙŠÙˆØ· */
.glow-line {
  filter: drop-shadow(0 0 2px currentColor);
}
</file>

<file path="app/layout.tsx">
import type { Metadata } from "next";
import { Alexandria } from "next/font/google";
import "./globals.css";

const alexandria = Alexandria({ 
  subsets: ["arabic"],
  variable: "--font-alexandria",
  display: "swap",
});

export const metadata: Metadata = {
  title: "Ù…ÙØ±Ø§Ø³ | Meras",
  description: "Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ø£Ø¹Ù…Ø§Ù„",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="ar" dir="rtl">
      <body className={`${alexandria.variable} bg-background text-white antialiased`}>
        {/* Noise overlay for texture */}
        <div className="fixed inset-0 opacity-[0.03] pointer-events-none z-50 bg-noise mix-blend-overlay"></div>
        {children}
      </body>
    </html>
  );
}
</file>

<file path="app/page.tsx">
'use client';

import { useState } from 'react';
import Navbar from '@/components/Navbar';
import HeroSection from '@/components/HeroSection';
import FeatureSlider from '@/components/FeatureSlider';
import StickyCTA from '@/components/StickyCTA';

export default function Home() {
  const [isWedding, setIsWedding] = useState(true);

  return (
    <main className="min-h-screen relative bg-[#0F0F12] overflow-hidden transition-colors duration-1000 selection:bg-primary-500/30 text-right" dir="rtl">
      
      {/* 1. Ø·Ø¨Ù‚Ø© Ø§Ù„Ø®ÙŠÙˆØ· Ø§Ù„Ø¶ÙˆØ¦ÙŠØ© (Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ©) */}
      <div className="absolute inset-0 z-0 pointer-events-none opacity-40">
        <svg className="w-full h-full" xmlns="http://www.w3.org/2000/svg">
          <pattern id="grid" width="80" height="80" patternUnits="userSpaceOnUse">
            <path d="M 80 0 L 0 0 0 80" fill="none" stroke={isWedding ? "#C19D65" : "#2563EB"} strokeWidth="0.2" strokeOpacity="0.2" className="transition-colors duration-1000" />
          </pattern>
          <g className="glow-line">
            {[...Array(6)].map((_, i) => (
              <line key={i} x1="-10%" y1={`${15 * i}%`} x2="110%" y2={`${15 * i + 10}%`} stroke={isWedding ? "#C19D65" : "#2563EB"} className="transition-colors duration-1000 animate-fiber" style={{ animationDelay: `${i * 1.2}s`, strokeDasharray: '150 400' }} />
            ))}
          </g>
          <rect width="100%" height="100%" fill="url(#grid)" />
        </svg>
      </div>

      <div className="relative z-10">
        <Navbar isWedding={isWedding} />
        
        {/* 2. Ù‚Ø³Ù… Ø§Ù„Ù‡ÙŠØ±Ùˆ (ØµÙŠØ§ØºØ© Ø¨ÙŠØ¹ÙŠØ© Benefit-driven) */}
        <HeroSection isWedding={isWedding} onToggle={setIsWedding} />
        
        {/* 3. Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª (Ø­Ù„ÙˆÙ„ Ù„Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©) */}
        <FeatureSlider isWedding={isWedding} />

        {/* 4. Ù‚Ø³Ù… "ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ù…ÙØ±Ø§Ø³ØŸ" (Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®ÙˆÙ Ø§Ù„ØªÙ‚Ù†ÙŠ) */}
        <section className="py-24 px-6 relative">
          <div className="max-w-7xl mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center mb-16 text-white leading-tight">
              Ø±Ø­Ù„ØªÙƒ Ù…Ø¹ <span className={isWedding ? "text-[#C19D65]" : "text-blue-500"}>Ù…ÙØ±Ø§Ø³</span> ÙÙŠ 3 Ø®Ø·ÙˆØ§Øª
            </h2>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-12">
              {[
                { id: '01', t: 'Ø£Ù†Ø´Ø¦ Ù…Ù†Ø§Ø³Ø¨ØªÙƒ', d: 'Ø£Ø¯Ø®Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ø±ÙØ¹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¶ÙŠÙˆÙ ÙÙŠ Ø«ÙˆØ§Ù†Ù.' },
                { id: '02', t: 'Ø£Ø±Ø³Ù„ Ø§Ù„Ø¯Ø¹ÙˆØ§Øª', d: 'ØªØµÙ„ Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø®Ø§Øµ ÙˆØªØµÙ…ÙŠÙ… ÙØ®Ù….' },
                { id: '03', t: 'Ù†Ø¸Ù‘Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„', d: 'Ø¨Ø¶ØºØ·Ø© Ø²Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©ØŒ ÙˆØ¯Ù‘Ø¹ Ø·ÙˆØ§Ø¨ÙŠØ± Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±.' }
              ].map((step) => (
                <div key={step.id} className="relative group text-center">
                  <div className={`text-7xl font-black mb-4 opacity-5 transition-colors duration-500 ${isWedding ? "group-hover:text-[#C19D65] opacity-10" : "group-hover:text-blue-500 opacity-10"}`}>{step.id}</div>
                  <h3 className="text-xl font-bold mb-2 text-white">{step.t}</h3>
                  <p className="text-white/60 text-sm leading-relaxed max-w-[200px] mx-auto">{step.d}</p>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* 5. Ù‚Ø³Ù… Ø§Ù„Ø£Ø³Ø¹Ø§Ø± (Pricing & Conversion) */}
        <section className="py-32 px-6 relative overflow-hidden bg-white/[0.01]">
          <div className="max-w-7xl mx-auto text-center mb-20">
            <h2 className="text-4xl font-bold mb-6 text-white">Ø¨Ø§Ù‚Ø§Øª Ø´ÙØ§ÙØ© ØªÙ†Ø§Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ùƒ</h2>
            <p className="text-white/40 max-w-xl mx-auto">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„ØªÙŠ ØªÙ†Ø§Ø³Ø¨ Ø­Ø¬Ù… Ù…Ù†Ø§Ø³Ø¨ØªÙƒ ÙˆØ§Ø¨Ø¯Ø£ ÙÙˆØ±Ø§Ù‹.</p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto items-end">
            
            {/* Ø¨Ø§Ù‚Ø© Ø´Ø®ØµÙŠØ© - Ø²Ø± Ù…ÙØ±Øº Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù€ CTR Ø¹Ù„ÙŠÙ‡Ø§ */}
            <div className="bg-white/[0.03] backdrop-blur-xl border border-white/5 p-10 rounded-[2.5rem] flex flex-col transition-all">
              <h3 className="text-xl font-bold mb-2 text-white/80">Ø´Ø®ØµÙŠØ©</h3>
              <div className="text-4xl font-bold mb-8 text-white/40">Ù…Ø¬Ø§Ù†ÙŠØ©</div>
              <ul className="space-y-4 mb-12 flex-1 text-sm text-white/50">
                <li>âœ“ Ù…Ù†Ø§Ø³Ø¨Ø© ÙˆØ§Ø­Ø¯Ø©</li>
                <li>âœ“ Ù‚Ø§Ø±Ø¦ Ø¨Ø§Ø±ÙƒÙˆØ¯ ÙˆØ§Ø­Ø¯</li>
                <li>âœ“ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</li>
              </ul>
              <button className="w-full py-4 rounded-2xl border border-white/10 text-white/60 font-bold hover:bg-white/5 transition-all text-xs">Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ø§Ù‹</button>
            </div>

            {/* Ø¨Ø§Ù‚Ø© Ù…ØªØ·ÙˆØ±Ø© - (The Money Maker) Ø²Ø± Ù…ØµÙ…Øª ÙˆØªØµÙ…ÙŠÙ… Ø¨Ø§Ø±Ø² */}
            <div className={`p-[2px] rounded-[3rem] transition-all duration-700 scale-105 transform shadow-2xl ${isWedding ? 'bg-gradient-to-b from-[#C19D65] to-transparent shadow-[#C19D65]/20' : 'bg-gradient-to-b from-blue-500 to-transparent shadow-blue-500/20'}`}>
              <div className="bg-[#121215] p-10 rounded-[2.9rem] h-full flex flex-col">
                <div className={`text-black text-[10px] font-bold px-4 py-1.5 rounded-full w-fit mb-4 ${isWedding ? 'bg-[#C19D65]' : 'bg-blue-500'}`}>Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹</div>
                <h3 className="text-2xl font-bold mb-2 text-white">Ù…ØªØ·ÙˆØ±Ø©</h3>
                <div className={`text-5xl font-bold mb-8 ${isWedding ? 'text-[#C19D65]' : 'text-blue-500'}`}>59 <span className="text-lg opacity-40">Ø±ÙŠØ§Ù„</span></div>
                <ul className="space-y-4 mb-12 flex-1 text-sm text-white/80">
                  <li>âœ“ Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù…ØªØ²Ø§Ù…Ù†Ø©</li>
                  <li>âœ“ Ø£ÙƒØ«Ø± Ù…Ù† Ù‚Ø§Ø±Ø¦ Ø¨Ø§Ø±ÙƒÙˆØ¯</li>
                  <li>âœ“ Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</li>
                </ul>
                <button className={`w-full py-5 rounded-2xl font-black transition-all text-black text-lg ${isWedding ? 'bg-[#C19D65] hover:bg-[#A4824E]' : 'bg-blue-500 hover:bg-blue-600'}`}>Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†</button>
              </div>
            </div>

            {/* Ø¨Ø§Ù‚Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© */}
            <div className="bg-white/[0.03] backdrop-blur-xl border border-white/5 p-10 rounded-[2.5rem] flex flex-col transition-all">
              <h3 className="text-xl font-bold mb-2 text-white/80">Ø§Ø­ØªØ±Ø§ÙÙŠØ©</h3>
              <div className={`text-4xl font-bold mb-8 ${isWedding ? 'text-[#C19D65]' : 'text-blue-500'}`}>149 <span className="text-sm opacity-40">Ø±ÙŠØ§Ù„</span></div>
              <ul className="space-y-4 mb-12 flex-1 text-sm text-white/50">
                <li>âœ“ Ø±Ø¨Ø· Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø®Ø§Øµ</li>
                <li>âœ“ Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ù‡Ø§ØªÙÙƒ</li>
                <li>âœ“ Ø¥Ø²Ø§Ù„Ø© Ø´Ø¹Ø§Ø± Ù…ÙØ±Ø§Ø³</li>
              </ul>
              <button className="w-full py-4 rounded-2xl border border-white/10 text-white/60 font-bold hover:bg-white/5 transition-all">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø§Ù‚Ø©</button>
            </div>
          </div>
        </section>

        {/* 6. Ù‚Ø³Ù… Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© (Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø«Ù‚Ø©) */}
        <section className="py-24 px-6 border-t border-white/5">
          <div className="max-w-3xl mx-auto">
            <h2 className="text-3xl font-bold text-center mb-16 text-white leading-tight">Ù„Ø¯ÙŠÙƒ Ø§Ø³ØªÙØ³Ø§Ø±ØŸ <br/> <span className="text-white/40 text-lg font-normal">Ø¥Ù„ÙŠÙƒ Ù…Ø§ ÙŠØ³Ø£Ù„ Ø¹Ù†Ù‡ Ø§Ù„Ù…Ù†Ø¸Ù…ÙˆÙ† Ø¹Ø§Ø¯Ø©Ù‹</span></h2>
            <div className="space-y-8">
              {[
                { q: "Ù‡Ù„ Ø£Ø­ØªØ§Ø¬ Ø·Ø§Ø¨Ø¹Ø© Ø¨Ø§Ø±ÙƒÙˆØ¯ØŸ", a: "Ø¥Ø·Ù„Ø§Ù‚Ø§Ù‹ØŒ Ø£ÙŠ Ù‡Ø§ØªÙ Ø°ÙƒÙŠ ÙŠØ¹Ù…Ù„ ÙƒÙ‚Ø§Ø±Ø¦ Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ø­ØªØ±Ø§ÙÙŠ Ø¹Ø¨Ø± ØªØ·Ø¨ÙŠÙ‚Ù†Ø§." },
                { q: "Ù‡Ù„ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†ØªØŸ", a: "Ù†Ø¹Ù…ØŒ ÙŠØ¯Ø¹Ù… Ù…ÙØ±Ø§Ø³ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ÙÙˆØ± ØªÙˆÙØ± Ø§Ù„Ø§ØªØµØ§Ù„ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªÙˆÙ‚Ù Ø§Ù„Ø¯Ø®ÙˆÙ„." },
                { q: "ÙƒÙŠÙ ØªØµÙ„ Ø§Ù„Ø¯Ø¹ÙˆØ§Øª Ù„Ù„Ø¶ÙŠÙˆÙØŸ", a: "Ø¹Ø¨Ø± Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§ØªØ³Ø§Ø¨ Ù†ØµÙŠØ© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒØ±Øª ÙˆØ§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨ÙƒÙ„ Ø¶ÙŠÙ." }
              ].map((faq, i) => (
                <div key={i} className="group cursor-pointer">
                  <h4 className={`text-lg font-bold mb-3 transition-colors ${isWedding ? "group-hover:text-[#C19D65]" : "group-hover:text-blue-500"}`}>{faq.q}</h4>
                  <p className="text-white/50 text-sm leading-relaxed border-r-2 border-white/10 pr-4">{faq.a}</p>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* 7. Ø§Ù„ØªØ°ÙŠÙŠÙ„ (Footer) Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ */}
        <footer className="py-16 px-6 bg-black/40 border-t border-white/5 text-center">
          <div className="max-w-7xl mx-auto flex flex-col items-center">
             <div className="flex gap-8 mb-8 text-sm text-white/30 font-bold">
                <a href="#" className="hover:text-white transition-colors">Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</a>
                <a href="#" className="hover:text-white transition-colors">Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</a>
                <a href="#" className="hover:text-white transition-colors">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</a>
             </div>
             <p className="text-white/10 text-xs">Â© 2025 Ù…ÙÙ€Ø±Ø§Ø³. ØµÙÙ†Ø¹ Ø¨ÙƒÙ„ ÙØ®Ø± Ù„ØªÙ†Ø¸ÙŠÙ… ÙØ¹Ø§Ù„ÙŠØ§Øª ØªÙ„ÙŠÙ‚ Ø¨Ùƒ.</p>
          </div>
        </footer>
      </div>

      <StickyCTA isWedding={isWedding} />
    </main>
  );
}
</file>

<file path="app/scan/page.tsx">
'use client';

import { useState, useRef, useEffect } from 'react';
import { Scanner } from '@yudiel/react-qr-scanner';
import { supabase } from '@/app/utils/supabase/client';
import { Attendee } from '@/types';
import { Loader2, CheckCircle2, XCircle, AlertTriangle, ScanLine } from 'lucide-react';

type ScanStatus = 'idle' | 'processing' | 'success' | 'error' | 'warning';

interface ScanResult {
    status: ScanStatus;
    message: string;
    attendee?: Attendee;
}

export default function ScannerPage() {
    const [result, setResult] = useState<ScanResult>({ status: 'idle', message: 'Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø³Ø­' });
    const [lastScannedId, setLastScannedId] = useState<string | null>(null);
    const audioRef = useRef<HTMLAudioElement | null>(null);

    // Sound effects (optional, can be added later, just placeholder for now)
    const playSound = (type: 'success' | 'error') => {
        // Implement sound feedback if assets exist
    };

    const handleScan = async (detectedCodes: any[]) => {
        if (detectedCodes.length === 0) return;

        const rawValue = detectedCodes[0].rawValue;
        if (!rawValue || rawValue === lastScannedId || result.status === 'processing') return;

        setLastScannedId(rawValue);
        setResult({ status: 'processing', message: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...' });

        try {
            // 1. Fetch Attendee
            const { data: attendee, error } = await supabase
                .from('attendees')
                .select('*, events(*)')
                .eq('id', rawValue)
                .single();

            if (error || !attendee) {
                setResult({ status: 'error', message: 'Ø§Ù„ØªØ°ÙƒØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ø£Ùˆ ØºÙŠØ± ØµØ§Ù„Ø­Ø©' });
                playSound('error');
                return;
            }

            // 2. Check if already attended
            if (attendee.status === 'attended') {
                setResult({
                    status: 'warning',
                    message: 'ØªÙ… ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¶ÙŠÙ Ù…Ø³Ø¨Ù‚Ø§Ù‹!',
                    attendee: attendee as Attendee
                });
                playSound('error');
                return;
            }

            // 3. Mark as attended
            const { error: updateError } = await supabase
                .from('attendees')
                .update({ status: 'attended' })
                .eq('id', rawValue);

            if (updateError) throw updateError;

            setResult({
                status: 'success',
                message: 'ØªÙ… Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­',
                attendee: attendee as Attendee
            });
            playSound('success');

        } catch (err) {
            console.error(err);
            setResult({ status: 'error', message: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…' });
        }
    };

    // Auto-reset idle state after error/warning to allow new scans quickly
    useEffect(() => {
        if (result.status !== 'idle' && result.status !== 'processing') {
            const timer = setTimeout(() => {
                // We don't verify 'success' automatically to let the guard see the name
                if (result.status === 'error' || result.status === 'warning') {
                    // Optional: Auto reset or keep it until manual reset? 
                    // Let's keep it for 3 seconds then allow rescan, but scan logic handles "lastScannedId"
                }
            }, 3000);
            return () => clearTimeout(timer);
        }
    }, [result.status]);

    const resetScanner = () => {
        setResult({ status: 'idle', message: 'Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø³Ø­' });
        setLastScannedId(null);
    };

    // Determine UI colors based on status
    const getStatusColor = () => {
        switch (result.status) {
            case 'success': return 'bg-green-500';
            case 'error': return 'bg-red-500';
            case 'warning': return 'bg-yellow-500';
            case 'processing': return 'bg-blue-500';
            default: return 'bg-white/10';
        }
    };

    return (
        <div className="min-h-screen bg-black text-white flex flex-col font-sans" dir="rtl">

            {/* Scanner Area */}
            <div className="flex-1 relative overflow-hidden bg-black">
                <Scanner
                    onScan={handleScan}
                    styles={{
                        container: { height: '100%', width: '100%' },
                        video: { height: '100%', objectFit: 'cover' }
                    }}
                    components={{
                        audio: false, // We'll handle audio manually if needed
                        torch: true,
                        zoom: true
                    }}
                />

                {/* Overlay Guide */}
                <div className="absolute inset-0 border-[30px] border-black/50 flex items-center justify-center pointer-events-none">
                    <div className="w-64 h-64 border-2 border-white/20 rounded-3xl relative animate-pulse">
                        <div className="absolute top-0 left-0 w-6 h-6 border-t-4 border-l-4 border-white rounded-tl-xl"></div>
                        <div className="absolute top-0 right-0 w-6 h-6 border-t-4 border-r-4 border-white rounded-tr-xl"></div>
                        <div className="absolute bottom-0 left-0 w-6 h-6 border-b-4 border-l-4 border-white rounded-bl-xl"></div>
                        <div className="absolute bottom-0 right-0 w-6 h-6 border-b-4 border-r-4 border-white rounded-br-xl"></div>
                    </div>
                </div>

                {/* Top Header */}
                <div className="absolute top-0 left-0 w-full p-6 bg-gradient-to-b from-black/80 to-transparent z-10 flex justify-between items-start">
                    <div>
                        <h1 className="text-xl font-bold flex items-center gap-2"><ScanLine className="text-blue-500" /> Ø§Ù„Ù…Ø§Ø³Ø­ Ø§Ù„Ø¶ÙˆØ¦ÙŠ</h1>
                        <p className="text-xs text-white/50">Ù‚Ù… Ø¨ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù†Ø­Ùˆ Ø±Ù…Ø² QR Ù„Ù„ØªØ°ÙƒØ±Ø©</p>
                    </div>
                </div>
            </div>

            {/* Results Area - Slide Up Panel */}
            <div className={`
        relative z-20 transition-all duration-500 ease-spring
        ${result.status === 'idle' ? 'h-32 bg-black/90' : 'h-[45vh] bg-[#18181B] rounded-t-[2.5rem]'}
      `}>
                <div className="h-full flex flex-col items-center justify-center p-6 text-center relative overflow-hidden">

                    {/* Status Indicator Bar */}
                    <div className={`absolute top-0 left-0 w-full h-2 transition-colors duration-300 ${getStatusColor()}`}></div>

                    {result.status === 'idle' && (
                        <div className="text-white/40 flex flex-col items-center gap-2 animate-pulse">
                            <ScanLine size={32} />
                            <p>Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø³Ø­...</p>
                        </div>
                    )}

                    {result.status === 'processing' && (
                        <div className="flex flex-col items-center gap-4">
                            <Loader2 className="animate-spin text-blue-500" size={48} />
                            <h2 className="text-xl font-bold">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</h2>
                        </div>
                    )}

                    {result.status === 'success' && result.attendee && (
                        <div className="w-full h-full flex flex-col items-center justify-center animate-in slide-in-from-bottom duration-500">
                            <div className="w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mb-4">
                                <CheckCircle2 className="text-green-500" size={40} />
                            </div>
                            <h2 className="text-3xl font-black mb-2 text-green-500">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ!</h2>
                            <h3 className="text-2xl text-white font-bold mb-1">{result.attendee.name}</h3>
                            <p className="text-white/50 text-sm mb-6">{result.attendee.events?.name}</p>
                            <div className="flex gap-2 text-xs font-mono text-white/30 bg-white/5 px-4 py-2 rounded-full">
                                <span>ID: {result.attendee.id.slice(0, 8)}</span>
                            </div>
                            <button onClick={resetScanner} className="mt-8 bg-white/10 hover:bg-white/20 px-8 py-3 rounded-xl font-bold transition-all">
                                Ù…Ø³Ø­ ØªØ°ÙƒØ±Ø© Ø£Ø®Ø±Ù‰
                            </button>
                        </div>
                    )}

                    {result.status === 'warning' && result.attendee && (
                        <div className="w-full h-full flex flex-col items-center justify-center animate-in slide-in-from-bottom duration-500">
                            <div className="w-20 h-20 bg-yellow-500/20 rounded-full flex items-center justify-center mb-4">
                                <AlertTriangle className="text-yellow-500" size={40} />
                            </div>
                            <h2 className="text-2xl font-black mb-2 text-yellow-500">Ù†ØªØ¨Ù‡! ØªÙ… Ø§Ù„ØªØ­Ø¶ÙŠØ± Ù…Ø³Ø¨Ù‚Ø§Ù‹</h2>
                            <h3 className="text-xl text-white font-bold mb-6">{result.attendee.name}</h3>
                            <div className="bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 text-xs text-yellow-200 w-full max-w-xs">
                                Ù‡Ø°Ù‡ Ø§Ù„ØªØ°ÙƒØ±Ø© ØªÙ… Ù…Ø³Ø­Ù‡Ø§ Ø³Ø§Ø¨Ù‚Ø§Ù‹ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø­Ø§Ù…Ù„.
                            </div>
                            <button onClick={resetScanner} className="mt-8 bg-white/10 hover:bg-white/20 px-8 py-3 rounded-xl font-bold transition-all">
                                Ù…ØªØ§Ø¨Ø¹Ø©
                            </button>
                        </div>
                    )}

                    {result.status === 'error' && (
                        <div className="w-full h-full flex flex-col items-center justify-center animate-in slide-in-from-bottom duration-500">
                            <div className="w-20 h-20 bg-red-500/20 rounded-full flex items-center justify-center mb-4">
                                <XCircle className="text-red-500" size={40} />
                            </div>
                            <h2 className="text-2xl font-black mb-2 text-red-500">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ°ÙƒØ±Ø©</h2>
                            <p className="text-white/60 mb-8">{result.message}</p>
                            <button onClick={resetScanner} className="mt-auto bg-white/10 hover:bg-white/20 px-8 py-3 rounded-xl font-bold transition-all">
                                Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                            </button>
                        </div>
                    )}

                </div>
            </div>
        </div>
    );
}
</file>

<file path="app/ticket/[id]/page.tsx">
'use client';

import { useEffect, useState, useRef, use } from 'react';
import { supabase } from '@/app/utils/supabase/client';
import { QRCodeCanvas } from 'qrcode.react';
import { toPng } from 'html-to-image';
import { 
  Loader2, Download, Calendar, MapPin, 
  Share2, Map, CalendarPlus 
} from 'lucide-react';

interface PageProps {
  params: Promise<{ id: string }>;
}

export default function TicketPage({ params }: PageProps) {
  const { id } = use(params);

  const [loading, setLoading] = useState(true);
  const [ticket, setTicket] = useState<any>(null);
  const ticketRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const fetchTicket = async () => {
      const { data, error } = await supabase
        .from('attendees')
        .select('*, events(*)') 
        .eq('id', id)
        .single();

      if (data) {
        setTicket(data);
      } else {
        console.error('Ticket not found', error);
      }
      setLoading(false);
    };

    fetchTicket();
  }, [id]);

  // --- 1. ÙˆØ¸ÙŠÙØ© Ø­ÙØ¸ Ø§Ù„ØªØ°ÙƒØ±Ø© ÙƒØµÙˆØ±Ø© ---
  const handleDownload = async () => {
    if (ticketRef.current === null) return;
    try {
      // Ù†Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ø¶Ù…Ø§Ù† Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø±ÙŠÙ†Ø¯Ø±
      await new Promise(resolve => setTimeout(resolve, 100));
      
      const dataUrl = await toPng(ticketRef.current, { 
        cacheBust: true, 
        backgroundColor: '#18181B', 
        pixelRatio: 3, // Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©
        // ØªØ¬Ø§Ù‡Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø·ÙˆØ· Ø£Ùˆ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© Ø§Ù„ØªÙŠ ØªØ³Ø¨Ø¨ Ù…Ø´Ø§ÙƒÙ„
        skipAutoScale: true
      });
      
      const link = document.createElement('a');
      link.download = `ticket-${ticket?.name || 'meras'}.png`;
      link.href = dataUrl;
      link.click();
    } catch (err) {
      console.error(err);
      alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª');
    }
  };

  // --- 2. ÙˆØ¸ÙŠÙØ© ÙØªØ­ Ø§Ù„Ø®Ø±ÙŠØ·Ø© ---
  const openMap = () => {
    if (!ticket?.events?.location_name) return;
    const query = encodeURIComponent(ticket.events.location_name);
    // Ù†Ø³ØªØ®Ø¯Ù… Ø±Ø§Ø¨Ø· Ø¹Ø§Ù„Ù…ÙŠ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§ÙŠÙÙˆÙ† ÙˆØ§Ù„Ø§Ù†Ø¯Ø±ÙˆÙŠØ¯
    window.open(`https://www.google.com/maps/search/?api=1&query=${query}`, '_blank');
  };

  // --- 3. ÙˆØ¸ÙŠÙØ© Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØªÙ‚ÙˆÙŠÙ… ---
  const addToCalendar = () => {
    const event = ticket.events;
    const startTime = new Date(event.date).toISOString().replace(/-|:|\.\d\d\d/g, "");
    const endTime = new Date(new Date(event.date).getTime() + (2*60*60*1000)).toISOString().replace(/-|:|\.\d\d\d/g, "");
    
    const url = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(event.name)}&dates=${startTime}/${endTime}&details=${encodeURIComponent("ØªØ°ÙƒØ±Ø© Ø¯Ø®ÙˆÙ„ Ù…ÙØ±Ø§Ø³")}&location=${encodeURIComponent(event.location_name)}&sf=true&output=xml`;
    window.open(url, '_blank');
  };

  if (loading) return <div className="min-h-screen bg-[#0A0A0C] flex items-center justify-center"><Loader2 className="animate-spin text-white" /></div>;
  if (!ticket) return <div className="min-h-screen bg-[#0A0A0C] flex items-center justify-center text-white">Ø§Ù„ØªØ°ÙƒØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©</div>;

  // --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø«ÙŠÙ… ---
  const event = ticket.events;
  const isBusiness = event.type === 'business';
  
  const theme = {
    color: isBusiness ? '#3B82F6' : '#C19D65',
    bgStyle: isBusiness 
      ? 'bg-gradient-to-br from-blue-900 to-black' 
      : 'bg-gradient-to-br from-[#2a2a2a] to-black',
    badge: isBusiness ? 'VIP Business' : 'Ø¶ÙŠÙ Ø¹Ø²ÙŠØ²',
    primaryBtnText: isBusiness ? 'Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØªÙ‚ÙˆÙŠÙ…' : 'Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­ÙÙ„',
    primaryBtnIcon: isBusiness ? CalendarPlus : Map,
    primaryBtnAction: isBusiness ? addToCalendar : openMap
  };

  return (
    <div className="min-h-screen bg-[#0A0A0C] text-white flex flex-col items-center justify-center p-4 font-sans overflow-hidden" dir="rtl">
      
      {/* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ­Ù…ÙŠÙ„Ù‡Ø§ */}
      <div 
        ref={ticketRef} 
        className="w-full max-w-[380px] bg-[#18181B] rounded-[2.5rem] overflow-hidden border border-white/10 shadow-2xl relative flex flex-col"
      >
        {/* Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¹Ù„ÙˆÙŠ */}
        <div className={`h-40 relative flex items-center justify-center overflow-hidden ${theme.bgStyle}`}>
           {/* âœ… ØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­: Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨ØªØ£Ø«ÙŠØ± Ø¯Ø§Ø®Ù„ÙŠ */}
           <div className="absolute top-0 left-0 w-full h-full opacity-10 bg-white" style={{ backgroundImage: 'radial-gradient(circle, transparent 20%, #000 120%)' }}></div>
           <div className="absolute -top-10 -right-10 w-32 h-32 rounded-full blur-[60px]" style={{ backgroundColor: theme.color }}></div>
           
           <div className="relative z-10 text-center px-4">
              <h1 className="text-2xl font-black mb-1 drop-shadow-md">{event.name}</h1>
              <p className="text-[10px] opacity-70 tracking-widest uppercase">ØªØ°ÙƒØ±Ø© Ø¯Ø®ÙˆÙ„ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</p>
           </div>
        </div>

        {/* Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙˆØ³Ø· */}
        <div className="flex-1 bg-[#18181B] p-6 text-center relative">
           <div className="absolute -left-4 top-0 w-8 h-8 bg-[#0A0A0C] rounded-full"></div>
           <div className="absolute -right-4 top-0 w-8 h-8 bg-[#0A0A0C] rounded-full"></div>
           <div className="absolute left-4 right-4 top-4 border-t-2 border-dashed border-white/10 opacity-50"></div>

           <div className="mt-6 space-y-2">
              <h2 className="text-2xl font-bold text-white">{ticket.name}</h2>
              <span className="inline-block px-3 py-1 rounded-full text-[10px] font-bold border" style={{ borderColor: `${theme.color}40`, color: theme.color, backgroundColor: `${theme.color}10` }}>
                {theme.badge}
              </span>
           </div>

           {/* Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ */}
           <div className="my-8 flex justify-center">
              <div className="bg-white p-4 rounded-3xl shadow-[0_0_30px_rgba(255,255,255,0.1)]">
                 <QRCodeCanvas 
                   value={id} 
                   size={180}
                   bgColor={"#ffffff"}
                   fgColor={"#000000"}
                   level={"Q"}
                 />
              </div>
           </div>

           {/* Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙÙ„ÙŠØ© */}
           <div className="grid grid-cols-2 gap-4 text-xs text-white/60 mb-4">
              <div className="bg-white/5 rounded-xl p-3 flex flex-col items-center gap-2">
                 <Calendar size={16} style={{ color: theme.color }} />
                 <span>{new Date(event.date).toLocaleDateString('ar-SA')}</span>
              </div>
              <div className="bg-white/5 rounded-xl p-3 flex flex-col items-center gap-2">
                 <MapPin size={16} style={{ color: theme.color }} />
                 <span className="truncate w-full text-center">{event.location_name || 'Ø§Ù„Ù…ÙˆÙ‚Ø¹'}</span>
              </div>
           </div>

           <p className="text-[10px] text-white/20 font-mono tracking-widest">SN: {ticket.id.split('-')[0].toUpperCase()}</p>
        </div>
        
        <div className="h-2 w-full" style={{ backgroundColor: theme.color }}></div>
      </div>

      {/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */}
      <div className="mt-8 flex flex-col gap-3 w-full max-w-[380px]">
        <button 
          onClick={handleDownload}
          style={{ backgroundColor: theme.color }}
          className="w-full py-4 rounded-2xl text-black font-black flex items-center justify-center gap-2 shadow-lg hover:brightness-110 active:scale-[0.98] transition-all"
        >
          <Download size={20} /> Ø­ÙØ¸ Ø§Ù„ØªØ°ÙƒØ±Ø© ÙÙŠ Ø§Ù„ØµÙˆØ±
        </button>

        <div className="flex gap-3">
          <button 
            onClick={theme.primaryBtnAction}
            className="flex-1 py-4 rounded-2xl bg-[#18181B] border border-white/10 text-white font-bold text-sm hover:bg-white/5 active:scale-[0.98] transition-all flex items-center justify-center gap-2"
          >
            <theme.primaryBtnIcon size={18} /> {theme.primaryBtnText}
          </button>
          
          <button 
             onClick={() => {
                if (navigator.share) navigator.share({ title: event.name, url: window.location.href });
                else alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·');
             }}
             className="px-6 rounded-2xl bg-[#18181B] border border-white/10 text-white hover:bg-white/5 transition-all"
          >
             <Share2 size={18} />
          </button>
        </div>
      </div>
      
      <p className="mt-8 text-[10px] text-white/20">Powered by Meras Platform</p>
    </div>
  );
}
</file>

<file path="eslint.config.mjs">
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
  ]),
  {
    rules: {
      "@typescript-eslint/no-explicit-any": "off",
      "@typescript-eslint/no-unused-vars": "off",
    },
  },
]);

export default eslintConfig;
</file>

<file path="next.config.ts">
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØµØ§Ø±Ù… (Ø³Ø¨Ù‚ ÙˆØ¹Ø¯Ù„Ù†Ø§Ù‡Ø§ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§)
  reactStrictMode: false,
  
  // ğŸ‘‡ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ØµÙˆØ± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©
  images: {
    remotePatterns: [
      {
        protocol: "https",
        hostname: "**", // Ø§Ù„Ù†Ø¬Ù…ØªØ§Ù† ØªØ¹Ù†ÙŠ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø£ÙŠ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
      },
    ],
  },
};

export default nextConfig;
</file>

<file path="package.json">
{
  "name": "my-event-app",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "@supabase/ssr": "^0.8.0",
    "@supabase/supabase-js": "^2.89.0",
    "@yudiel/react-qr-scanner": "^2.5.0",
    "framer-motion": "^12.23.26",
    "html-to-image": "^1.11.13",
    "html2canvas": "^1.4.1",
    "html5-qrcode": "^2.3.8",
    "lucide-react": "^0.562.0",
    "next": "16.1.0",
    "nodemailer": "^7.0.12",
    "qrcode": "^1.5.4",
    "qrcode.react": "^4.2.0",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "resend": "^6.6.0"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/nodemailer": "^7.0.4",
    "@types/qrcode": "^1.5.6",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "@types/react-qr-reader": "^2.1.7",
    "eslint": "^9",
    "eslint-config-next": "16.1.0",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}
</file>

<file path="postcss.config.mjs">
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;
</file>

<file path="public/file.svg">
<svg fill="none" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 13.5V5.41a1 1 0 0 0-.3-.7L9.8.29A1 1 0 0 0 9.08 0H1.5v13.5A2.5 2.5 0 0 0 4 16h8a2.5 2.5 0 0 0 2.5-2.5m-1.5 0v-7H8v-5H3v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1M9.5 5V2.12L12.38 5zM5.13 5h-.62v1.25h2.12V5zm-.62 3h7.12v1.25H4.5zm.62 3h-.62v1.25h7.12V11z" clip-rule="evenodd" fill="#666" fill-rule="evenodd"/></svg>
</file>

<file path="public/globe.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.27 14.1a6.5 6.5 0 0 0 3.67-3.45q-1.24.21-2.7.34-.31 1.83-.97 3.1M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.48-1.52a7 7 0 0 1-.96 0H7.5a4 4 0 0 1-.84-1.32q-.38-.89-.63-2.08a40 40 0 0 0 3.92 0q-.25 1.2-.63 2.08a4 4 0 0 1-.84 1.31zm2.94-4.76q1.66-.15 2.95-.43a7 7 0 0 0 0-2.58q-1.3-.27-2.95-.43a18 18 0 0 1 0 3.44m-1.27-3.54a17 17 0 0 1 0 3.64 39 39 0 0 1-4.3 0 17 17 0 0 1 0-3.64 39 39 0 0 1 4.3 0m1.1-1.17q1.45.13 2.69.34a6.5 6.5 0 0 0-3.67-3.44q.65 1.26.98 3.1M8.48 1.5l.01.02q.41.37.84 1.31.38.89.63 2.08a40 40 0 0 0-3.92 0q.25-1.2.63-2.08a4 4 0 0 1 .85-1.32 7 7 0 0 1 .96 0m-2.75.4a6.5 6.5 0 0 0-3.67 3.44 29 29 0 0 1 2.7-.34q.31-1.83.97-3.1M4.58 6.28q-1.66.16-2.95.43a7 7 0 0 0 0 2.58q1.3.27 2.95.43a18 18 0 0 1 0-3.44m.17 4.71q-1.45-.12-2.69-.34a6.5 6.5 0 0 0 3.67 3.44q-.65-1.27-.98-3.1" fill="#666"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"/></clipPath></defs></svg>
</file>

<file path="public/next.svg">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
</file>

<file path="public/vercel.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1155 1000"><path d="m577.3 0 577.4 1000H0z" fill="#fff"/></svg>
</file>

<file path="public/window.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5h13v10a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1zM0 1h16v11.5a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 12.5zm3.75 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5M7 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5" fill="#666"/></svg>
</file>

<file path="README.md">
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}
</file>

</files>
